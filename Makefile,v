head	1.480;
access;
symbols
	VERSION_1_13_3:1.457
	VERSION_1_13_2:1.453
	VERSION_1_12_4:1.395.2.29
	VERSION_1_13_1:1.435
	VERSION_1_12_3:1.395.2.9
	VERSION_1_12_2:1.395.2.6
	VERSION_1_12:1.395.0.2
	VERSION_1_12_1:1.395
	VERSION_1_12_0:1.375
	VERSION_1_11_7:1.370
	VERSION_1_11_6:1.368
	VERSION_1_11_5:1.363
	VERSION_1_11_4:1.354
	VERSION_1_11_3:1.349
	VERSION_1_11_2:1.338
	VERSION_1_11_1:1.331
	VERSION_1_10_10:1.313
	VERSION_1_10_9:1.308
	VERSION_1_10_8:1.300
	VERSION_1_10_7:1.296
	VERSION_1_10_6:1.292
	VERSION_1_10_5:1.290
	VERSION_1_10_5_PREPDF:1.288
	VERSION_1_10_4:1.288
	VERSION_1_10_3:1.284
	VERSION_1_10_2:1.281
	VERSION_1_10_1:1.277
	VERSION_1_9_24:1.265
	VERSION_1_9_25:1.267
	VERSION_1_9_23:1.262
	VERSION_1_9_22:1.259
	VERSION_1_9_21:1.255
	VERSION_1_9_20:1.254
	VERSION_1_9_19:1.253
	VERSION_1_9_18:1.253
	VERSION_1_9_17:1.252
	VERSION_1_9_16:1.251
	VERSION_1_9_15:1.250
	VERSION_1_9_15-pre2:1.247
	VERSION_1_9_15-pre1:1.245
	VERSION_1_9_14:1.244
	VERSION_1_9_13:1.242
	VERSION_1_9_12:1.240
	VERSION_1_9_11:1.236
	VERSION_1_9_10:1.235
	VERSION_1_9_9:1.232
	VERSION_1_9_8:1.225
	VERSION_1_9_7:1.224
	VERSION_1_9_6:1.221
	VERSION_1_9_5:1.217
	VERSION_1_9_2:1.206
	VERSION_1_9_1:1.205
	VERSION_1_9_0:1.204
	VERSION_1_8_5:1.202
	VERSION_1_8_4:1.201
	VERSION_1_8_3:1.200
	VERSION_1_8_2:1.199
	VERSION_1_8_1:1.198
	VERSION_1_8_0:1.192
	VERSION_1_7_24:1.191
	VERSION_1_7_23:1.190
	VERSION_1_7_22:1.189
	VERSION_1_7_21:1.188
	VERSION_1_7_20:1.184
	VERSION_1_7_19:1.183
	VERSION_1_7_17:1.179
	VERSION_1_7_16:1.178
	VERSION_1_7_15:1.177
	VERSION_1_7_14:1.175
	VERSION_1_7_13:1.172
	VERSION_1_7_12:1.171
	OPENBSD_CHECKIN:1.171
	VERSION_1_7_10:1.169
	VERSION_1_7_5:1.161
	VERSION_1_6_5:1.138
	VERSION_1_6_2:1.135
	VERSION_1_5_3:1.130
	VERSION_1_5_1:1.126
	VERSION_1_4_6:1.114
	VERSION_1_4_5:1.113
	VERSION_1_4_4:1.112
	VERSION_1_4_2:1.111
	VERSION_1_3_15:1.102
	VERSION_1_3_13:1.98
	VERSION_1_3_11:1.96
	VERSION_1_3_10:1.95
	VERSION_1_3_9:1.93
	VERSION_1_3_8:1.92
	VERSION_1_3_6:1.89
	VERSION_1_3_5:1.86
	VERSION_1_2_0:1.63
	VERSION_1_1_0:1.57
	VERSION_1_0_2:1.44
	VERSION_1_0_1:1.35
	version_0_0:1.1.1.1
	version_0:1.1.1;
locks; strict;
comment	@# @;


1.480
date	2015.11.07.21.53.14;	author schwarze;	state Exp;
branches;
next	1.479;

1.479
date	2015.11.07.21.38.28;	author schwarze;	state Exp;
branches;
next	1.478;

1.478
date	2015.11.07.20.52.52;	author schwarze;	state Exp;
branches;
next	1.477;

1.477
date	2015.11.07.17.58.55;	author schwarze;	state Exp;
branches;
next	1.476;

1.476
date	2015.11.07.13.14.21;	author schwarze;	state Exp;
branches;
next	1.475;

1.475
date	2015.11.07.13.05.14;	author schwarze;	state Exp;
branches;
next	1.474;

1.474
date	2015.11.06.17.33.34;	author schwarze;	state Exp;
branches;
next	1.473;

1.473
date	2015.11.06.16.30.33;	author schwarze;	state Exp;
branches;
next	1.472;

1.472
date	2015.11.05.17.47.51;	author schwarze;	state Exp;
branches;
next	1.471;

1.471
date	2015.11.05.17.16.34;	author schwarze;	state Exp;
branches;
next	1.470;

1.470
date	2015.10.20.02.01.31;	author schwarze;	state Exp;
branches;
next	1.469;

1.469
date	2015.10.13.22.59.54;	author schwarze;	state Exp;
branches;
next	1.468;

1.468
date	2015.10.13.15.53.05;	author schwarze;	state Exp;
branches;
next	1.467;

1.467
date	2015.10.11.21.12.54;	author schwarze;	state Exp;
branches;
next	1.466;

1.466
date	2015.07.19.06.05.16;	author schwarze;	state Exp;
branches;
next	1.465;

1.465
date	2015.07.17.22.38.29;	author schwarze;	state Exp;
branches;
next	1.464;

1.464
date	2015.07.14.23.16.29;	author schwarze;	state Exp;
branches;
next	1.463;

1.463
date	2015.05.21.00.04.38;	author schwarze;	state Exp;
branches;
next	1.462;

1.462
date	2015.05.20.22.22.59;	author schwarze;	state Exp;
branches;
next	1.461;

1.461
date	2015.04.02.21.36.49;	author schwarze;	state Exp;
branches;
next	1.460;

1.460
date	2015.03.27.17.37.25;	author schwarze;	state Exp;
branches;
next	1.459;

1.459
date	2015.03.27.00.18.14;	author schwarze;	state Exp;
branches;
next	1.458;

1.458
date	2015.03.19.14.57.29;	author schwarze;	state Exp;
branches;
next	1.457;

1.457
date	2015.03.13.12.35.32;	author schwarze;	state Exp;
branches;
next	1.456;

1.456
date	2015.02.16.16.23.54;	author schwarze;	state Exp;
branches;
next	1.455;

1.455
date	2015.02.16.14.56.22;	author schwarze;	state Exp;
branches;
next	1.454;

1.454
date	2015.02.03.21.16.02;	author schwarze;	state Exp;
branches;
next	1.453;

1.453
date	2014.12.09.09.14.33;	author schwarze;	state Exp;
branches;
next	1.452;

1.452
date	2014.12.09.07.29.42;	author schwarze;	state Exp;
branches;
next	1.451;

1.451
date	2014.12.09.06.31.03;	author schwarze;	state Exp;
branches;
next	1.450;

1.450
date	2014.12.09.06.11.35;	author schwarze;	state Exp;
branches;
next	1.449;

1.449
date	2014.12.01.08.09.26;	author schwarze;	state Exp;
branches;
next	1.448;

1.448
date	2014.11.28.18.57.31;	author schwarze;	state Exp;
branches;
next	1.447;

1.447
date	2014.11.28.18.36.35;	author schwarze;	state Exp;
branches;
next	1.446;

1.446
date	2014.11.28.18.09.01;	author schwarze;	state Exp;
branches;
next	1.445;

1.445
date	2014.10.25.01.03.52;	author schwarze;	state Exp;
branches;
next	1.444;

1.444
date	2014.09.27.11.20.39;	author kristaps;	state Exp;
branches;
next	1.443;

1.443
date	2014.08.21.00.42.38;	author schwarze;	state Exp;
branches;
next	1.442;

1.442
date	2014.08.17.03.24.47;	author schwarze;	state Exp;
branches;
next	1.441;

1.441
date	2014.08.16.23.04.25;	author schwarze;	state Exp;
branches;
next	1.440;

1.440
date	2014.08.16.19.00.01;	author schwarze;	state Exp;
branches;
next	1.439;

1.439
date	2014.08.12.21.35.48;	author schwarze;	state Exp;
branches;
next	1.438;

1.438
date	2014.08.11.03.19.39;	author schwarze;	state Exp;
branches;
next	1.437;

1.437
date	2014.08.11.01.39.00;	author schwarze;	state Exp;
branches;
next	1.436;

1.436
date	2014.08.10.23.54.41;	author schwarze;	state Exp;
branches;
next	1.435;

1.435
date	2014.08.10.02.45.04;	author schwarze;	state Exp;
branches;
next	1.434;

1.434
date	2014.08.08.23.47.21;	author schwarze;	state Exp;
branches;
next	1.433;

1.433
date	2014.08.08.20.34.06;	author schwarze;	state Exp;
branches;
next	1.432;

1.432
date	2014.08.05.12.50.52;	author schwarze;	state Exp;
branches;
next	1.431;

1.431
date	2014.08.05.11.19.13;	author schwarze;	state Exp;
branches;
next	1.430;

1.430
date	2014.08.05.05.48.56;	author schwarze;	state Exp;
branches;
next	1.429;

1.429
date	2014.08.05.05.27.16;	author schwarze;	state Exp;
branches;
next	1.428;

1.428
date	2014.08.05.03.02.40;	author schwarze;	state Exp;
branches;
next	1.427;

1.427
date	2014.08.05.01.45.02;	author schwarze;	state Exp;
branches;
next	1.426;

1.426
date	2014.08.05.01.07.00;	author schwarze;	state Exp;
branches;
next	1.425;

1.425
date	2014.08.04.23.44.29;	author schwarze;	state Exp;
branches;
next	1.424;

1.424
date	2014.07.13.09.39.32;	author schwarze;	state Exp;
branches;
next	1.423;

1.423
date	2014.07.12.18.32.47;	author schwarze;	state Exp;
branches;
next	1.422;

1.422
date	2014.07.10.00.31.10;	author schwarze;	state Exp;
branches;
next	1.421;

1.421
date	2014.07.09.07.30.47;	author schwarze;	state Exp;
branches;
next	1.420;

1.420
date	2014.06.20.02.55.49;	author schwarze;	state Exp;
branches;
next	1.419;

1.419
date	2014.04.24.00.29.45;	author schwarze;	state Exp;
branches;
next	1.418;

1.418
date	2014.04.23.21.06.41;	author schwarze;	state Exp;
branches;
next	1.417;

1.417
date	2014.04.22.22.03.22;	author schwarze;	state Exp;
branches;
next	1.416;

1.416
date	2014.04.18.10.30.37;	author schwarze;	state Exp;
branches;
next	1.415;

1.415
date	2014.04.15.20.18.26;	author schwarze;	state Exp;
branches;
next	1.414;

1.414
date	2014.03.23.11.25.25;	author schwarze;	state Exp;
branches;
next	1.413;

1.413
date	2014.03.03.18.53.27;	author schwarze;	state Exp;
branches;
next	1.412;

1.412
date	2014.01.19.01.18.34;	author schwarze;	state Exp;
branches;
next	1.411;

1.411
date	2014.01.19.00.09.38;	author schwarze;	state Exp;
branches;
next	1.410;

1.410
date	2014.01.04.15.00.02;	author schwarze;	state Exp;
branches;
next	1.409;

1.409
date	2014.01.04.14.45.54;	author schwarze;	state Exp;
branches;
next	1.408;

1.408
date	2014.01.04.13.40.01;	author schwarze;	state Exp;
branches;
next	1.407;

1.407
date	2014.01.04.01.11.00;	author schwarze;	state Exp;
branches;
next	1.406;

1.406
date	2013.12.31.23.03.47;	author schwarze;	state Exp;
branches;
next	1.405;

1.405
date	2013.12.31.11.28.20;	author schwarze;	state Exp;
branches;
next	1.404;

1.404
date	2013.10.06.23.20.39;	author schwarze;	state Exp;
branches;
next	1.403;

1.403
date	2013.10.05.20.43.20;	author schwarze;	state Exp;
branches;
next	1.402;

1.402
date	2013.10.05.20.09.24;	author schwarze;	state Exp;
branches;
next	1.401;

1.401
date	2013.10.02.06.44.55;	author schwarze;	state Exp;
branches;
next	1.400;

1.400
date	2012.06.09.14.19.55;	author kristaps;	state Exp;
branches;
next	1.399;

1.399
date	2012.06.09.14.11.15;	author kristaps;	state Exp;
branches;
next	1.398;

1.398
date	2012.06.09.11.27.38;	author kristaps;	state Exp;
branches;
next	1.397;

1.397
date	2012.06.09.11.00.13;	author kristaps;	state Exp;
branches;
next	1.396;

1.396
date	2012.06.08.10.47.17;	author kristaps;	state Exp;
branches;
next	1.395;

1.395
date	2012.03.24.01.54.43;	author kristaps;	state Exp;
branches
	1.395.2.1;
next	1.394;

1.394
date	2012.03.23.05.05.41;	author kristaps;	state Exp;
branches;
next	1.393;

1.393
date	2012.03.23.02.53.18;	author kristaps;	state Exp;
branches;
next	1.392;

1.392
date	2011.12.25.17.49.52;	author kristaps;	state Exp;
branches;
next	1.391;

1.391
date	2011.12.15.12.05.19;	author kristaps;	state Exp;
branches;
next	1.390;

1.390
date	2011.12.13.11.26.12;	author kristaps;	state Exp;
branches;
next	1.389;

1.389
date	2011.12.10.11.00.00;	author kristaps;	state Exp;
branches;
next	1.388;

1.388
date	2011.12.07.13.00.40;	author kristaps;	state Exp;
branches;
next	1.387;

1.387
date	2011.12.07.11.59.32;	author kristaps;	state Exp;
branches;
next	1.386;

1.386
date	2011.12.07.11.52.36;	author kristaps;	state Exp;
branches;
next	1.385;

1.385
date	2011.12.02.01.37.14;	author schwarze;	state Exp;
branches;
next	1.384;

1.384
date	2011.11.28.10.10.08;	author schwarze;	state Exp;
branches;
next	1.383;

1.383
date	2011.11.27.11.46.44;	author kristaps;	state Exp;
branches;
next	1.382;

1.382
date	2011.11.24.12.43.34;	author kristaps;	state Exp;
branches;
next	1.381;

1.381
date	2011.11.24.10.33.38;	author kristaps;	state Exp;
branches;
next	1.380;

1.380
date	2011.11.23.09.56.17;	author kristaps;	state Exp;
branches;
next	1.379;

1.379
date	2011.11.20.21.36.00;	author kristaps;	state Exp;
branches;
next	1.378;

1.378
date	2011.11.13.10.49.57;	author schwarze;	state Exp;
branches;
next	1.377;

1.377
date	2011.11.13.10.12.05;	author schwarze;	state Exp;
branches;
next	1.376;

1.376
date	2011.11.09.01.24.23;	author kristaps;	state Exp;
branches;
next	1.375;

1.375
date	2011.10.08.12.47.40;	author kristaps;	state Exp;
branches;
next	1.374;

1.374
date	2011.10.08.12.21.57;	author kristaps;	state Exp;
branches;
next	1.373;

1.373
date	2011.10.06.23.15.56;	author kristaps;	state Exp;
branches;
next	1.372;

1.372
date	2011.10.06.23.00.54;	author kristaps;	state Exp;
branches;
next	1.371;

1.371
date	2011.09.17.15.00.51;	author schwarze;	state Exp;
branches;
next	1.370;

1.370
date	2011.09.02.13.04.05;	author kristaps;	state Exp;
branches;
next	1.369;

1.369
date	2011.09.01.10.46.28;	author kristaps;	state Exp;
branches;
next	1.368;

1.368
date	2011.08.16.22.21.04;	author kristaps;	state Exp;
branches;
next	1.367;

1.367
date	2011.08.16.12.31.01;	author kristaps;	state Exp;
branches;
next	1.366;

1.366
date	2011.08.16.12.15.19;	author kristaps;	state Exp;
branches;
next	1.365;

1.365
date	2011.08.16.12.13.27;	author kristaps;	state Exp;
branches;
next	1.364;

1.364
date	2011.07.25.15.37.00;	author kristaps;	state Exp;
branches;
next	1.363;

1.363
date	2011.07.24.19.03.40;	author kristaps;	state Exp;
branches;
next	1.362;

1.362
date	2011.07.24.18.15.13;	author kristaps;	state Exp;
branches;
next	1.361;

1.361
date	2011.07.24.10.09.03;	author kristaps;	state Exp;
branches;
next	1.360;

1.360
date	2011.07.23.22.57.13;	author kristaps;	state Exp;
branches;
next	1.359;

1.359
date	2011.07.22.10.50.46;	author kristaps;	state Exp;
branches;
next	1.358;

1.358
date	2011.07.18.07.46.41;	author kristaps;	state Exp;
branches;
next	1.357;

1.357
date	2011.07.17.14.11.25;	author kristaps;	state Exp;
branches;
next	1.356;

1.356
date	2011.07.14.14.36.37;	author schwarze;	state Exp;
branches;
next	1.355;

1.355
date	2011.07.14.10.57.02;	author kristaps;	state Exp;
branches;
next	1.354;

1.354
date	2011.07.12.08.27.45;	author kristaps;	state Exp;
branches;
next	1.353;

1.353
date	2011.07.04.12.02.57;	author kristaps;	state Exp;
branches;
next	1.352;

1.352
date	2011.07.03.20.54.41;	author kristaps;	state Exp;
branches;
next	1.351;

1.351
date	2011.06.21.14.16.05;	author kristaps;	state Exp;
branches;
next	1.350;

1.350
date	2011.06.21.13.13.15;	author kristaps;	state Exp;
branches;
next	1.349;

1.349
date	2011.05.26.21.23.50;	author kristaps;	state Exp;
branches;
next	1.348;

1.348
date	2011.05.26.21.13.07;	author kristaps;	state Exp;
branches;
next	1.347;

1.347
date	2011.05.26.20.36.21;	author kristaps;	state Exp;
branches;
next	1.346;

1.346
date	2011.05.26.20.22.42;	author kristaps;	state Exp;
branches;
next	1.345;

1.345
date	2011.05.26.14.43.07;	author kristaps;	state Exp;
branches;
next	1.344;

1.344
date	2011.05.26.12.01.14;	author kristaps;	state Exp;
branches;
next	1.343;

1.343
date	2011.05.26.00.30.11;	author kristaps;	state Exp;
branches;
next	1.342;

1.342
date	2011.05.24.21.18.06;	author kristaps;	state Exp;
branches;
next	1.341;

1.341
date	2011.05.19.15.48.58;	author kristaps;	state Exp;
branches;
next	1.340;

1.340
date	2011.05.18.09.45.21;	author kristaps;	state Exp;
branches;
next	1.339;

1.339
date	2011.05.17.22.32.45;	author kristaps;	state Exp;
branches;
next	1.338;

1.338
date	2011.05.13.01.02.34;	author kristaps;	state Exp;
branches;
next	1.337;

1.337
date	2011.05.13.00.57.21;	author kristaps;	state Exp;
branches;
next	1.336;

1.336
date	2011.05.13.00.42.26;	author kristaps;	state Exp;
branches;
next	1.335;

1.335
date	2011.05.12.23.45.47;	author kristaps;	state Exp;
branches;
next	1.334;

1.334
date	2011.04.30.09.49.31;	author kristaps;	state Exp;
branches;
next	1.333;

1.333
date	2011.04.29.22.18.12;	author kristaps;	state Exp;
branches;
next	1.332;

1.332
date	2011.04.05.09.34.00;	author kristaps;	state Exp;
branches;
next	1.331;

1.331
date	2011.04.04.22.05.28;	author kristaps;	state Exp;
branches;
next	1.330;

1.330
date	2011.04.04.21.07.20;	author kristaps;	state Exp;
branches;
next	1.329;

1.329
date	2011.04.04.15.46.05;	author kristaps;	state Exp;
branches;
next	1.328;

1.328
date	2011.04.04.15.45.12;	author kristaps;	state Exp;
branches;
next	1.327;

1.327
date	2011.04.03.10.14.45;	author kristaps;	state Exp;
branches;
next	1.326;

1.326
date	2011.04.02.15.40.40;	author kristaps;	state Exp;
branches;
next	1.325;

1.325
date	2011.03.29.09.37.24;	author kristaps;	state Exp;
branches;
next	1.324;

1.324
date	2011.03.28.21.49.42;	author kristaps;	state Exp;
branches;
next	1.323;

1.323
date	2011.03.23.15.33.57;	author kristaps;	state Exp;
branches;
next	1.322;

1.322
date	2011.03.23.12.32.39;	author kristaps;	state Exp;
branches;
next	1.321;

1.321
date	2011.03.22.13.28.03;	author kristaps;	state Exp;
branches;
next	1.320;

1.320
date	2011.03.22.13.15.38;	author kristaps;	state Exp;
branches;
next	1.319;

1.319
date	2011.03.22.10.20.33;	author kristaps;	state Exp;
branches;
next	1.318;

1.318
date	2011.03.22.10.13.01;	author kristaps;	state Exp;
branches;
next	1.317;

1.317
date	2011.03.22.10.02.50;	author kristaps;	state Exp;
branches;
next	1.316;

1.316
date	2011.03.22.09.50.11;	author kristaps;	state Exp;
branches;
next	1.315;

1.315
date	2011.03.20.11.41.24;	author kristaps;	state Exp;
branches;
next	1.314;

1.314
date	2011.03.20.11.07.05;	author kristaps;	state Exp;
branches;
next	1.313;

1.313
date	2011.03.17.09.25.54;	author kristaps;	state Exp;
branches;
next	1.312;

1.312
date	2011.02.24.14.30.15;	author kristaps;	state Exp;
branches;
next	1.311;

1.311
date	2011.02.09.10.03.02;	author kristaps;	state Exp;
branches;
next	1.310;

1.310
date	2011.02.06.20.36.36;	author kristaps;	state Exp;
branches;
next	1.309;

1.309
date	2011.01.07.15.22.21;	author kristaps;	state Exp;
branches;
next	1.308;

1.308
date	2011.01.07.13.10.03;	author kristaps;	state Exp;
branches;
next	1.307;

1.307
date	2011.01.04.23.32.21;	author kristaps;	state Exp;
branches;
next	1.306;

1.306
date	2011.01.04.10.29.41;	author kristaps;	state Exp;
branches;
next	1.305;

1.305
date	2011.01.02.12.21.07;	author kristaps;	state Exp;
branches;
next	1.304;

1.304
date	2010.12.29.16.44.23;	author kristaps;	state Exp;
branches;
next	1.303;

1.303
date	2010.12.29.14.38.14;	author kristaps;	state Exp;
branches;
next	1.302;

1.302
date	2010.12.28.13.46.07;	author kristaps;	state Exp;
branches;
next	1.301;

1.301
date	2010.12.28.10.51.03;	author kristaps;	state Exp;
branches;
next	1.300;

1.300
date	2010.12.24.14.20.08;	author kristaps;	state Exp;
branches;
next	1.299;

1.299
date	2010.12.24.14.14.00;	author kristaps;	state Exp;
branches;
next	1.298;

1.298
date	2010.12.23.00.30.20;	author kristaps;	state Exp;
branches;
next	1.297;

1.297
date	2010.12.22.11.58.02;	author kristaps;	state Exp;
branches;
next	1.296;

1.296
date	2010.12.06.17.07.28;	author kristaps;	state Exp;
branches;
next	1.295;

1.295
date	2010.11.30.15.36.28;	author kristaps;	state Exp;
branches;
next	1.294;

1.294
date	2010.11.30.13.04.14;	author kristaps;	state Exp;
branches;
next	1.293;

1.293
date	2010.10.10.09.47.05;	author kristaps;	state Exp;
branches;
next	1.292;

1.292
date	2010.09.27.12.34.21;	author kristaps;	state Exp;
branches;
next	1.291;

1.291
date	2010.08.20.05.52.59;	author kristaps;	state Exp;
branches;
next	1.290;

1.290
date	2010.07.27.20.16.44;	author kristaps;	state Exp;
branches;
next	1.289;

1.289
date	2010.07.27.20.02.52;	author kristaps;	state Exp;
branches;
next	1.288;

1.288
date	2010.07.11.23.07.47;	author kristaps;	state Exp;
branches;
next	1.287;

1.287
date	2010.07.07.15.04.54;	author kristaps;	state Exp;
branches;
next	1.286;

1.286
date	2010.07.06.22.08.33;	author kristaps;	state Exp;
branches;
next	1.285;

1.285
date	2010.07.05.20.00.55;	author kristaps;	state Exp;
branches;
next	1.284;

1.284
date	2010.06.29.15.00.44;	author kristaps;	state Exp;
branches;
next	1.283;

1.283
date	2010.06.27.15.52.41;	author kristaps;	state Exp;
branches;
next	1.282;

1.282
date	2010.06.26.15.22.19;	author kristaps;	state Exp;
branches;
next	1.281;

1.281
date	2010.06.19.20.51.50;	author kristaps;	state Exp;
branches;
next	1.280;

1.280
date	2010.06.19.20.43.35;	author kristaps;	state Exp;
branches;
next	1.279;

1.279
date	2010.06.08.15.00.17;	author kristaps;	state Exp;
branches;
next	1.278;

1.278
date	2010.06.08.13.22.37;	author kristaps;	state Exp;
branches;
next	1.277;

1.277
date	2010.06.07.20.57.09;	author kristaps;	state Exp;
branches;
next	1.276;

1.276
date	2010.06.07.12.20.07;	author kristaps;	state Exp;
branches;
next	1.275;

1.275
date	2010.06.03.15.39.56;	author kristaps;	state Exp;
branches;
next	1.274;

1.274
date	2010.06.03.14.52.48;	author kristaps;	state Exp;
branches;
next	1.273;

1.273
date	2010.05.29.19.45.32;	author kristaps;	state Exp;
branches;
next	1.272;

1.272
date	2010.05.25.22.16.59;	author kristaps;	state Exp;
branches;
next	1.271;

1.271
date	2010.05.17.02.38.13;	author kristaps;	state Exp;
branches;
next	1.270;

1.270
date	2010.05.17.02.19.44;	author joerg;	state Exp;
branches;
next	1.269;

1.269
date	2010.05.15.07.52.11;	author kristaps;	state Exp;
branches;
next	1.268;

1.268
date	2010.05.15.04.30.04;	author kristaps;	state Exp;
branches;
next	1.267;

1.267
date	2010.05.13.11.57.51;	author kristaps;	state Exp;
branches;
next	1.266;

1.266
date	2010.05.13.03.51.16;	author kristaps;	state Exp;
branches;
next	1.265;

1.265
date	2010.05.09.06.27.41;	author kristaps;	state Exp;
branches;
next	1.264;

1.264
date	2010.05.07.05.48.29;	author kristaps;	state Exp;
branches;
next	1.263;

1.263
date	2010.05.07.05.39.35;	author kristaps;	state Exp;
branches;
next	1.262;

1.262
date	2010.04.07.11.25.56;	author kristaps;	state Exp;
branches;
next	1.261;

1.261
date	2010.04.05.09.19.28;	author kristaps;	state Exp;
branches;
next	1.260;

1.260
date	2010.04.05.07.24.55;	author kristaps;	state Exp;
branches;
next	1.259;

1.259
date	2010.03.31.08.42.40;	author kristaps;	state Exp;
branches;
next	1.258;

1.258
date	2010.03.31.08.04.57;	author kristaps;	state Exp;
branches;
next	1.257;

1.257
date	2010.03.31.07.42.04;	author kristaps;	state Exp;
branches;
next	1.256;

1.256
date	2010.03.31.07.13.53;	author kristaps;	state Exp;
branches;
next	1.255;

1.255
date	2010.03.31.06.29.42;	author kristaps;	state Exp;
branches;
next	1.254;

1.254
date	2010.03.30.08.24.01;	author kristaps;	state Exp;
branches;
next	1.253;

1.253
date	2010.03.27.10.04.56;	author kristaps;	state Exp;
branches;
next	1.252;

1.252
date	2010.03.25.07.38.06;	author kristaps;	state Exp;
branches;
next	1.251;

1.251
date	2010.03.22.18.30.23;	author kristaps;	state Exp;
branches;
next	1.250;

1.250
date	2010.02.17.19.56.17;	author kristaps;	state Exp;
branches;
next	1.249;

1.249
date	2010.01.29.14.39.37;	author kristaps;	state Exp;
branches;
next	1.248;

1.248
date	2010.01.01.19.22.56;	author kristaps;	state Exp;
branches;
next	1.247;

1.247
date	2010.01.01.17.25.07;	author kristaps;	state Exp;
branches;
next	1.246;

1.246
date	2010.01.01.17.14.26;	author kristaps;	state Exp;
branches;
next	1.245;

1.245
date	2009.12.02.10.16.55;	author kristaps;	state Exp;
branches;
next	1.244;

1.244
date	2009.11.16.10.05.29;	author kristaps;	state Exp;
branches;
next	1.243;

1.243
date	2009.11.16.09.52.47;	author kristaps;	state Exp;
branches;
next	1.242;

1.242
date	2009.11.02.17.37.19;	author kristaps;	state Exp;
branches;
next	1.241;

1.241
date	2009.10.31.08.37.26;	author kristaps;	state Exp;
branches;
next	1.240;

1.240
date	2009.10.31.06.38.08;	author kristaps;	state Exp;
branches;
next	1.239;

1.239
date	2009.10.31.06.23.28;	author kristaps;	state Exp;
branches;
next	1.238;

1.238
date	2009.10.28.08.08.53;	author kristaps;	state Exp;
branches;
next	1.237;

1.237
date	2009.10.28.08.00.17;	author kristaps;	state Exp;
branches;
next	1.236;

1.236
date	2009.10.26.10.36.46;	author kristaps;	state Exp;
branches;
next	1.235;

1.235
date	2009.10.26.09.00.41;	author kristaps;	state Exp;
branches;
next	1.234;

1.234
date	2009.10.26.04.15.41;	author kristaps;	state Exp;
branches;
next	1.233;

1.233
date	2009.10.22.17.54.24;	author kristaps;	state Exp;
branches;
next	1.232;

1.232
date	2009.10.20.18.31.04;	author kristaps;	state Exp;
branches;
next	1.231;

1.231
date	2009.10.20.18.20.59;	author kristaps;	state Exp;
branches;
next	1.230;

1.230
date	2009.10.18.13.58.48;	author kristaps;	state Exp;
branches;
next	1.229;

1.229
date	2009.10.18.11.13.39;	author kristaps;	state Exp;
branches;
next	1.228;

1.228
date	2009.10.17.04.44.05;	author kristaps;	state Exp;
branches;
next	1.227;

1.227
date	2009.10.13.10.57.25;	author kristaps;	state Exp;
branches;
next	1.226;

1.226
date	2009.10.13.10.21.24;	author kristaps;	state Exp;
branches;
next	1.225;

1.225
date	2009.10.10.18.43.55;	author kristaps;	state Exp;
branches;
next	1.224;

1.224
date	2009.10.09.15.10.41;	author kristaps;	state Exp;
branches;
next	1.223;

1.223
date	2009.10.07.12.35.23;	author kristaps;	state Exp;
branches;
next	1.222;

1.222
date	2009.10.03.16.36.06;	author kristaps;	state Exp;
branches;
next	1.221;

1.221
date	2009.09.25.14.07.51;	author kristaps;	state Exp;
branches;
next	1.220;

1.220
date	2009.09.25.13.33.47;	author kristaps;	state Exp;
branches;
next	1.219;

1.219
date	2009.09.24.09.20.02;	author kristaps;	state Exp;
branches;
next	1.218;

1.218
date	2009.09.23.11.02.21;	author kristaps;	state Exp;
branches;
next	1.217;

1.217
date	2009.09.21.16.05.05;	author kristaps;	state Exp;
branches;
next	1.216;

1.216
date	2009.09.21.16.03.07;	author kristaps;	state Exp;
branches;
next	1.215;

1.215
date	2009.09.21.15.01.33;	author kristaps;	state Exp;
branches;
next	1.214;

1.214
date	2009.09.21.14.56.56;	author kristaps;	state Exp;
branches;
next	1.213;

1.213
date	2009.09.21.13.44.56;	author kristaps;	state Exp;
branches;
next	1.212;

1.212
date	2009.09.21.13.06.13;	author kristaps;	state Exp;
branches;
next	1.211;

1.211
date	2009.09.21.00.39.02;	author kristaps;	state Exp;
branches;
next	1.210;

1.210
date	2009.09.17.07.41.28;	author kristaps;	state Exp;
branches;
next	1.209;

1.209
date	2009.09.16.22.17.27;	author kristaps;	state Exp;
branches;
next	1.208;

1.208
date	2009.09.16.14.40.56;	author kristaps;	state Exp;
branches;
next	1.207;

1.207
date	2009.09.15.08.16.20;	author kristaps;	state Exp;
branches;
next	1.206;

1.206
date	2009.09.05.10.37.09;	author kristaps;	state Exp;
branches;
next	1.205;

1.205
date	2009.08.21.13.18.32;	author kristaps;	state Exp;
branches;
next	1.204;

1.204
date	2009.08.17.11.10.02;	author kristaps;	state Exp;
branches;
next	1.203;

1.203
date	2009.08.13.11.45.29;	author kristaps;	state Exp;
branches;
next	1.202;

1.202
date	2009.07.28.11.59.18;	author kristaps;	state Exp;
branches;
next	1.201;

1.201
date	2009.07.26.10.35.55;	author kristaps;	state Exp;
branches;
next	1.200;

1.200
date	2009.07.23.09.49.01;	author kristaps;	state Exp;
branches;
next	1.199;

1.199
date	2009.07.20.19.34.39;	author kristaps;	state Exp;
branches;
next	1.198;

1.198
date	2009.07.19.09.46.12;	author kristaps;	state Exp;
branches;
next	1.197;

1.197
date	2009.07.19.09.22.05;	author kristaps;	state Exp;
branches;
next	1.196;

1.196
date	2009.07.19.08.49.57;	author kristaps;	state Exp;
branches;
next	1.195;

1.195
date	2009.07.17.13.23.26;	author kristaps;	state Exp;
branches;
next	1.194;

1.194
date	2009.07.16.14.07.23;	author kristaps;	state Exp;
branches;
next	1.193;

1.193
date	2009.07.16.13.40.48;	author kristaps;	state Exp;
branches;
next	1.192;

1.192
date	2009.07.14.15.59.59;	author kristaps;	state Exp;
branches;
next	1.191;

1.191
date	2009.07.12.09.16.32;	author kristaps;	state Exp;
branches;
next	1.190;

1.190
date	2009.07.07.09.52.08;	author kristaps;	state Exp;
branches;
next	1.189;

1.189
date	2009.07.05.19.25.45;	author kristaps;	state Exp;
branches;
next	1.188;

1.188
date	2009.07.04.11.19.07;	author kristaps;	state Exp;
branches;
next	1.187;

1.187
date	2009.07.04.09.01.55;	author kristaps;	state Exp;
branches;
next	1.186;

1.186
date	2009.06.25.10.52.56;	author kristaps;	state Exp;
branches;
next	1.185;

1.185
date	2009.06.25.08.42.06;	author kristaps;	state Exp;
branches;
next	1.184;

1.184
date	2009.06.22.13.13.10;	author kristaps;	state Exp;
branches;
next	1.183;

1.183
date	2009.06.17.19.12.03;	author kristaps;	state Exp;
branches;
next	1.182;

1.182
date	2009.06.17.14.17.07;	author kristaps;	state Exp;
branches;
next	1.181;

1.181
date	2009.06.17.07.59.47;	author kristaps;	state Exp;
branches;
next	1.180;

1.180
date	2009.06.15.20.26.47;	author kristaps;	state Exp;
branches;
next	1.179;

1.179
date	2009.06.15.11.26.17;	author kristaps;	state Exp;
branches;
next	1.178;

1.178
date	2009.06.13.18.05.53;	author kristaps;	state Exp;
branches;
next	1.177;

1.177
date	2009.06.12.12.54.04;	author kristaps;	state Exp;
branches;
next	1.176;

1.176
date	2009.06.12.12.52.50;	author kristaps;	state Exp;
branches;
next	1.175;

1.175
date	2009.06.11.13.34.14;	author kristaps;	state Exp;
branches;
next	1.174;

1.174
date	2009.06.11.13.15.10;	author kristaps;	state Exp;
branches;
next	1.173;

1.173
date	2009.06.11.10.16.39;	author kristaps;	state Exp;
branches;
next	1.172;

1.172
date	2009.04.12.19.49.35;	author kristaps;	state Exp;
branches;
next	1.171;

1.171
date	2009.04.06.10.12.30;	author kristaps;	state Exp;
branches;
next	1.170;

1.170
date	2009.04.06.08.53.39;	author kristaps;	state Exp;
branches;
next	1.169;

1.169
date	2009.04.05.16.38.57;	author kristaps;	state Exp;
branches;
next	1.168;

1.168
date	2009.04.05.16.34.22;	author kristaps;	state Exp;
branches;
next	1.167;

1.167
date	2009.04.03.13.18.26;	author kristaps;	state Exp;
branches;
next	1.166;

1.166
date	2009.04.02.16.26.35;	author kristaps;	state Exp;
branches;
next	1.165;

1.165
date	2009.03.31.13.50.19;	author kristaps;	state Exp;
branches;
next	1.164;

1.164
date	2009.03.27.15.00.15;	author kristaps;	state Exp;
branches;
next	1.163;

1.163
date	2009.03.27.13.44.24;	author kristaps;	state Exp;
branches;
next	1.162;

1.162
date	2009.03.26.16.23.22;	author kristaps;	state Exp;
branches;
next	1.161;

1.161
date	2009.03.26.14.44.41;	author kristaps;	state Exp;
branches;
next	1.160;

1.160
date	2009.03.26.14.38.11;	author kristaps;	state Exp;
branches;
next	1.159;

1.159
date	2009.03.26.11.19.15;	author kristaps;	state Exp;
branches;
next	1.158;

1.158
date	2009.03.26.11.16.21;	author kristaps;	state Exp;
branches;
next	1.157;

1.157
date	2009.03.26.09.55.39;	author kristaps;	state Exp;
branches;
next	1.156;

1.156
date	2009.03.25.15.36.05;	author kristaps;	state Exp;
branches;
next	1.155;

1.155
date	2009.03.25.15.17.49;	author kristaps;	state Exp;
branches;
next	1.154;

1.154
date	2009.03.25.11.39.25;	author kristaps;	state Exp;
branches;
next	1.153;

1.153
date	2009.03.24.20.05.43;	author kristaps;	state Exp;
branches;
next	1.152;

1.152
date	2009.03.23.21.46.04;	author kristaps;	state Exp;
branches;
next	1.151;

1.151
date	2009.03.23.21.20.42;	author kristaps;	state Exp;
branches;
next	1.150;

1.150
date	2009.03.23.21.20.24;	author kristaps;	state Exp;
branches;
next	1.149;

1.149
date	2009.03.23.15.20.51;	author kristaps;	state Exp;
branches;
next	1.148;

1.148
date	2009.03.23.14.22.11;	author kristaps;	state Exp;
branches;
next	1.147;

1.147
date	2009.03.22.21.19.34;	author kristaps;	state Exp;
branches;
next	1.146;

1.146
date	2009.03.22.19.14.29;	author kristaps;	state Exp;
branches;
next	1.145;

1.145
date	2009.03.22.19.10.48;	author kristaps;	state Exp;
branches;
next	1.144;

1.144
date	2009.03.22.19.08.53;	author kristaps;	state Exp;
branches;
next	1.143;

1.143
date	2009.03.22.19.01.11;	author kristaps;	state Exp;
branches;
next	1.142;

1.142
date	2009.03.22.08.52.27;	author kristaps;	state Exp;
branches;
next	1.141;

1.141
date	2009.03.21.13.47.02;	author kristaps;	state Exp;
branches;
next	1.140;

1.140
date	2009.03.21.13.37.48;	author kristaps;	state Exp;
branches;
next	1.139;

1.139
date	2009.03.21.13.21.35;	author kristaps;	state Exp;
branches;
next	1.138;

1.138
date	2009.03.21.09.45.49;	author kristaps;	state Exp;
branches;
next	1.137;

1.137
date	2009.03.20.19.56.25;	author kristaps;	state Exp;
branches;
next	1.136;

1.136
date	2009.03.20.16.43.28;	author kristaps;	state Exp;
branches;
next	1.135;

1.135
date	2009.03.20.15.14.01;	author kristaps;	state Exp;
branches;
next	1.134;

1.134
date	2009.03.19.16.40.49;	author kristaps;	state Exp;
branches;
next	1.133;

1.133
date	2009.03.19.16.18.36;	author kristaps;	state Exp;
branches;
next	1.132;

1.132
date	2009.03.19.16.17.27;	author kristaps;	state Exp;
branches;
next	1.131;

1.131
date	2009.03.19.11.49.00;	author kristaps;	state Exp;
branches;
next	1.130;

1.130
date	2009.03.17.09.33.02;	author kristaps;	state Exp;
branches;
next	1.129;

1.129
date	2009.03.17.08.57.03;	author kristaps;	state Exp;
branches;
next	1.128;

1.128
date	2009.03.16.23.37.28;	author kristaps;	state Exp;
branches;
next	1.127;

1.127
date	2009.03.16.22.19.19;	author kristaps;	state Exp;
branches;
next	1.126;

1.126
date	2009.03.15.07.30.51;	author kristaps;	state Exp;
branches;
next	1.125;

1.125
date	2009.03.15.07.08.52;	author kristaps;	state Exp;
branches;
next	1.124;

1.124
date	2009.03.14.12.35.02;	author kristaps;	state Exp;
branches;
next	1.123;

1.123
date	2009.03.14.05.36.07;	author kristaps;	state Exp;
branches;
next	1.122;

1.122
date	2009.03.13.14.17.41;	author kristaps;	state Exp;
branches;
next	1.121;

1.121
date	2009.03.12.23.05.21;	author kristaps;	state Exp;
branches;
next	1.120;

1.120
date	2009.03.12.16.30.50;	author kristaps;	state Exp;
branches;
next	1.119;

1.119
date	2009.03.12.15.55.11;	author kristaps;	state Exp;
branches;
next	1.118;

1.118
date	2009.03.12.06.33.51;	author kristaps;	state Exp;
branches;
next	1.117;

1.117
date	2009.03.11.00.41.35;	author kristaps;	state Exp;
branches;
next	1.116;

1.116
date	2009.03.10.15.01.54;	author kristaps;	state Exp;
branches;
next	1.115;

1.115
date	2009.03.09.14.20.59;	author kristaps;	state Exp;
branches;
next	1.114;

1.114
date	2009.03.09.13.35.09;	author kristaps;	state Exp;
branches;
next	1.113;

1.113
date	2009.03.09.13.17.49;	author kristaps;	state Exp;
branches;
next	1.112;

1.112
date	2009.03.09.13.04.01;	author kristaps;	state Exp;
branches;
next	1.111;

1.111
date	2009.03.08.19.48.37;	author kristaps;	state Exp;
branches;
next	1.110;

1.110
date	2009.03.08.19.32.03;	author kristaps;	state Exp;
branches;
next	1.109;

1.109
date	2009.03.08.14.01.46;	author kristaps;	state Exp;
branches;
next	1.108;

1.108
date	2009.03.06.14.13.47;	author kristaps;	state Exp;
branches;
next	1.107;

1.107
date	2009.03.05.13.12.12;	author kristaps;	state Exp;
branches;
next	1.106;

1.106
date	2009.03.05.12.08.52;	author kristaps;	state Exp;
branches;
next	1.105;

1.105
date	2009.03.04.14.41.40;	author kristaps;	state Exp;
branches;
next	1.104;

1.104
date	2009.03.03.22.28.21;	author kristaps;	state Exp;
branches;
next	1.103;

1.103
date	2009.03.02.17.14.46;	author kristaps;	state Exp;
branches;
next	1.102;

1.102
date	2009.03.01.23.25.07;	author kristaps;	state Exp;
branches;
next	1.101;

1.101
date	2009.03.01.20.17.03;	author kristaps;	state Exp;
branches;
next	1.100;

1.100
date	2009.03.01.20.07.20;	author kristaps;	state Exp;
branches;
next	1.99;

1.99
date	2009.03.01.20.05.32;	author kristaps;	state Exp;
branches;
next	1.98;

1.98
date	2009.03.01.13.09.03;	author kristaps;	state Exp;
branches;
next	1.97;

1.97
date	2009.02.28.22.27.17;	author kristaps;	state Exp;
branches;
next	1.96;

1.96
date	2009.02.28.14.48.03;	author kristaps;	state Exp;
branches;
next	1.95;

1.95
date	2009.02.28.13.49.11;	author kristaps;	state Exp;
branches;
next	1.94;

1.94
date	2009.02.28.13.47.36;	author kristaps;	state Exp;
branches;
next	1.93;

1.93
date	2009.02.28.12.16.38;	author kristaps;	state Exp;
branches;
next	1.92;

1.92
date	2009.02.28.10.15.25;	author kristaps;	state Exp;
branches;
next	1.91;

1.91
date	2009.02.28.09.51.50;	author kristaps;	state Exp;
branches;
next	1.90;

1.90
date	2009.02.27.17.24.30;	author kristaps;	state Exp;
branches;
next	1.89;

1.89
date	2009.02.27.09.39.40;	author kristaps;	state Exp;
branches;
next	1.88;

1.88
date	2009.02.27.09.16.12;	author kristaps;	state Exp;
branches;
next	1.87;

1.87
date	2009.02.27.08.20.15;	author kristaps;	state Exp;
branches;
next	1.86;

1.86
date	2009.02.25.12.38.15;	author kristaps;	state Exp;
branches;
next	1.85;

1.85
date	2009.02.25.12.37.18;	author kristaps;	state Exp;
branches;
next	1.84;

1.84
date	2009.02.24.12.20.52;	author kristaps;	state Exp;
branches;
next	1.83;

1.83
date	2009.02.24.11.43.13;	author kristaps;	state Exp;
branches;
next	1.82;

1.82
date	2009.02.23.22.51.10;	author kristaps;	state Exp;
branches;
next	1.81;

1.81
date	2009.02.23.20.55.56;	author kristaps;	state Exp;
branches;
next	1.80;

1.80
date	2009.02.23.16.01.33;	author kristaps;	state Exp;
branches;
next	1.79;

1.79
date	2009.02.23.15.19.47;	author kristaps;	state Exp;
branches;
next	1.78;

1.78
date	2009.02.23.13.05.06;	author kristaps;	state Exp;
branches;
next	1.77;

1.77
date	2009.02.23.07.09.13;	author kristaps;	state Exp;
branches;
next	1.76;

1.76
date	2009.02.22.22.58.39;	author kristaps;	state Exp;
branches;
next	1.75;

1.75
date	2009.02.21.21.00.06;	author kristaps;	state Exp;
branches;
next	1.74;

1.74
date	2009.02.21.19.05.28;	author kristaps;	state Exp;
branches;
next	1.73;

1.73
date	2009.02.21.14.56.57;	author kristaps;	state Exp;
branches;
next	1.72;

1.72
date	2009.02.20.23.35.36;	author kristaps;	state Exp;
branches;
next	1.71;

1.71
date	2009.02.20.11.04.23;	author kristaps;	state Exp;
branches;
next	1.70;

1.70
date	2009.02.20.07.45.41;	author kristaps;	state Exp;
branches;
next	1.69;

1.69
date	2009.02.20.07.43.15;	author kristaps;	state Exp;
branches;
next	1.68;

1.68
date	2009.01.22.14.56.21;	author kristaps;	state Exp;
branches;
next	1.67;

1.67
date	2009.01.22.12.21.03;	author kristaps;	state Exp;
branches;
next	1.66;

1.66
date	2009.01.21.17.56.32;	author kristaps;	state Exp;
branches;
next	1.65;

1.65
date	2009.01.21.11.35.26;	author kristaps;	state Exp;
branches;
next	1.64;

1.64
date	2009.01.20.22.55.46;	author kristaps;	state Exp;
branches;
next	1.63;

1.63
date	2009.01.20.15.11.16;	author kristaps;	state Exp;
branches;
next	1.62;

1.62
date	2009.01.20.15.06.07;	author kristaps;	state Exp;
branches;
next	1.61;

1.61
date	2009.01.20.15.05.01;	author kristaps;	state Exp;
branches;
next	1.60;

1.60
date	2009.01.20.13.44.05;	author kristaps;	state Exp;
branches;
next	1.59;

1.59
date	2009.01.17.16.47.02;	author kristaps;	state Exp;
branches;
next	1.58;

1.58
date	2009.01.17.14.04.25;	author kristaps;	state Exp;
branches;
next	1.57;

1.57
date	2009.01.08.15.05.50;	author kristaps;	state Exp;
branches;
next	1.56;

1.56
date	2009.01.05.14.14.04;	author kristaps;	state Exp;
branches;
next	1.55;

1.55
date	2009.01.01.20.40.16;	author kristaps;	state Exp;
branches;
next	1.54;

1.54
date	2008.12.30.18.15.26;	author kristaps;	state Exp;
branches;
next	1.53;

1.53
date	2008.12.23.05.30.49;	author kristaps;	state Exp;
branches;
next	1.52;

1.52
date	2008.12.15.03.13.01;	author kristaps;	state Exp;
branches;
next	1.51;

1.51
date	2008.12.15.02.23.12;	author kristaps;	state Exp;
branches;
next	1.50;

1.50
date	2008.12.15.01.54.58;	author kristaps;	state Exp;
branches;
next	1.49;

1.49
date	2008.12.10.17.40.56;	author kristaps;	state Exp;
branches;
next	1.48;

1.48
date	2008.12.10.16.03.12;	author kristaps;	state Exp;
branches;
next	1.47;

1.47
date	2008.12.10.14.42.45;	author kristaps;	state Exp;
branches;
next	1.46;

1.46
date	2008.12.10.13.41.58;	author kristaps;	state Exp;
branches;
next	1.45;

1.45
date	2008.12.10.13.15.55;	author kristaps;	state Exp;
branches;
next	1.44;

1.44
date	2008.12.10.12.10.51;	author kristaps;	state Exp;
branches;
next	1.43;

1.43
date	2008.12.10.12.09.47;	author kristaps;	state Exp;
branches;
next	1.42;

1.42
date	2008.12.10.12.05.33;	author kristaps;	state Exp;
branches;
next	1.41;

1.41
date	2008.12.10.10.43.57;	author kristaps;	state Exp;
branches;
next	1.40;

1.40
date	2008.12.10.00.58.15;	author kristaps;	state Exp;
branches;
next	1.39;

1.39
date	2008.12.10.00.52.46;	author kristaps;	state Exp;
branches;
next	1.38;

1.38
date	2008.12.09.19.57.26;	author kristaps;	state Exp;
branches;
next	1.37;

1.37
date	2008.12.09.17.09.12;	author kristaps;	state Exp;
branches;
next	1.36;

1.36
date	2008.12.08.16.29.57;	author kristaps;	state Exp;
branches;
next	1.35;

1.35
date	2008.12.08.12.47.54;	author kristaps;	state Exp;
branches;
next	1.34;

1.34
date	2008.12.08.12.46.28;	author kristaps;	state Exp;
branches;
next	1.33;

1.33
date	2008.12.07.23.50.01;	author kristaps;	state Exp;
branches;
next	1.32;

1.32
date	2008.12.07.23.44.19;	author kristaps;	state Exp;
branches;
next	1.31;

1.31
date	2008.12.07.23.08.23;	author kristaps;	state Exp;
branches;
next	1.30;

1.30
date	2008.12.07.22.40.18;	author kristaps;	state Exp;
branches;
next	1.29;

1.29
date	2008.12.07.21.30.49;	author kristaps;	state Exp;
branches;
next	1.28;

1.28
date	2008.12.07.14.38.57;	author kristaps;	state Exp;
branches;
next	1.27;

1.27
date	2008.12.05.22.54.44;	author kristaps;	state Exp;
branches;
next	1.26;

1.26
date	2008.12.05.19.45.15;	author kristaps;	state Exp;
branches;
next	1.25;

1.25
date	2008.12.04.23.10.51;	author kristaps;	state Exp;
branches;
next	1.24;

1.24
date	2008.12.04.19.31.57;	author kristaps;	state Exp;
branches;
next	1.23;

1.23
date	2008.12.04.16.19.52;	author kristaps;	state Exp;
branches;
next	1.22;

1.22
date	2008.12.04.11.25.29;	author kristaps;	state Exp;
branches;
next	1.21;

1.21
date	2008.12.03.14.39.59;	author kristaps;	state Exp;
branches;
next	1.20;

1.20
date	2008.12.02.18.26.57;	author kristaps;	state Exp;
branches;
next	1.19;

1.19
date	2008.12.02.13.20.24;	author kristaps;	state Exp;
branches;
next	1.18;

1.18
date	2008.12.02.00.10.37;	author kristaps;	state Exp;
branches;
next	1.17;

1.17
date	2008.12.01.21.25.48;	author kristaps;	state Exp;
branches;
next	1.16;

1.16
date	2008.12.01.16.01.28;	author kristaps;	state Exp;
branches;
next	1.15;

1.15
date	2008.12.01.15.32.36;	author kristaps;	state Exp;
branches;
next	1.14;

1.14
date	2008.11.30.21.41.35;	author kristaps;	state Exp;
branches;
next	1.13;

1.13
date	2008.11.30.20.53.34;	author kristaps;	state Exp;
branches;
next	1.12;

1.12
date	2008.11.28.11.21.12;	author kristaps;	state Exp;
branches;
next	1.11;

1.11
date	2008.11.27.13.29.44;	author kristaps;	state Exp;
branches;
next	1.10;

1.10
date	2008.11.27.11.23.51;	author kristaps;	state Exp;
branches;
next	1.9;

1.9
date	2008.11.26.22.27.07;	author kristaps;	state Exp;
branches;
next	1.8;

1.8
date	2008.11.26.21.42.59;	author kristaps;	state Exp;
branches;
next	1.7;

1.7
date	2008.11.26.16.50.34;	author kristaps;	state Exp;
branches;
next	1.6;

1.6
date	2008.11.24.14.24.55;	author kristaps;	state Exp;
branches;
next	1.5;

1.5
date	2008.11.23.22.30.53;	author kristaps;	state Exp;
branches;
next	1.4;

1.4
date	2008.11.23.16.53.18;	author kristaps;	state Exp;
branches;
next	1.3;

1.3
date	2008.11.22.20.15.34;	author kristaps;	state Exp;
branches;
next	1.2;

1.2
date	2008.11.22.14.54.55;	author kristaps;	state Exp;
branches;
next	1.1;

1.1
date	2008.11.22.14.53.29;	author kristaps;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2008.11.22.14.53.29;	author kristaps;	state Exp;
branches;
next	;

1.395.2.1
date	2013.09.18.02.19.37;	author schwarze;	state Exp;
branches;
next	1.395.2.2;

1.395.2.2
date	2013.09.18.02.24.37;	author schwarze;	state Exp;
branches;
next	1.395.2.3;

1.395.2.3
date	2013.09.18.16.20.11;	author schwarze;	state Exp;
branches;
next	1.395.2.4;

1.395.2.4
date	2013.09.29.23.28.48;	author schwarze;	state Exp;
branches;
next	1.395.2.5;

1.395.2.5
date	2013.10.01.00.55.07;	author schwarze;	state Exp;
branches;
next	1.395.2.6;

1.395.2.6
date	2013.10.05.13.15.51;	author schwarze;	state Exp;
branches;
next	1.395.2.7;

1.395.2.7
date	2013.10.05.20.30.05;	author schwarze;	state Exp;
branches;
next	1.395.2.8;

1.395.2.8
date	2013.10.06.23.17.05;	author schwarze;	state Exp;
branches;
next	1.395.2.9;

1.395.2.9
date	2013.12.31.11.23.23;	author schwarze;	state Exp;
branches;
next	1.395.2.10;

1.395.2.10
date	2013.12.31.23.19.04;	author schwarze;	state Exp;
branches;
next	1.395.2.11;

1.395.2.11
date	2014.01.04.01.24.48;	author schwarze;	state Exp;
branches;
next	1.395.2.12;

1.395.2.12
date	2014.01.04.13.49.22;	author schwarze;	state Exp;
branches;
next	1.395.2.13;

1.395.2.13
date	2014.01.04.14.44.28;	author schwarze;	state Exp;
branches;
next	1.395.2.14;

1.395.2.14
date	2014.03.03.19.09.21;	author schwarze;	state Exp;
branches;
next	1.395.2.15;

1.395.2.15
date	2014.03.23.12.04.54;	author schwarze;	state Exp;
branches;
next	1.395.2.16;

1.395.2.16
date	2014.04.22.22.05.24;	author schwarze;	state Exp;
branches;
next	1.395.2.17;

1.395.2.17
date	2014.04.23.21.31.38;	author schwarze;	state Exp;
branches;
next	1.395.2.18;

1.395.2.18
date	2014.04.24.00.36.44;	author schwarze;	state Exp;
branches;
next	1.395.2.19;

1.395.2.19
date	2014.08.04.23.45.37;	author schwarze;	state Exp;
branches;
next	1.395.2.20;

1.395.2.20
date	2014.08.05.00.42.53;	author schwarze;	state Exp;
branches;
next	1.395.2.21;

1.395.2.21
date	2014.08.05.01.07.42;	author schwarze;	state Exp;
branches;
next	1.395.2.22;

1.395.2.22
date	2014.08.05.01.46.07;	author schwarze;	state Exp;
branches;
next	1.395.2.23;

1.395.2.23
date	2014.08.05.03.15.22;	author schwarze;	state Exp;
branches;
next	1.395.2.24;

1.395.2.24
date	2014.08.05.05.29.53;	author schwarze;	state Exp;
branches;
next	1.395.2.25;

1.395.2.25
date	2014.08.05.05.51.33;	author schwarze;	state Exp;
branches;
next	1.395.2.26;

1.395.2.26
date	2014.08.05.11.19.46;	author schwarze;	state Exp;
branches;
next	1.395.2.27;

1.395.2.27
date	2014.08.11.00.31.13;	author schwarze;	state Exp;
branches;
next	1.395.2.28;

1.395.2.28
date	2014.08.12.21.37.42;	author schwarze;	state Exp;
branches;
next	1.395.2.29;

1.395.2.29
date	2014.08.14.20.43.22;	author schwarze;	state Exp;
branches;
next	;


desc
@@


1.480
log
@move compat_reallocarray.o into SOELIM_OBJS, no functional change
@
text
@# $Id: Makefile,v 1.479 2015/11/07 21:38:28 schwarze Exp $
#
# Copyright (c) 2010, 2011, 2012 Kristaps Dzonsons <kristaps@@bsd.lv>
# Copyright (c) 2011, 2013, 2014, 2015 Ingo Schwarze <schwarze@@openbsd.org>
#
# Permission to use, copy, modify, and distribute this software for any
# purpose with or without fee is hereby granted, provided that the above
# copyright notice and this permission notice appear in all copies.
#
# THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
# WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
# MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
# ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
# WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
# ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
# OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.

VERSION = 1.13.3

# === LIST OF FILES ====================================================

TESTSRCS	 = test-dirent-namlen.c \
		   test-err.c \
		   test-fts.c \
		   test-getline.c \
		   test-getsubopt.c \
		   test-isblank.c \
		   test-mkdtemp.c \
		   test-mmap.c \
		   test-ohash.c \
		   test-pledge.c \
		   test-progname.c \
		   test-reallocarray.c \
		   test-sqlite3.c \
		   test-sqlite3_errstr.c \
		   test-strcasestr.c \
		   test-stringlist.c \
		   test-strlcat.c \
		   test-strlcpy.c \
		   test-strptime.c \
		   test-strsep.c \
		   test-strtonum.c \
		   test-vasprintf.c \
		   test-wchar.c

SRCS		 = att.c \
		   cgi.c \
		   chars.c \
		   compat_err.c \
		   compat_fts.c \
		   compat_getline.c \
		   compat_getsubopt.c \
		   compat_isblank.c \
		   compat_mkdtemp.c \
		   compat_ohash.c \
		   compat_progname.c \
		   compat_reallocarray.c \
		   compat_sqlite3_errstr.c \
		   compat_strcasestr.c \
		   compat_stringlist.c \
		   compat_strlcat.c \
		   compat_strlcpy.c \
		   compat_strsep.c \
		   compat_strtonum.c \
		   compat_vasprintf.c \
		   demandoc.c \
		   eqn.c \
		   eqn_html.c \
		   eqn_term.c \
		   html.c \
		   lib.c \
		   main.c \
		   man.c \
		   man_hash.c \
		   man_html.c \
		   man_macro.c \
		   man_term.c \
		   man_validate.c \
		   mandoc.c \
		   mandoc_aux.c \
		   mandoc_ohash.c \
		   mandocdb.c \
		   manpage.c \
		   manpath.c \
		   mansearch.c \
		   mansearch_const.c \
		   mdoc.c \
		   mdoc_argv.c \
		   mdoc_hash.c \
		   mdoc_html.c \
		   mdoc_macro.c \
		   mdoc_man.c \
		   mdoc_state.c \
		   mdoc_term.c \
		   mdoc_validate.c \
		   msec.c \
		   out.c \
		   preconv.c \
		   read.c \
		   roff.c \
		   soelim.c \
		   st.c \
		   tag.c \
		   tbl.c \
		   tbl_data.c \
		   tbl_html.c \
		   tbl_layout.c \
		   tbl_opts.c \
		   tbl_term.c \
		   term.c \
		   term_ascii.c \
		   term_ps.c \
		   tree.c

DISTFILES	 = INSTALL \
		   LICENSE \
		   Makefile \
		   Makefile.depend \
		   NEWS \
		   TODO \
		   apropos.1 \
		   cgi.h.example \
		   compat_fts.h \
		   compat_ohash.h \
		   compat_stringlist.h \
		   configure \
		   configure.local.example \
		   demandoc.1 \
		   eqn.7 \
		   gmdiff \
		   html.h \
		   lib.in \
		   libman.h \
		   libmandoc.h \
		   libmdoc.h \
		   libroff.h \
		   main.h \
		   makewhatis.8 \
		   man.1 \
		   man.7 \
		   man.cgi.8 \
		   man.conf.5 \
		   man.h \
		   manconf.h \
		   mandoc.1 \
		   mandoc.3 \
		   mandoc.css \
		   mandoc.db.5 \
		   mandoc.h \
		   mandoc_aux.h \
		   mandoc_char.7 \
		   mandoc_escape.3 \
		   mandoc_headers.3 \
		   mandoc_html.3 \
		   mandoc_malloc.3 \
		   mandoc_ohash.h \
		   mansearch.3 \
		   mansearch.h \
		   mchars_alloc.3 \
		   mdoc.7 \
		   mdoc.h \
		   msec.in \
		   out.h \
		   predefs.in \
		   roff.7 \
		   roff.h \
		   soelim.1 \
		   st.in \
		   tag.h \
		   tbl.3 \
		   tbl.7 \
		   term.h \
		   $(SRCS) \
		   $(TESTSRCS)

LIBMAN_OBJS	 = man.o \
		   man_hash.o \
		   man_macro.o \
		   man_validate.o

LIBMDOC_OBJS	 = att.o \
		   lib.o \
		   mdoc.o \
		   mdoc_argv.o \
		   mdoc_hash.o \
		   mdoc_macro.o \
		   mdoc_state.o \
		   mdoc_validate.o \
		   st.o

LIBROFF_OBJS	 = eqn.o \
		   roff.o \
		   tbl.o \
		   tbl_data.o \
		   tbl_layout.o \
		   tbl_opts.o

LIBMANDOC_OBJS	 = $(LIBMAN_OBJS) \
		   $(LIBMDOC_OBJS) \
		   $(LIBROFF_OBJS) \
		   chars.o \
		   mandoc.o \
		   mandoc_aux.o \
		   mandoc_ohash.o \
		   msec.o \
		   preconv.o \
		   read.o

COMPAT_OBJS	 = compat_err.o \
		   compat_fts.o \
		   compat_getline.o \
		   compat_getsubopt.o \
		   compat_isblank.o \
		   compat_mkdtemp.o \
		   compat_ohash.o \
		   compat_progname.o \
		   compat_reallocarray.o \
		   compat_sqlite3_errstr.o \
		   compat_strcasestr.o \
		   compat_strlcat.o \
		   compat_strlcpy.o \
		   compat_strsep.o \
		   compat_strtonum.o \
		   compat_vasprintf.o

MANDOC_HTML_OBJS = eqn_html.o \
		   html.o \
		   man_html.o \
		   mdoc_html.o \
		   tbl_html.o

MANDOC_MAN_OBJS  = mdoc_man.o

MANDOC_TERM_OBJS = eqn_term.o \
		   man_term.o \
		   mdoc_term.o \
		   term.o \
		   term_ascii.o \
		   term_ps.o \
		   tbl_term.o

BASE_OBJS	 = $(MANDOC_HTML_OBJS) \
		   $(MANDOC_MAN_OBJS) \
		   $(MANDOC_TERM_OBJS) \
		   main.o \
		   manpath.o \
		   out.o \
		   tag.o \
		   tree.o

MAIN_OBJS	 = $(BASE_OBJS)

DB_OBJS		 = mandocdb.o \
		   mansearch.o \
		   mansearch_const.o

CGI_OBJS	 = $(MANDOC_HTML_OBJS) \
		   cgi.o \
		   mansearch.o \
		   mansearch_const.o \
		   out.o

MANPAGE_OBJS	 = manpage.o mansearch.o mansearch_const.o manpath.o

DEMANDOC_OBJS	 = demandoc.o

SOELIM_OBJS	 = soelim.o \
		   compat_err.o \
		   compat_getline.o \
		   compat_progname.o \
		   compat_reallocarray.o \
		   compat_stringlist.o

WWW_MANS	 = apropos.1.html \
		   demandoc.1.html \
		   man.1.html \
		   mandoc.1.html \
		   soelim.1.html \
		   mandoc.3.html \
		   mandoc_escape.3.html \
		   mandoc_headers.3.html \
		   mandoc_html.3.html \
		   mandoc_malloc.3.html \
		   mansearch.3.html \
		   mchars_alloc.3.html \
		   tbl.3.html \
		   man.conf.5.html \
		   mandoc.db.5.html \
		   eqn.7.html \
		   man.7.html \
		   mandoc_char.7.html \
		   mdoc.7.html \
		   roff.7.html \
		   tbl.7.html \
		   makewhatis.8.html \
		   man.cgi.8.html \
		   man.h.html \
		   manconf.h.html \
		   mandoc.h.html \
		   mandoc_aux.h.html \
		   mansearch.h.html \
		   mdoc.h.html \
		   roff.h.html

WWW_OBJS	 = mdocml.tar.gz \
		   mdocml.sha256

# === USER CONFIGURATION ===============================================

include Makefile.local

# === DEPENDENCY HANDLING ==============================================

all: base-build $(BUILD_TARGETS) Makefile.local

base-build: mandoc demandoc soelim

cgi-build: man.cgi

install: base-install $(INSTALL_TARGETS)

www: $(WWW_OBJS) $(WWW_MANS)

$(WWW_MANS): mandoc

.PHONY: base-install cgi-install db-install install www-install
.PHONY: clean distclean depend

include Makefile.depend

# === TARGETS CONTAINING SHELL COMMANDS ================================

distclean: clean
	rm -f Makefile.local config.h config.h.old config.log config.log.old

clean:
	rm -f libmandoc.a $(LIBMANDOC_OBJS) $(COMPAT_OBJS)
	rm -f mandoc $(BASE_OBJS) $(DB_OBJS)
	rm -f man.cgi $(CGI_OBJS)
	rm -f manpage $(MANPAGE_OBJS)
	rm -f demandoc $(DEMANDOC_OBJS)
	rm -f soelim $(SOELIM_OBJS)
	rm -f $(WWW_MANS) $(WWW_OBJS)
	rm -rf *.dSYM

base-install: base-build
	mkdir -p $(DESTDIR)$(BINDIR)
	mkdir -p $(DESTDIR)$(LIBDIR)
	mkdir -p $(DESTDIR)$(INCLUDEDIR)
	mkdir -p $(DESTDIR)$(MANDIR)/man1
	mkdir -p $(DESTDIR)$(MANDIR)/man3
	mkdir -p $(DESTDIR)$(MANDIR)/man5
	mkdir -p $(DESTDIR)$(MANDIR)/man7
	$(INSTALL_PROGRAM) mandoc demandoc $(DESTDIR)$(BINDIR)
	$(INSTALL_PROGRAM) soelim $(DESTDIR)$(BINDIR)/$(BINM_SOELIM)
	ln -f $(DESTDIR)$(BINDIR)/mandoc $(DESTDIR)$(BINDIR)/$(BINM_MAN)
	$(INSTALL_LIB) libmandoc.a $(DESTDIR)$(LIBDIR)
	$(INSTALL_LIB) man.h mandoc.h mandoc_aux.h mdoc.h roff.h \
		$(DESTDIR)$(INCLUDEDIR)
	$(INSTALL_MAN) mandoc.1 demandoc.1 $(DESTDIR)$(MANDIR)/man1
	$(INSTALL_MAN) soelim.1 $(DESTDIR)$(MANDIR)/man1/$(BINM_SOELIM).1
	$(INSTALL_MAN) man.1 $(DESTDIR)$(MANDIR)/man1/$(BINM_MAN).1
	$(INSTALL_MAN) mandoc.3 mandoc_escape.3 mandoc_malloc.3 \
		mchars_alloc.3 tbl.3 $(DESTDIR)$(MANDIR)/man3
	$(INSTALL_MAN) man.conf.5 $(DESTDIR)$(MANDIR)/man5/${MANM_MANCONF}.5
	$(INSTALL_MAN) man.7 $(DESTDIR)$(MANDIR)/man7/${MANM_MAN}.7
	$(INSTALL_MAN) mdoc.7 $(DESTDIR)$(MANDIR)/man7/${MANM_MDOC}.7
	$(INSTALL_MAN) roff.7 $(DESTDIR)$(MANDIR)/man7/${MANM_ROFF}.7
	$(INSTALL_MAN) eqn.7 $(DESTDIR)$(MANDIR)/man7/${MANM_EQN}.7
	$(INSTALL_MAN) tbl.7 $(DESTDIR)$(MANDIR)/man7/${MANM_TBL}.7
	$(INSTALL_MAN) mandoc_char.7 $(DESTDIR)$(MANDIR)/man7

db-install: base-build
	mkdir -p $(DESTDIR)$(BINDIR)
	mkdir -p $(DESTDIR)$(SBINDIR)
	mkdir -p $(DESTDIR)$(MANDIR)/man1
	mkdir -p $(DESTDIR)$(MANDIR)/man3
	mkdir -p $(DESTDIR)$(MANDIR)/man5
	mkdir -p $(DESTDIR)$(MANDIR)/man8
	ln -f $(DESTDIR)$(BINDIR)/mandoc $(DESTDIR)$(BINDIR)/$(BINM_APROPOS)
	ln -f $(DESTDIR)$(BINDIR)/mandoc $(DESTDIR)$(BINDIR)/$(BINM_WHATIS)
	ln -f $(DESTDIR)$(BINDIR)/mandoc \
		$(DESTDIR)$(SBINDIR)/$(BINM_MAKEWHATIS)
	$(INSTALL_MAN) apropos.1 $(DESTDIR)$(MANDIR)/man1/$(BINM_APROPOS).1
	ln -f $(DESTDIR)$(MANDIR)/man1/$(BINM_APROPOS).1 \
		$(DESTDIR)$(MANDIR)/man1/$(BINM_WHATIS).1
	$(INSTALL_MAN) mansearch.3 $(DESTDIR)$(MANDIR)/man3
	$(INSTALL_MAN) mandoc.db.5 $(DESTDIR)$(MANDIR)/man5
	$(INSTALL_MAN) makewhatis.8 \
		$(DESTDIR)$(MANDIR)/man8/$(BINM_MAKEWHATIS).8

cgi-install: cgi-build
	mkdir -p $(DESTDIR)$(CGIBINDIR)
	mkdir -p $(DESTDIR)$(HTDOCDIR)
	mkdir -p $(DESTDIR)$(WWWPREFIX)/man/mandoc/man1
	mkdir -p $(DESTDIR)$(WWWPREFIX)/man/mandoc/man8
	$(INSTALL_PROGRAM) man.cgi $(DESTDIR)$(CGIBINDIR)
	$(INSTALL_DATA) mandoc.css $(DESTDIR)$(HTDOCDIR)
	$(INSTALL_MAN) apropos.1 $(DESTDIR)$(WWWPREFIX)/man/mandoc/man1/
	$(INSTALL_MAN) man.cgi.8 $(DESTDIR)$(WWWPREFIX)/man/mandoc/man8/

Makefile.local config.h: configure ${TESTSRCS}
	@@echo "$@@ is out of date; please run ./configure"
	@@exit 1

libmandoc.a: $(COMPAT_OBJS) $(LIBMANDOC_OBJS)
	$(AR) rs $@@ $(COMPAT_OBJS) $(LIBMANDOC_OBJS)

mandoc: $(MAIN_OBJS) libmandoc.a
	$(CC) $(LDFLAGS) -o $@@ $(MAIN_OBJS) libmandoc.a $(DBLIB)

manpage: $(MANPAGE_OBJS) libmandoc.a
	$(CC) $(LDFLAGS) -o $@@ $(MANPAGE_OBJS) libmandoc.a $(DBLIB)

man.cgi: $(CGI_OBJS) libmandoc.a
	$(CC) $(LDFLAGS) $(STATIC) -o $@@ $(CGI_OBJS) libmandoc.a $(DBLIB)

demandoc: $(DEMANDOC_OBJS) libmandoc.a
	$(CC) $(LDFLAGS) -o $@@ $(DEMANDOC_OBJS) libmandoc.a $(DBLIB)

soelim: $(SOELIM_OBJS)
	$(CC) $(LDFLAGS) -o $@@ $(SOELIM_OBJS)

# --- maintainer targets ---

www-install: www
	mkdir -p $(HTDOCDIR)/snapshots
	$(INSTALL_DATA) $(WWW_MANS) mandoc.css $(HTDOCDIR)
	$(INSTALL_DATA) $(WWW_OBJS) $(HTDOCDIR)/snapshots
	$(INSTALL_DATA) mdocml.tar.gz \
		$(HTDOCDIR)/snapshots/mdocml-$(VERSION).tar.gz
	$(INSTALL_DATA) mdocml.sha256 \
		$(HTDOCDIR)/snapshots/mdocml-$(VERSION).sha256

depend: config.h
	mkdep -f Makefile.depend $(CFLAGS) $(SRCS)
	perl -e 'undef $$/; $$_ = <>; s|/usr/include/\S+||g; \
		s|\\\n||g; s|  +| |g; s| $$||mg; print;' \
		Makefile.depend > Makefile.tmp
	mv Makefile.tmp Makefile.depend

mdocml.sha256: mdocml.tar.gz
	sha256 mdocml.tar.gz > $@@

mdocml.tar.gz: $(DISTFILES)
	mkdir -p .dist/mdocml-$(VERSION)/
	$(INSTALL) -m 0644 $(DISTFILES) .dist/mdocml-$(VERSION)
	chmod 755 .dist/mdocml-$(VERSION)/configure
	( cd .dist/ && tar zcf ../$@@ mdocml-$(VERSION) )
	rm -rf .dist/

# === SUFFIX RULES =====================================================

.SUFFIXES:	 .1       .3       .5       .7       .8       .h
.SUFFIXES:	 .1.html  .3.html  .5.html  .7.html  .8.html  .h.html

.h.h.html:
	highlight -I $< > $@@

.1.1.html .3.3.html .5.5.html .7.7.html .8.8.html: mandoc
	./mandoc -Thtml -Wall,stop \
		-Ostyle=mandoc.css,man=%N.%S.html,includes=%I.html $< > $@@
@


1.479
log
@soelim(1) use getline(3) and err(3), and err(3) uses getprogname(3);
found on Solaris 10 at OpenCSW
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.478 2015/11/07 20:52:52 schwarze Exp $
d271 1
d421 2
a422 2
soelim: $(SOELIM_OBJS) compat_reallocarray.o
	$(CC) $(LDFLAGS) -o $@@ $(SOELIM_OBJS) compat_reallocarray.o
@


1.478
log
@provide a simple stand-alone implementation of getline(3)
for systems lacking it
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.477 2015/11/07 17:58:55 schwarze Exp $
d267 5
a271 1
SOELIM_OBJS	 = soelim.o compat_stringlist.o
@


1.477
log
@Modernization, no functional change intended:
Use the POSIX function getline(3) rather than the slightly
dangerous BSD function fgetln(3).
Remove the related compatibility code.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.476 2015/11/07 13:14:21 schwarze Exp $
d25 1
d51 1
d211 1
@


1.476
log
@garbage collect unused EXAMPLEDIR, forgotten in the CSS cleanup;
noticed by Peter Bray <pdb_ml at yahoo dot com dot au>
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.475 2015/11/07 13:05:14 schwarze Exp $
a23 1
		   test-fgetln.c \
a48 1
		   compat_fgetln.c \
a207 1
		   compat_fgetln.o \
@


1.475
log
@Install the soelim(1) binary and manual to the right places.
Bug reported by Peter Bray <pdb_ml at yahoo dot com dot au>.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.474 2015/11/06 17:33:34 schwarze Exp $
a342 1
	mkdir -p $(DESTDIR)$(EXAMPLEDIR)
@


1.474
log
@merge pledge(2) support from OpenBSD
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.473 2015/11/06 16:30:33 schwarze Exp $
d350 2
a351 1
	$(INSTALL_PROGRAM) mandoc demandoc soelim $(DESTDIR)$(BINDIR)
d356 2
a357 1
	$(INSTALL_MAN) mandoc.1 demandoc.1 soelim.1 $(DESTDIR)$(MANDIR)/man1
@


1.473
log
@Use getprogname(3) rather than __progname.
Suggested by Joerg@@ Sonnenberger (NetBSD).
Last year, deraadt@@ confirmed on tech@@ that this "has the potential
to be more portable", and micro-optimizing for speed is not relevant
here.  Also gets rid of one global variable.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.472 2015/11/05 17:47:51 schwarze Exp $
d31 1
@


1.472
log
@Unify the three stylesheets into a single CSS file.
Many thanks to bentley@@ for doing this work.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.471 2015/11/05 17:16:34 schwarze Exp $
d55 1
d215 1
@


1.471
log
@demandoc(1) needs to link against -lutil, too
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.470 2015/10/20 02:01:31 schwarze Exp $
a127 1
		   example.style.css \
a136 1
		   man-cgi.css \
d145 1
a166 1
		   style.css \
a362 1
	$(INSTALL_DATA) example.style.css $(DESTDIR)$(EXAMPLEDIR)
d389 1
a389 2
	$(INSTALL_DATA) example.style.css $(DESTDIR)$(HTDOCDIR)/man.css
	$(INSTALL_DATA) man-cgi.css $(DESTDIR)$(HTDOCDIR)
d419 1
a419 1
	$(INSTALL_DATA) $(WWW_MANS) style.css $(HTDOCDIR)
d453 1
a453 1
		-Ostyle=style.css,man=%N.%S.html,includes=%I.html $< > $@@
@


1.470
log
@In order to become able to generate syntax tree nodes on the roff(7)
level, validation must be separated from parsing and rewinding.
This first big step moves calling of the mdoc(7) post_*() functions
out of the parser loop into their own mdoc_validate() pass, while
using a new mdoc_state() module to make syntax tree state handling
available to both the parser loop and the validation pass.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.469 2015/10/13 22:59:54 schwarze Exp $
d414 1
a414 1
	$(CC) $(LDFLAGS) -o $@@ $(DEMANDOC_OBJS) libmandoc.a -lz
@


1.469
log
@Major character table cleanup:
* Use ohash(3) rather than a hand-rolled hash table.
* Make the character table static in the chars.c module:
There is no need to pass a pointer around, we most certainly
never want to use two different character tables concurrently.
* No need to keep the characters in a separate file chars.in;
that merely encourages downstream porters to mess with them.
* Sort the characters to agree with the mandoc_chars(7) manual page.
* Specify Unicode codepoints in hex, not decimal (that's the detail
that originally triggered this patch).
No functional change, minus 100 LOC, and i don't see a performance change.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.468 2015/10/13 15:53:05 schwarze Exp $
d91 1
d187 1
@


1.468
log
@Reduce the amount of code by moving the three copies of the ohash
callback functions into one common place, preparing for the use of
ohash for some additional purposes.  No functional change.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.467 2015/10/11 21:12:54 schwarze Exp $
a119 1
		   chars.in \
@


1.467
log
@Finally use __progname, err(3) and warn(3).
That's more readable and less error-prone than fumbling around
with argv[0], fprintf(3), strerror(3), perror(3), and exit(3).

It's a bad idea to boycott good interfaces merely because standards
committees ignore them.  Instead, let's provide compatibility modules
for archaic systems (like commercial Solaris) that still don't have
them.  The compat module has an UCB Copyright (c) 1993...
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.466 2015/07/19 06:05:16 schwarze Exp $
d79 1
d155 1
d203 1
@


1.466
log
@Do not fork and exec gunzip(1), just link with libz instead.
As discussed with deraadt@@, that's cleaner and will help tame(2).
Something like this was also suggested earlier by bapt at FreeBSD.
Minus 50 lines of code, deleting one interface function (mparse_wait),
no functional change intended.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.465 2015/07/17 22:38:29 schwarze Exp $
d23 1
d31 1
d48 1
d205 2
a206 1
COMPAT_OBJS	 = compat_fgetln.o \
@


1.465
log
@Initial, still somewhat experimental implementation to leverage
less(1) -T and :t ctags(1)-like functionality to jump to the
definitions of various terms inside manual pages.
To be polished in the tree, so bear with me and report issues.

Technically, if less(1) is used as a pager, information is collected
by the mdoc(7) terminal formatter, first stored using the ohash
library, then ultimately written to a temporary file which is passed
to less via -T.  No change intended for other output formatters or
when running without a pager.

Based on an idea from Kristaps using feedback from many, in particular
phessler@@ nicm@@ millert@@ halex@@ doug@@ kspillner@@ deraadt@@.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.464 2015/07/14 23:16:29 schwarze Exp $
d406 1
a406 1
	$(CC) $(LDFLAGS) -o $@@ $(DEMANDOC_OBJS) libmandoc.a
@


1.464
log
@Fix the "depend" target and regenerate Makefile.depend:
* do not process the test-*.c files, they are not built via make
* add the missing compat_stringlist.c and soelim.c
* read.c now uses roff_int.h
* roff.c no longer uses libmdoc.h
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.463 2015/05/21 00:04:38 schwarze Exp $
d96 1
d164 1
d239 1
@


1.463
log
@Link compat_reallocarray.o into soelim; needed on
platforms having neither stringlist nor compat_reallocarray.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.462 2015/05/20 22:22:59 schwarze Exp $
d105 1
a105 2
		   tree.c \
		   $(TESTSRCS)
d166 2
a167 1
		   $(SRCS)
@


1.462
log
@* remove FreeBSDisms
* purge and sort headers
* add build and compat glue
* and LICENSE information
for soelim(1)
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.461 2015/04/02 21:36:49 schwarze Exp $
d405 2
a406 2
soelim: $(SOELIM_OBJS)
	$(CC) $(LDFLAGS) -o $@@ $(SOELIM_OBJS)
@


1.461
log
@First step towards parser unification:
Replace enum mdoc_type and enum man_type by a unified enum roff_type.
Almost mechanical, no functional change.
Written on the ICE train from Frankfurt to Bruxelles on the way to p2k15.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.460 2015/03/27 17:37:25 schwarze Exp $
d34 1
d55 1
d94 1
d119 1
d161 1
d255 2
d261 1
d299 1
a299 1
base-build: mandoc demandoc
d325 1
d338 1
a338 1
	$(INSTALL_PROGRAM) mandoc demandoc $(DESTDIR)$(BINDIR)
d343 1
a343 1
	$(INSTALL_MAN) mandoc.1 demandoc.1 $(DESTDIR)$(MANDIR)/man1
d405 3
@


1.460
log
@Parse the new man.conf(5) "output" directive.
The next step will be to actually use the parsed data.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.459 2015/03/27 00:18:14 schwarze Exp $
d156 1
d277 2
a278 1
		   mdoc.h.html
d332 1
a332 1
	$(INSTALL_LIB) man.h mandoc.h mandoc_aux.h mdoc.h \
@


1.459
log
@Add man.conf(5).  After adding some additional functionality,
one of the next steps will be to use it in addition to manpath(1)
rather than as an alternative to it.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.458 2015/03/19 14:57:29 schwarze Exp $
d136 1
a146 1
		   manpath.h \
d272 1
a274 1
		   manpath.h.html \
@


1.458
log
@Compat glue needed for Solaris 9 and 10.

Thanks to Sevan Janiyan <venture37 at geeklan dot co dot uk> for
reporting the Solaris 10 issues, to Jan Holzhueter <jh at opencsw
dot org> for some additional insight, and to OpenCSW in general for
providing me with a Solaris 9/10/11 testing environment.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.457 2015/03/13 12:35:32 schwarze Exp $
d134 1
d261 1
d325 1
d336 1
@


1.457
log
@release 1.13.3
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.456 2015/02/16 16:23:54 schwarze Exp $
d26 2
d39 1
d48 2
d58 1
d196 2
d205 2
a206 1
		   compat_strtonum.o
@


1.456
log
@Delete the -V option.  It serves no purpose but keeps confusing people.

Keeping track of the versions of installed software is the job of
the package manager, not of the individual binaries.  If individual
binaries include version numbers, that tends to goad people into
writing broken configuration tests that inspect version numbers
instead of properly testing for features.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.455 2015/02/16 14:56:22 schwarze Exp $
d4 1
a4 1
# Copyright (c) 2011, 2013, 2014 Ingo Schwarze <schwarze@@openbsd.org>
d18 1
a18 1
VERSION = 1.13.2
@


1.455
log
@strtonum(3) compat glue
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.454 2015/02/03 21:16:02 schwarze Exp $
d18 2
@


1.454
log
@Enable the integrated man(1) even when database support is disabled,
using the file system lookup fallback code, also reducing the number
of preprocessor conditional directives.
Hopefully, it will make some small Linux distros happy.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.453 2014/12/09 09:14:33 schwarze Exp $
d34 1
d50 1
d194 2
a195 1
		   compat_strsep.o
@


1.453
log
@Support choosing alternative binary and manual names from configure.local,
to help downstream distributions avoid naming conflicts.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.452 2014/12/09 07:29:42 schwarze Exp $
d214 1
d222 1
a222 2
		   mansearch_const.o \
		   manpath.o
d311 1
d316 1
a334 1
	ln -f $(DESTDIR)$(BINDIR)/mandoc $(DESTDIR)$(BINDIR)/$(BINM_MAN)
a338 1
	$(INSTALL_MAN) man.1 $(DESTDIR)$(MANDIR)/man1/$(BINM_MAN).1
@


1.452
log
@Integrate the makewhatis binary into the mandoc binary
just like we do it on OpenBSD.  Smaller and neater.
While here, let ./configure set INSTALL_TARGETS.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.451 2014/12/09 06:31:03 schwarze Exp $
d317 6
a322 2
	$(INSTALL_MAN) man.7 mdoc.7 roff.7 eqn.7 tbl.7 mandoc_char.7 \
		$(DESTDIR)$(MANDIR)/man7
d332 9
a340 7
	ln -f $(DESTDIR)$(BINDIR)/mandoc $(DESTDIR)$(BINDIR)/apropos
	ln -f $(DESTDIR)$(BINDIR)/mandoc $(DESTDIR)$(BINDIR)/man
	ln -f $(DESTDIR)$(BINDIR)/mandoc $(DESTDIR)$(BINDIR)/whatis
	ln -f $(DESTDIR)$(BINDIR)/mandoc $(DESTDIR)$(SBINDIR)/makewhatis
	$(INSTALL_MAN) apropos.1 man.1 $(DESTDIR)$(MANDIR)/man1
	ln -f $(DESTDIR)$(MANDIR)/man1/apropos.1 \
		$(DESTDIR)$(MANDIR)/man1/whatis.1
d343 2
a344 1
	$(INSTALL_MAN) makewhatis.8 $(DESTDIR)$(MANDIR)/man8
@


1.451
log
@Some sorting and some more comments.
Drop DISTDIR from www-install target.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.450 2014/12/09 06:11:35 schwarze Exp $
d210 1
a210 1
MANDOC_OBJS	 = $(MANDOC_HTML_OBJS) \
d217 1
a217 1
MAN_OBJS	 = $(MANDOC_OBJS)
d219 4
a222 3
MAKEWHATIS_OBJS	 = mandocdb.o mansearch_const.o manpath.o

APROPOS_OBJS	 = mansearch.o mansearch_const.o manpath.o
a268 2
INSTALL_TARGETS	 = $(BUILD_TARGETS:-build=-install)

a274 2
db-build: makewhatis

d295 1
a295 2
	rm -f mandoc $(MANDOC_OBJS) $(APROPOS_OBJS)
	rm -f makewhatis $(MAKEWHATIS_OBJS)
d321 1
a321 1
db-install: db-build
d331 1
a331 1
	$(INSTALL_PROGRAM) makewhatis $(DESTDIR)$(SBINDIR)
d357 2
a358 5
mandoc: $(MAN_OBJS) libmandoc.a
	$(CC) $(LDFLAGS) -o $@@ $(MAN_OBJS) libmandoc.a $(DBLIB)

makewhatis: $(MAKEWHATIS_OBJS) libmandoc.a
	$(CC) $(LDFLAGS) -o $@@ $(MAKEWHATIS_OBJS) libmandoc.a $(DBLIB)
@


1.450
log
@Install "man" as a hardlink to "mandoc" during db-install.
Install man(1) manual in db-install, not base-install.
Get rid of the useless variables BASEBIN, DBBIN, CGIBIN.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.449 2014/12/01 08:09:26 schwarze Exp $
d18 2
d264 2
d286 3
a353 9
www-install: www
	mkdir -p $(DESTDIR)$(HTDOCDIR)/snapshots
	$(INSTALL_DATA) $(WWW_MANS) style.css $(DESTDIR)$(HTDOCDIR)
	$(INSTALL_DATA) $(WWW_OBJS) $(DESTDIR)$(HTDOCDIR)/snapshots
	$(INSTALL_DATA) mdocml.tar.gz \
		$(DESTDIR)$(HTDOCDIR)/snapshots/mdocml-$(VERSION).tar.gz
	$(INSTALL_DATA) mdocml.sha256 \
		$(DESTDIR)$(HTDOCDIR)/snapshots/mdocml-$(VERSION).sha256

a357 7
depend: config.h
	mkdep -f Makefile.depend $(CFLAGS) $(SRCS)
	perl -e 'undef $$/; $$_ = <>; s|/usr/include/\S+||g; \
		s|\\\n||g; s|  +| |g; s| $$||mg; print;' \
		Makefile.depend > Makefile.tmp
	mv Makefile.tmp Makefile.depend

d376 18
d404 2
a405 2
.PHONY: 	 base-install cgi-install db-install install www-install
.PHONY: 	 clean distclean depend
@


1.449
log
@developer documentation regarding header files
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.448 2014/11/28 18:57:31 schwarze Exp $
a17 4
BASEBIN		 = mandoc demandoc
DBBIN		 = makewhatis
CGIBIN		 = man.cgi

d270 1
a270 1
base-build: $(BASEBIN)
d272 1
a272 1
db-build: $(DBBIN)
d274 1
a274 1
cgi-build: $(CGIBIN)
d307 1
a307 1
	$(INSTALL_PROGRAM) $(BASEBIN) $(DESTDIR)$(BINDIR)
d311 1
a311 2
	$(INSTALL_MAN) man.1 mandoc.1 demandoc.1 \
		$(DESTDIR)$(MANDIR)/man1
d326 1
d329 1
a329 1
	$(INSTALL_MAN) apropos.1 $(DESTDIR)$(MANDIR)/man1
@


1.448
log
@AT&T is unlikely to release an new version of Research UNIX any time soon.
So, it's pointless to make adding version strings easy for downstream.
One source file less to maintain.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.447 2014/11/28 18:36:35 schwarze Exp $
d134 1
d241 1
@


1.447
log
@Retire support for CSRG supplementary document titles.  These are
long obsolete and were never written in mdoc(7) in the first place.
Removes 100 lines from source files.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.446 2014/11/28 18:09:01 schwarze Exp $
a103 1
		   att.in \
@


1.446
log
@Drop useless architecture table.  Validating architecture names
is a job for makewhatis(8)/mandoc.db(5), not for the parser.
Removes 150 lines from source files and 4k (1%) from the binary.
Bloat found by deraadt@@.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.445 2014/10/25 01:03:52 schwarze Exp $
a94 1
		   vol.c \
a151 1
		   vol.in \
d166 1
a166 2
		   st.o \
		   vol.o
@


1.445
log
@integrate preconv(1) into mandoc(1);
enhances functionality and reduces code and docs by more than 300 lines
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.444 2014/09/27 11:20:39 kristaps Exp $
d38 1
a38 2
SRCS		 = arch.c \
		   att.c \
a104 1
		   arch.in \
d161 1
a161 2
LIBMDOC_OBJS	 = arch.o \
		   att.o \
@


1.444
log
@Have Makefile build mandoc(1) before it tries to generate the HTML.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.443 2014/08/21 00:42:38 schwarze Exp $
d18 1
a18 1
BASEBIN		 = mandoc preconv demandoc
a147 1
		   preconv.1 \
d188 1
a228 2
PRECONV_OBJS	 = preconv.o

a244 1
		   preconv.1.html \
a301 1
	rm -f preconv $(PRECONV_OBJS)
d320 1
a320 1
	$(INSTALL_MAN) man.1 mandoc.1 preconv.1 demandoc.1 \
a384 3
preconv: $(PRECONV_OBJS)
	$(CC) $(LDFLAGS) -o $@@ $(PRECONV_OBJS)

@


1.443
log
@Now that we have man(1) functionality, add a man(1) manual page.
I'm importing the totally unchanged OpenBSD version
such that all changes can easily be tracked in CVS.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.442 2014/08/17 03:24:47 schwarze Exp $
d292 2
@


1.442
log
@Fully integrate apropos(1) into mandoc(1).
Switch the argmode on the progname, including man(1).
Provide -f and -k options to switch the argmode.
Store the argmode inside struct search, generalizing the flags.
Derive the deftype from the argmode when needed instead of storing it.
Store the outkey inside struct search instead of passing it alone.
While here, get rid of the trailing blanks in Makefile.depend.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.441 2014/08/16 23:04:25 schwarze Exp $
d127 1
d245 1
d322 2
a323 1
	$(INSTALL_MAN) mandoc.1 preconv.1 demandoc.1 $(DESTDIR)$(MANDIR)/man1
@


1.441
log
@When BUILD_DB is active, link apropos(1) into the mandoc binary.
This is the first step on the way to a man(1) implementation.
The new ./configure is flexible enough to make this step quite easy.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.440 2014/08/16 19:00:01 schwarze Exp $
d38 1
a38 2
SRCS		 = apropos.c \
		   arch.c \
d230 1
a230 1
APROPOS_OBJS	 = apropos.o mansearch.o mansearch_const.o manpath.o
d371 2
a372 1
		s|\\\n||g; s|  +| |g; print;' Makefile.depend > Makefile.tmp
@


1.440
log
@Improve build system and autodetection.
* Make ./configure standalone, that's what people expect.
* Let people write a ./configure.local from scratch, not edit existing files.
* Autodetect wchar, sqlite3, and manpath and act accordingly.
* Autodetect the need for -L/usr/local/lib and -lutil.
* Get rid of config.h.p{re,ost}, let ./configure only write what's needed.
* Let ./configure write a Makefile.local snippet, that's quite flexible.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.439 2014/08/12 21:35:48 schwarze Exp $
d19 1
a19 1
DBBIN		 = apropos makewhatis
d225 2
d300 1
a300 1
	rm -f apropos $(APROPOS_OBJS)
a305 1
	rm -f mandoc $(MANDOC_OBJS)
d335 2
a336 2
	$(INSTALL_PROGRAM) apropos $(DESTDIR)$(BINDIR)
	ln -f $(DESTDIR)$(BINDIR)/apropos $(DESTDIR)$(BINDIR)/whatis
d378 2
a379 2
mandoc: $(MANDOC_OBJS) libmandoc.a
	$(CC) $(LDFLAGS) -o $@@ $(MANDOC_OBJS) libmandoc.a
a389 3
apropos: $(APROPOS_OBJS) libmandoc.a
	$(CC) $(LDFLAGS) -o $@@ $(APROPOS_OBJS) libmandoc.a $(DBLIB)

@


1.439
log
@typo in comment; Guy Harris <guy at alum dot mit dot edu>
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.438 2014/08/11 03:19:39 schwarze Exp $
a17 94
VERSION		 = 1.13.1

# === USER SETTINGS ====================================================

# --- user settings relevant for all builds ----------------------------

# Specify this if you want to hard-code the operating system to appear
# in the lower-left hand corner of -mdoc manuals.
#
# CFLAGS	+= -DOSNAME="\"OpenBSD 5.5\""

# IFF your system supports multi-byte functions (setlocale(), wcwidth(),
# putwchar()) AND has __STDC_ISO_10646__ (that is, wchar_t is simply a
# UCS-4 value) should you define USE_WCHAR.  If you define it and your
# system DOESN'T support this, -Tlocale will produce garbage.
# If you don't define it, -Tlocale is a synonym for -Tascii.
#
CFLAGS	 	+= -DUSE_WCHAR

CFLAGS		+= -g -W -Wall -Wstrict-prototypes
CFLAGS     	+= -Wno-unused-parameter -Wwrite-strings
PREFIX		 = /usr/local
BINDIR		 = $(PREFIX)/bin
INCLUDEDIR	 = $(PREFIX)/include/mandoc
LIBDIR		 = $(PREFIX)/lib/mandoc
MANDIR		 = $(PREFIX)/man
EXAMPLEDIR	 = $(PREFIX)/share/examples/mandoc

INSTALL		 = install
INSTALL_PROGRAM	 = $(INSTALL) -m 0555
INSTALL_DATA	 = $(INSTALL) -m 0444
INSTALL_LIB	 = $(INSTALL) -m 0444
INSTALL_SOURCE	 = $(INSTALL) -m 0644
INSTALL_MAN	 = $(INSTALL_DATA)

# --- user settings related to database support ------------------------

# Building apropos(1) and makewhatis(8) requires SQLite3.
# To avoid that dependency, comment the following line.
#
BUILD_TARGETS	+= db-build

# The remaining settings in this section
# are only relevant if db-build is enabled.
# Otherwise, they have no effect either way.

# If your system has manpath(1), uncomment this.  This is most any
# system that's not OpenBSD or NetBSD.  If uncommented, apropos(1)
# and makewhatis(8) will use manpath(1) to get the MANPATH variable.
#
#CFLAGS		+= -DUSE_MANPATH

# On some systems, SQLite3 may be installed below /usr/local.
# In that case, uncomment the following two lines.
#
#CFLAGS		+= -I/usr/local/include
#DBLIB		+= -L/usr/local/lib

# OpenBSD has the ohash functions in libutil.
# Comment the following line if your system doesn't.
#
DBLIB		+= -lutil

SBINDIR		 = $(PREFIX)/sbin

# --- user settings related to man.cgi ---------------------------------

# To build man.cgi, copy cgi.h.example to cgi.h, edit it,
# and enable the following line.
# Obviously, this requires that db-build is enabled, too.
#
#BUILD_TARGETS	+= cgi-build

# The remaining settings in this section
# are only relevant if cgi-build is enabled.
# Otherwise, they have no effect either way.

# If your system does not support static binaries, comment this,
# for example on Mac OS X.
#
STATIC		 = -static

# Linux requires -pthread for statical linking.
#
#STATIC		+= -pthread

WWWPREFIX	 = /var/www
HTDOCDIR	 = $(WWWPREFIX)/htdocs
CGIBINDIR	 = $(WWWPREFIX)/cgi-bin

# === END OF USER SETTINGS =============================================

INSTALL_TARGETS	 = $(BUILD_TARGETS:-build=-install)

a21 2
DBLIB		+= -lsqlite3

d29 1
d35 2
a36 1
		   test-strsep.c
a112 2
		   config.h.post \
		   config.h.pre \
d114 1
d271 4
d277 1
a277 1
all: base-build $(BUILD_TARGETS)
d293 3
d297 1
a297 1
	rm -f libmandoc.a $(LIBMANDOC_OBJS)
a304 1
	rm -f config.h config.log $(COMPAT_OBJS)
d364 4
d403 1
a403 1
	$(INSTALL_SOURCE) $(DISTFILES) .dist/mdocml-$(VERSION)
a407 5
config.h: configure config.h.pre config.h.post $(TESTSRCS)
	rm -f config.log
	CC="$(CC)" CFLAGS="$(CFLAGS)" DBLIB="$(DBLIB)" \
		VERSION="$(VERSION)" ./configure

d409 1
a409 1
.PHONY: 	 clean depend
@


1.438
log
@work around lack of d_namlen and ALIGN/ALIGNBYTES on Linux
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.437 2014/08/11 01:39:00 schwarze Exp $
d33 1
a33 1
# If you don't define it, -Tlocale is a synonym for -Tacsii.
@


1.437
log
@Provide a fallback version of fts(3) for systems lacking it.
I chose the OpenBSD version because it apparently contains various
bugfixes that never made it into libnbcompat.  To reduce size and
complexity, i stripped out the features we don't need.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.436 2014/08/10 23:54:41 schwarze Exp $
d118 3
a120 1
TESTSRCS	 = test-fgetln.c \
@


1.436
log
@Get rid of HAVE_CONFIG_H, it is always defined; idea from libnbcompat.
Include <sys/types.h> where needed, it does not belong in config.h.
Remove <stdio.h> from config.h; if it is missing somewhere, it should
be added, but i cannot find a *.c file where it is missing.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.435 2014/08/10 02:45:04 schwarze Exp $
d55 2
a56 4
# Building apropos(1) and makewhatis(8) requires both SQLite3 and fts(3).
# To avoid those dependencies, comment the following line.
# Be careful: the fts(3) implementation in glibc is broken on 32bit
# machines, see: https://sourceware.org/bugzilla/show_bug.cgi?id=15838
d136 1
d203 1
d285 1
@


1.435
log
@Clarifications in comments and standard output suggested by
Paul Onyschuk <ptmelville at gmail dot com> (Alpine Linux)
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.434 2014/08/08 23:47:21 schwarze Exp $
d37 2
a38 2
CFLAGS		+= -g -DHAVE_CONFIG_H
CFLAGS     	+= -W -Wall -Wstrict-prototypes -Wno-unused-parameter -Wwrite-strings
@


1.434
log
@Do not hardcode stuff in ./configure that is actually user-configurable
in the Makefile; instead, pass it down via the environment just
like CFLAGS.
Nice suggestion from kristaps@@ hoping to make MacOS X happier.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.433 2014/08/08 20:34:06 schwarze Exp $
d55 4
a58 3
# If you want to build without database support, for example to avoid
# the dependency on SQLite3, comment the following line.
# However, you won't get apropos(1) and makewhatis(8) in that case.
@


1.433
log
@add INSTALL and bump VERSION
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.432 2014/08/05 12:50:52 schwarze Exp $
d491 2
a492 1
	CC="$(CC)" CFLAGS="$(CFLAGS)" VERSION="$(VERSION)" ./configure
@


1.432
log
@Since old SQLite versions do not have sqlite3_errstr(),
provide a dummy fallback implementation.
Do not bother to decode the error, SQLite error codes
are not useful enough for that to be worthwhile.
Note that using sqlite3_errmsg(db) would be a bad idea:
On malloc() failure, db is NULL, which would cause a segfault.
Issue noticed by kristaps@@.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.431 2014/08/05 11:19:13 schwarze Exp $
d18 1
a18 1
VERSION		 = 1.13.0
d192 2
a193 1
DISTFILES	 = LICENSE \
@


1.431
log
@Portability fix:
* POSIX syntax is 'include Makefile.depend', not '.include "Makefile.depend"'
* gmake(1) runs the build rule for the included file (duh), so delete the rule
* consequently, we have to mark the 'depend' maintainer target .PHONY
* as it's now .PHONY anyway, drop some prerequisites that are now useless
Issue noticed by kristaps@@.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.430 2014/08/05 05:48:56 schwarze Exp $
d124 1
d140 1
d286 1
@


1.430
log
@Sync library documentation with reality.
Split mandoc_escape(3), mandoc_malloc(3), and mchars_alloc(3)
out of mandoc(3), adding lots of new information.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.429 2014/08/05 05:27:16 schwarze Exp $
d372 1
a372 1
.include "Makefile.depend"
d445 1
a445 1
Makefile.depend: $(SRCS) config.h Makefile
d489 2
a490 1
.PHONY: 	 base-install clean cgi-install db-install install www-install
@


1.429
log
@Switch to autogenerated dependency rules; they are less error-prone.
Provide a maintainer target to regenerate them.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.428 2014/08/05 03:02:40 schwarze Exp $
d226 1
d228 1
d232 1
d333 1
d335 1
d337 1
d402 2
a403 1
	$(INSTALL_MAN) mandoc.3 tbl.3 $(DESTDIR)$(MANDIR)/man3
@


1.428
log
@Properly partition the build system and install some missing stuff:
* Introduce targets base-build, db-build, cgi-build.
* Introduce targets base-install, db-install, cgi-install.
* Introduce a BUILD_TARGETS variable to contain db-build and cgi-build.
* Introduce an INSTALL_TARGETS variable and fill it using BUILD_TARGETS.
* Install the whatis(1) and makewhatis(8) binaries.
* Install the apropos(1), whatis(1), and makewhatis(8) manuals.
* Install mandoc_aux.h.
* Do not build manpage(1) by default.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.427 2014/08/05 01:45:02 schwarze Exp $
d130 1
a130 6
SRCS		 = LICENSE \
		   Makefile \
		   NEWS \
		   TODO \
		   apropos.1 \
		   apropos.c \
a131 1
		   arch.in \
a132 1
		   att.in \
a133 1
		   cgi.h.example \
a134 1
		   chars.in \
a137 1
		   compat_ohash.h \
a142 4
		   config.h.post \
		   config.h.pre \
		   configure \
		   demandoc.1 \
a143 1
		   eqn.7 \
a146 2
		   example.style.css \
		   gmdiff \
a147 1
		   html.h \
a148 5
		   lib.in \
		   libman.h \
		   libmandoc.h \
		   libmdoc.h \
		   libroff.h \
a149 3
		   main.h \
		   makewhatis.8 \
		   man.7 \
a150 3
		   man.cgi.8 \
		   man-cgi.css \
		   man.h \
a155 2
		   mandoc.1 \
		   mandoc.3 \
a156 2
		   mandoc.db.5 \
		   mandoc.h \
a157 3
		   mandoc_aux.h \
		   mandoc_char.7 \
		   mandoc_html.3 \
a160 2
		   manpath.h \
		   mansearch.3 \
a161 1
		   mansearch.h \
a162 1
		   mdoc.7 \
a163 1
		   mdoc.h \
a171 1
		   msec.in \
a172 2
		   out.h \
		   preconv.1 \
a173 1
		   predefs.in \
a174 1
		   roff.7 \
a176 4
		   st.in \
		   style.css \
		   tbl.3 \
		   tbl.7 \
a183 1
		   term.h \
d188 54
d243 1
a243 1
		   $(TESTSRCS)
a285 28
# === DEPENDENCY HANDLING ==============================================

all: base-build $(BUILD_TARGETS)

base-build: $(BASEBIN)

db-build: $(DBBIN)

cgi-build: $(CGIBIN)

install: base-install $(INSTALL_TARGETS)

arch.o: arch.in
att.o: att.in
chars.o: chars.in
lib.o: lib.in
msec.o: msec.in
roff.o: predefs.in
st.o: st.in
vol.o: vol.in
cgi.o: cgi.h

$(LIBMAN_OBJS): libman.h
$(LIBMDOC_OBJS): libmdoc.h
$(LIBROFF_OBJS): libroff.h
$(LIBMANDOC_OBJS): mandoc.h mandoc_aux.h mdoc.h man.h libmandoc.h config.h
$(COMPAT_OBJS): config.h compat_ohash.h

a290 1
$(MANDOC_HTML_OBJS): html.h
a300 1
$(MANDOC_TERM_OBJS): term.h
a307 1
$(MANDOC_OBJS): main.h mandoc.h mandoc_aux.h mdoc.h man.h config.h out.h
a309 2
$(MAKEWHATIS_OBJS): mansearch.h mandoc.h mandoc_aux.h \
		  mdoc.h man.h config.h manpath.h
a311 1
$(PRECONV_OBJS): config.h
a313 1
$(APROPOS_OBJS): config.h mandoc.h mandoc_aux.h manpath.h mansearch.h
a319 2
$(CGI_OBJS): main.h out.h config.h mandoc.h mandoc_aux.h \
	     manpath.h mansearch.h
a321 1
$(MANPAGE_OBJS): config.h mandoc.h mandoc_aux.h manpath.h mansearch.h
a323 1
$(DEMANDOC_OBJS): config.h mandoc.h man.h mdoc.h
d352 12
d366 2
d438 6
d471 1
a471 1
mdocml.tar.gz: $(SRCS)
d473 1
a473 1
	$(INSTALL_SOURCE) $(SRCS) .dist/mdocml-$(VERSION)
@


1.427
log
@Various minor corrections:
* Do not unconditionally use -I/usr/local/include and -L/usr/local/lib.
* Do not install programs and libs root-writeable.
* Add missing test-strcasestr.c and test-strsep.c to TESTSRCS.
* Add missing cgi.h.example and mandoc_html.3 to SRCS.
* Add missing mandoc_html.3.html to WWW_MANS.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.426 2014/08/05 01:07:00 schwarze Exp $
d57 1
d59 5
a63 1
DBBIN		 = makewhatis manpage apropos
d82 2
d88 1
d90 5
a94 1
#DBBIN		+= man.cgi
d111 6
a116 1
ALLBIN		 = mandoc preconv demandoc $(DBBIN)
a118 2
all: $(ALLBIN)

d285 10
d405 1
a405 1
install: all
a411 1
	mkdir -p $(DESTDIR)$(MANDIR)/man5
d413 1
a413 1
	$(INSTALL_PROGRAM) $(ALLBIN) $(DESTDIR)$(BINDIR)
d415 2
a416 1
	$(INSTALL_LIB) man.h mdoc.h mandoc.h $(DESTDIR)$(INCLUDEDIR)
d418 1
a418 2
	$(INSTALL_MAN) mandoc.3 mansearch.3 tbl.3 $(DESTDIR)$(MANDIR)/man3
	$(INSTALL_MAN) mandoc.db.5 $(DESTDIR)$(MANDIR)/man5
d423 18
a440 1
installcgi: all
d451 1
a451 1
installwww: www
d498 1
a498 1
.PHONY: 	 clean install installcgi installwww
@


1.426
log
@sort user settings; no functional change
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.425 2014/08/04 23:44:29 schwarze Exp $
d37 1
a37 1
CFLAGS		+= -I/usr/local/include -g -DHAVE_CONFIG_H
d47 1
a47 1
INSTALL_PROGRAM	 = $(INSTALL) -m 0755
d49 1
a49 1
INSTALL_LIB	 = $(INSTALL) -m 0644
d66 6
d100 1
a100 1
DBLIB		+= -L/usr/local/lib -lsqlite3
d109 1
d112 2
a113 1
		   test-strptime.c
d126 1
d178 1
d341 1
@


1.425
log
@remove strnlen(3) compat, we no longer use it
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.424 2014/07/13 09:39:32 schwarze Exp $
d22 2
a36 11
# If your system has manpath(1), uncomment this.  This is most any
# system that's not OpenBSD or NetBSD.  If uncommented, manpage(1) and
# makewhatis(8) will use manpath(1) to get the MANPATH variable.
#CFLAGS		+= -DUSE_MANPATH

# If your system does not support static binaries, comment this,
# for example on Mac OS X.
STATIC		 = -static
# Linux requires -pthread to statically link with libdb.
#STATIC		+= -pthread

a39 3
WWWPREFIX	 = /var/www
HTDOCDIR	 = $(WWWPREFIX)/htdocs
CGIBINDIR	 = $(WWWPREFIX)/cgi-bin
d45 1
d53 2
d56 2
a57 2
# the dependency on SQLite3, comment the following two lines.
DBLIB		 = -L/usr/local/lib -lsqlite3
d60 5
a64 3
# To build man.cgi, copy cgi.h.example to cgi.h, edit it, and
# either enable the following line or run "make man.cgi" by hand.
#DBBIN		+= man.cgi
d68 1
d71 20
d94 1
@


1.424
log
@Install the manuals of the web interface below the same directory
as manpath.conf, such that we do not need to mix our own documentation
into the documentation we are serving, which may not even be possible
if the latter is updated automatically.

Based on an idea by beck@@.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.423 2014/07/12 18:32:47 schwarze Exp $
a89 1
		   test-strnlen.c \
a112 1
		   compat_strnlen.c \
a240 1
		   compat_strnlen.o \
@


1.423
log
@No need for run-time configuration, add minimal compile-time
configuration facilities, just two paths and two HTML strings.
Show the title on all pages, not just the index page.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.422 2014/07/10 00:31:10 schwarze Exp $
d379 2
d384 2
@


1.422
log
@Full rewrite of the man.cgi(8) manual.

Almost everything in the old man.cgi(7) was outdated in one way
or another - catman, catman.conf, CACHE_DIR, /cache, manroots,
replacing '/' with spaces, /tmp...

Instead, document the HTML and URI interfaces, the output and the setup,
and complete the listings of ENVIRONMENT variables and FILES.

Using section 8 instead of section 7 because that's the usual place
for CGI programs, see for example bgplg(8) and slowcgi(8).
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.421 2014/07/09 07:30:47 schwarze Exp $
d68 4
a71 1
DBBIN		+= man.cgi
d256 1
@


1.421
log
@Switch over man.cgi to SQLite.  While here:
* Simplify pathgen(), just use the subdirs of the cache dir.
* Simplify URI paths, just use show/<manpath>/<filename>.
* Drop struct paths, just use plain strings.
* Garbage collect unused headers.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.420 2014/06/20 02:55:49 schwarze Exp $
d137 1
a137 1
		   man.cgi.7 \
a319 1
		   man.cgi.7.html \
d325 1
@


1.420
log
@let the build system cope with the recent ohash changes
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.419 2014/04/24 00:29:45 schwarze Exp $
d68 1
d137 1
d296 8
d320 1
d345 1
d375 1
a375 1
	#$(INSTALL_PROGRAM) man.cgi $(DESTDIR)$(CGIBINDIR)
d406 3
@


1.419
log
@Various Makefile improvements:
* Use sha256 rather than md5.
* Update .h dependencies for some objects.
* Provide `www' target to build everything needed for the web site.
* Move .SUFFIXES and .PHONY technicalities to the bottom.
* State Copyright and license, just for clarity.
@
text
@d1 1
a1 1
# $Id$
d69 4
@


1.418
log
@Audit malloc(3)/calloc(3)/realloc(3) usage.
* Change eight reallocs to reallocarray to be safe from overflows.
* Change one malloc to reallocarray to be safe from overflows.
* Change one calloc to reallocarray, no zeroing needed.
* Change the order of arguments of three callocs (aesthetical).
@
text
@d1 16
a16 4
.PHONY: 	 clean install installcgi installwww
.SUFFIXES:	 .md5 .h .h.html
.SUFFIXES:	 .1       .3       .5       .7       .8
.SUFFIXES:	 .1.html  .3.html  .5.html  .7.html  .8.html
d25 1
a25 1
# CFLAGS	+= -DOSNAME="\"OpenBSD 5.4\""
d237 2
d288 1
a288 1
$(APROPOS_OBJS): config.h manpath.h mansearch.h
d291 1
a291 1
$(MANPAGE_OBJS): config.h manpath.h mansearch.h
d294 1
a294 1
$(DEMANDOC_OBJS): config.h
d313 1
d318 4
a321 1
$(WWW_MANS): mandoc
d323 1
a323 2
WWW_OBJS	 = mdocml.tar.gz \
		   mdocml.md5
d352 2
a353 1
	$(INSTALL_MAN) man.7 mdoc.7 roff.7 eqn.7 tbl.7 mandoc_char.7 $(DESTDIR)$(MANDIR)/man7
d363 1
a363 1
installwww: $(WWW_MANS) $(WWW_OBJS)
d369 2
a370 2
	$(INSTALL_DATA) mdocml.md5 \
		$(DESTDIR)$(HTDOCDIR)/snapshots/mdocml-$(VERSION).md5
d393 2
a394 2
mdocml.md5: mdocml.tar.gz
	md5 mdocml.tar.gz >$@@
d407 4
d412 1
a412 1
	highlight -I $< >$@@
d414 3
a416 2
.1.1.html .3.3.html .5.5.html .7.7.html .8.8.html:
	./mandoc -Thtml -Wall,stop -Ostyle=style.css,man=%N.%S.html,includes=%I.html $< >$@@
@


1.417
log
@add a LICENSE file for clarity and for the convenience of porters
@
text
@d67 1
d90 1
d218 1
@


1.416
log
@Slowly, the dust begins to settle.
We are keeping the traditional name makewhatis(8).
No content change.
@
text
@d72 2
a73 1
SRCS		 = Makefile \
@


1.415
log
@Document the database format and SQL code generation;
suggested by kristaps@@ and espie@@.
@
text
@d25 1
a25 1
# mandocdb(8) will use manpath(1) to get the MANPATH variable.
d55 1
a55 1
DBBIN		 = mandocdb manpage apropos
d114 1
a131 1
		   mandocdb.8 \
d262 2
a263 2
MANDOCDB_OBJS	 = mandocdb.o mansearch_const.o manpath.o
$(MANDOCDB_OBJS): mansearch.h mandoc.h mandoc_aux.h \
d292 1
a292 1
		   mandocdb.8.html \
d307 1
a307 1
	rm -f mandocdb $(MANDOCDB_OBJS)
d356 2
a357 2
mandocdb: $(MANDOCDB_OBJS) libmandoc.a
	$(CC) $(LDFLAGS) -o $@@ $(MANDOCDB_OBJS) libmandoc.a $(DBLIB)
@


1.414
log
@The files mandoc.c and mandoc.h contained both specialised low-level
functions used for multiple languages (mdoc, man, roff), for example
mandoc_escape(), mandoc_getarg(), mandoc_eos(), and generic auxiliary
functions.  Split the auxiliaries out into their own file and header.
While here, do some #include cleanup.
@
text
@d3 2
a4 2
.SUFFIXES:	 .1       .3       .7       .8
.SUFFIXES:	 .1.html  .3.html  .7.html  .8.html
d126 1
d136 1
d283 1
d285 1
d295 2
d323 1
d329 2
a330 1
	$(INSTALL_MAN) mandoc.3 tbl.3 $(DESTDIR)$(MANDIR)/man3
d388 1
a388 1
.1.1.html .3.3.html .7.7.html .8.8.html:
@


1.413
log
@- remove index.html, it is now part of the website repo
- install mandocdb, manpage, and apropos
- and some general cleanup (e.g., installcgi is .PHONY)
@
text
@d127 2
d206 1
d231 1
a231 1
$(LIBMANDOC_OBJS): mandoc.h mdoc.h man.h libmandoc.h config.h
d258 1
a258 1
$(MANDOC_OBJS): main.h mandoc.h mdoc.h man.h config.h out.h
d261 2
a262 1
$(MANDOCDB_OBJS): mansearch.h mandoc.h mdoc.h man.h config.h manpath.h
@


1.412
log
@Get rid of the local keys table, use the new mansearch_const.c.
No functional change.
@
text
@d1 2
a2 2
.PHONY: 	 clean install installwww
.SUFFIXES:	 .sgml .html .md5 .h .h.html
d6 4
a14 3
VERSION		 = 1.13.0
VDATE		 = 4 January 2014

d52 2
d57 5
a61 1
all: mandoc preconv demandoc $(DBBIN)
a102 1
		   external.png \
a105 2
		   index.css \
		   index.sgml \
d272 1
a272 1
INDEX_MANS	 = apropos.1.html \
d284 4
a287 1
		   mandocdb.8.html
d289 1
a289 1
$(INDEX_MANS): mandoc
d291 1
a291 5
INDEX_OBJS	 = $(INDEX_MANS) \
		   man.h.html \
		   mandoc.h.html \
		   mdoc.h.html \
		   mdocml.tar.gz \
a293 2
www: index.html

d303 1
a303 2
	rm -f mdocml.tar.gz
	rm -f index.html $(INDEX_OBJS)
d314 1
a314 1
	$(INSTALL_PROGRAM) mandoc preconv demandoc $(DESTDIR)$(BINDIR)
d329 8
a336 10
installwww: www
	mkdir -p $(PREFIX)/snapshots
	mkdir -p $(PREFIX)/binaries
	$(INSTALL_DATA) index.html external.png index.css $(PREFIX)
	$(INSTALL_DATA) $(INDEX_MANS) style.css $(PREFIX)
	$(INSTALL_DATA) mandoc.h.html man.h.html mdoc.h.html $(PREFIX)
	$(INSTALL_DATA) mdocml.tar.gz $(PREFIX)/snapshots
	$(INSTALL_DATA) mdocml.md5 $(PREFIX)/snapshots
	$(INSTALL_DATA) mdocml.tar.gz $(PREFIX)/snapshots/mdocml-$(VERSION).tar.gz
	$(INSTALL_DATA) mdocml.md5 $(PREFIX)/snapshots/mdocml-$(VERSION).md5
a368 2
index.html: $(INDEX_OBJS)

a377 4

.sgml.html:
	validate --warn $<
	sed -e "s!@@VERSION@@!$(VERSION)!" -e "s!@@VDATE@@!$(VDATE)!" $< >$@@
@


1.411
log
@Support a second -v on mandocdb(8) to show keys while they are being added;
i need that for debugging, in particular to be used with -t.
To be able to do so, provide a global table of key names, for reuse.
@
text
@d259 1
a259 1
APROPOS_OBJS	 = apropos.o mansearch.o manpath.o
d262 1
a262 1
MANPAGE_OBJS	 = manpage.o mansearch.o manpath.o
@


1.410
log
@Put mansearch.{h,c}, manpage.c, and compat_ohash.{h,c}
into the distribution tarball.  Bump VERSION.
@
text
@d131 1
d253 1
a253 1
MANDOCDB_OBJS	 = mandocdb.o manpath.o
@


1.409
log
@Put ./configure into the distributin tarball.
@
text
@d11 2
a12 2
VERSION		 = 1.12.3
VDATE		 = 31 December 2013
d79 2
d126 1
d129 2
@


1.408
log
@Even though strnlen(3) is required by POSIX 2008,
Matthias Scheler reports than Solaris 10 lacks it.
While here, sort the declarations in config.h
and move the headers to the top.
@
text
@d86 1
d361 2
a362 1
	( cd .dist/ && tar zcf ../$@@ ./ )
@


1.407
log
@Clean up feature tests:
* Split the configure steering script out of the Makefile.
* Let the configure step depend on the test sources.
* Clean up the test programs such that they can be run.
@
text
@d62 1
d82 1
d202 1
@


1.406
log
@Provide strcasestr(3) and strsep(3) for Solaris 10 compat;
reported missing by Matthias Scheler <tron at NetBSD> via wiz@@.
@
text
@d56 8
a157 7
		   test-fgetln.c \
		   test-getsubopt.c \
		   test-mmap.c \
		   test-ohash.c \
		   test-strlcat.c \
		   test-strlcpy.c \
		   test-strptime.c \
d160 2
a161 1
		   vol.in
d362 1
a362 1
config.h: config.h.pre config.h.post
d364 1
a364 42
	( cat config.h.pre; \
	  echo; \
	  echo '#define VERSION "$(VERSION)"'; \
	  if $(CC) $(CFLAGS) -Werror -Wno-unused -o test-ohash test-ohash.c >> config.log 2>&1; then \
		echo '#define HAVE_OHASH'; \
		rm test-ohash; \
	  fi; \
	  if $(CC) $(CFLAGS) -Werror -Wno-unused -o test-fgetln test-fgetln.c >> config.log 2>&1; then \
		echo '#define HAVE_FGETLN'; \
		rm test-fgetln; \
	  fi; \
	  if $(CC) $(CFLAGS) -Werror -Wno-unused -o test-strptime test-strptime.c >> config.log 2>&1; then \
		echo '#define HAVE_STRPTIME'; \
		rm test-strptime; \
	  fi; \
	  if $(CC) $(CFLAGS) -Werror -Wno-unused -o test-getsubopt test-getsubopt.c >> config.log 2>&1; then \
		echo '#define HAVE_GETSUBOPT'; \
		rm test-getsubopt; \
	  fi; \
	  if $(CC) $(CFLAGS) -Werror -Wno-unused -o test-strlcat test-strlcat.c >> config.log 2>&1; then \
		echo '#define HAVE_STRLCAT'; \
		rm test-strlcat; \
	  fi; \
	  if $(CC) $(CFLAGS) -Werror -Wno-unused -o test-mmap test-mmap.c >> config.log 2>&1; then \
		echo '#define HAVE_MMAP'; \
		rm test-mmap; \
	  fi; \
	  if $(CC) $(CFLAGS) -Werror -Wno-unused -o test-strlcpy test-strlcpy.c >> config.log 2>&1; then \
		echo '#define HAVE_STRLCPY'; \
		rm test-strlcpy; \
	  fi; \
	  if $(CC) $(CFLAGS) -Werror -Wno-unused -o test-strcasestr test-strcasestr.c >> config.log 2>&1; then \
		echo '#define HAVE_STRCASESTR'; \
		rm test-strcasestr; \
	  fi; \
	  if $(CC) $(CFLAGS) -Werror -Wno-unused -o test-strsep test-strsep.c >> config.log 2>&1; then \
		echo '#define HAVE_STRSEP'; \
		rm test-strsep; \
	  fi; \
	  echo; \
	  cat config.h.post \
	) > $@@
@


1.405
log
@release 1.12.3
@
text
@d70 1
d73 1
d195 1
d197 2
a198 1
		   compat_strlcpy.o
d393 8
@


1.404
log
@Put VERSION into config.h.
This makes life easier for downstream maintainers having more than one
Makefile, for example DragonFly and FreeBSD.
Suggested by Franco Fichtner <franco at lastsummer dot de>.
@
text
@d11 2
a12 2
VERSION		 = 1.12.2
VDATE		 = 05 October 2013
@


1.403
log
@merge from VERSION_1_12: do not complain about unused variables in test-*.c
@
text
@d33 1
a33 1
CFLAGS		+= -I/usr/local/include -g -DHAVE_CONFIG_H -DVERSION="\"$(VERSION)\""
d360 1
@


1.402
log
@Merge from VERSION_1_12, in particular release date, pkgsrc port version,
link to NEWS file, link to Alpine Linux, and fix one FreeBSD link.
@
text
@d360 1
a360 1
	  if $(CC) $(CFLAGS) -Werror -o test-ohash test-ohash.c >> config.log 2>&1; then \
d364 1
a364 1
	  if $(CC) $(CFLAGS) -Werror -o test-fgetln test-fgetln.c >> config.log 2>&1; then \
d368 1
a368 1
	  if $(CC) $(CFLAGS) -Werror -o test-strptime test-strptime.c >> config.log 2>&1; then \
d372 1
a372 1
	  if $(CC) $(CFLAGS) -Werror -o test-getsubopt test-getsubopt.c >> config.log 2>&1; then \
d376 1
a376 1
	  if $(CC) $(CFLAGS) -Werror -o test-strlcat test-strlcat.c >> config.log 2>&1; then \
d380 1
a380 1
	  if $(CC) $(CFLAGS) -Werror -o test-mmap test-mmap.c >> config.log 2>&1; then \
d384 1
a384 1
	  if $(CC) $(CFLAGS) -Werror -o test-strlcpy test-strlcpy.c >> config.log 2>&1; then \
@


1.401
log
@Merge from branch VERSION_1_12:
- add the new SCRS files NEWS and gmdiff
- add tbl.3 to SRCS, INDEX_MANS, and install
- bring back the SCRS files apropos.{c,1} that somehow got lost
- bring back the INDEX_MANS apropos.1.html that also got lost
- update VERSION, VDATE, and OSNAME
- improve comment regarding STATIC
@
text
@d12 1
a12 1
VDATE		 = 01 October 2013
@


1.400
log
@Stop producing xhtml/pdf/etc for webpage (logs indicate that nobody actually
looks at them).
@
text
@d9 1
a9 1
# CFLAGS	+= -DOSNAME="\"OpenBSD 4.5\""
d11 2
a12 2
VERSION		 = 1.12.1
VDATE		 = 23 March 2012
d27 2
a28 3
# If your system supports static binaries only, uncomment this.  This
# appears only to be BSD UNIX systems (Mac OS X has no support and Linux
# requires -pthreads for static libdb).
d30 2
d57 1
d59 2
d82 1
d136 1
d252 2
a253 1
INDEX_MANS	 = demandoc.1.html \
d255 1
d257 1
a261 1
		   preconv.1.html \
d302 1
a302 1
	$(INSTALL_MAN) mandoc.3 $(DESTDIR)$(MANDIR)/man3
@


1.399
log
@Merge whatis.1 into apropos.1 (and remove), add whatis bits to apropos
(via mansearch), and merge mandocdb.h into mansearch.h (and remove).
@
text
@a3 3
.SUFFIXES:	 .1.txt   .3.txt   .7.txt   .8.txt
.SUFFIXES:	 .1.pdf   .3.pdf   .7.pdf   .8.pdf
.SUFFIXES:	 .1.ps    .3.ps    .7.ps    .8.ps
a4 1
.SUFFIXES:	 .1.xhtml .3.xhtml .7.xhtml .8.xhtml
a246 4
		   demandoc.1.xhtml \
		   demandoc.1.ps \
		   demandoc.1.pdf \
		   demandoc.1.txt \
a247 4
		   mandoc.1.xhtml \
		   mandoc.1.ps \
		   mandoc.1.pdf \
		   mandoc.1.txt \
a248 4
		   mandoc.3.xhtml \
		   mandoc.3.ps \
		   mandoc.3.pdf \
		   mandoc.3.txt \
a249 4
		   eqn.7.xhtml \
		   eqn.7.ps \
		   eqn.7.pdf \
		   eqn.7.txt \
a250 4
		   man.7.xhtml \
		   man.7.ps \
		   man.7.pdf \
		   man.7.txt \
a251 4
		   mandoc_char.7.xhtml \
		   mandoc_char.7.ps \
		   mandoc_char.7.pdf \
		   mandoc_char.7.txt \
a252 4
		   mdoc.7.xhtml \
		   mdoc.7.ps \
		   mdoc.7.pdf \
		   mdoc.7.txt \
a253 4
		   preconv.1.xhtml \
		   preconv.1.ps \
		   preconv.1.pdf \
		   preconv.1.txt \
a254 4
		   roff.7.xhtml \
		   roff.7.ps \
		   roff.7.pdf \
		   roff.7.txt \
d256 1
a256 9
		   tbl.7.xhtml \
		   tbl.7.ps \
		   tbl.7.pdf \
		   tbl.7.txt \
		   mandocdb.8.html \
		   mandocdb.8.xhtml \
		   mandocdb.8.ps \
		   mandocdb.8.pdf \
		   mandocdb.8.txt
a386 3
.1.1.txt .3.3.txt .7.7.txt .8.8.txt:
	./mandoc -Tascii -Wall,stop $< | col -b >$@@

a389 9
.1.1.ps .3.3.ps .7.7.ps .8.8.ps:
	./mandoc -Tps -Wall,stop $< >$@@

.1.1.xhtml .3.3.xhtml .7.7.xhtml .8.8.xhtml:
	./mandoc -Txhtml -Wall,stop -Ostyle=style.css,man=%N.%S.xhtml,includes=%I.html $< >$@@

.1.1.pdf .3.3.pdf .7.7.pdf .8.8.pdf:
	./mandoc -Tpdf -Wall,stop $< >$@@

@


1.398
log
@Remove catman(8): it's superfluous.
Users of man.cgi should be able to just copy in their directories and have
the CGI fine everything on its own or just suck it up or, in the cases
of multiple manroots, have a simple config file.
Besides, now that mandocdb(8) is using relative paths for everything,
needing a fancy "cp -R" is silly.
@
text
@d29 1
a29 1
CFLAGS		+= -DUSE_MANPATH
a109 1
		   mandocdb.h \
d236 1
a236 1
$(MANDOCDB_OBJS): mandocdb.h mandoc.h mdoc.h man.h config.h manpath.h
d242 1
a242 1
$(APROPOS_OBJS): config.h manpath.h mandocdb.h mansearch.h
d245 1
a245 1
$(MANPAGE_OBJS): config.h manpath.h mandocdb.h mansearch.h
@


1.397
log
@Add a compatibility interface for ohash.
This include's espie@@'s wholesale src/lib/libc/ohash directory from OpenBSD
into compat_ohash.c (with a single copyright/license notice at the top)
and src/include/ohash.h as compat_ohash.h.
The ohash_int.h part of compat_ohash.c has been changed only in that ohash.h
points to compat_ohash.h.
Added HAVE_OHASH test (test-ohash.c) to Makefile.
In mandocdb.c and mansearch.c, check HAVE_OHASH test for inclusion.
@
text
@d29 1
a29 1
#CFLAGS		+= -DUSE_MANPATH
@


1.396
log
@Remove lint from Makefile.
Disable some parts of the build (man.cgi, etc.) while sqlite3 is being
merged in nice and slow.
Remove the bit swapping stuff in config.h.post.
Remove apropos_db (replaced by mansearch).
@
text
@d150 1
d191 1
d208 1
a208 1
$(COMPAT_OBJS): config.h
d401 4
@


1.395
log
@Get ready for a version.
@
text
@d27 2
a28 3
# system that's not OpenBSD or NetBSD.  If uncommented, apropos(1),
# mandocdb(8), and man.cgi will popen(3) manpath(1) to get the MANPATH
# variable.
d36 1
a36 1
CFLAGS		+= -g -DHAVE_CONFIG_H -DVERSION="\"$(VERSION)\""
d54 2
a55 8
# Non-BSD systems (Linux, etc.) need -ldb to compile mandocdb and
# apropos.
# However, if you don't have -ldb at all (or it's not native), then
# comment out apropos and mandocdb. 
#
#DBLIB		 = -ldb
DBBIN		 = apropos mandocdb man.cgi catman whatis
DBLN		 = llib-lapropos.ln llib-lmandocdb.ln llib-lman.cgi.ln llib-lcatman.ln
a60 4
		   apropos.1 \
		   apropos.c \
		   apropos_db.c \
		   apropos_db.h \
a64 2
		   catman.8 \
		   catman.c \
a95 1
		   man.cgi.7 \
d155 1
a155 2
		   vol.in \
		   whatis.1
a160 4
LIBMAN_LNS	 = man.ln \
		   man_hash.ln \
		   man_macro.ln \
		   man_validate.ln
a171 10
LIBMDOC_LNS	 = arch.ln \
		   att.ln \
		   lib.ln \
		   mdoc.ln \
		   mdoc_argv.ln \
		   mdoc_hash.ln \
		   mdoc_macro.ln \
		   mdoc_validate.ln \
		   st.ln \
		   vol.ln
a178 6
LIBROFF_LNS	 = eqn.ln \
		   roff.ln \
		   tbl.ln \
		   tbl_data.ln \
		   tbl_layout.ln \
		   tbl_opts.ln
a186 7
LIBMANDOC_LNS	 = $(LIBMAN_LNS) \
		   $(LIBMDOC_LNS) \
		   $(LIBROFF_LNS) \
		   chars.ln \
		   mandoc.ln \
		   msec.ln \
		   read.ln
a191 18
COMPAT_LNS	 = compat_fgetln.ln \
		   compat_getsubopt.ln \
		   compat_strlcat.ln \
		   compat_strlcpy.ln

arch.o arch.ln: arch.in
att.o att.ln: att.in
chars.o chars.ln: chars.in
lib.o lib.ln: lib.in
msec.o msec.ln: msec.in
roff.o roff.ln: predefs.in
st.o st.ln: st.in
vol.o vol.ln: vol.in

$(LIBMAN_OBJS) $(LIBMAN_LNS): libman.h
$(LIBMDOC_OBJS) $(LIBMDOC_LNS): libmdoc.h
$(LIBROFF_OBJS) $(LIBROFF_LNS): libroff.h
$(LIBMANDOC_OBJS) $(LIBMANDOC_LNS): mandoc.h mdoc.h man.h libmandoc.h config.h
d193 14
a206 1
$(COMPAT_OBJS) $(COMPAT_LNS): config.h
d213 1
a213 5
MANDOC_HTML_LNS	 = eqn_html.ln \
		   html.ln \
		   man_html.ln \
		   mdoc_html.ln \
		   tbl_html.ln
a215 1
MANDOC_MAN_LNS   = mdoc_man.ln
d224 1
a224 7
MANDOC_TERM_LNS	 = eqn_term.ln \
		   man_term.ln \
		   mdoc_term.ln \
		   term.ln \
		   term_ascii.ln \
		   term_ps.ln \
		   tbl_term.ln
d232 1
a232 10
MANDOC_LNS	 = $(MANDOC_HTML_LNS) \
		   $(MANDOC_MAN_LNS) \
		   $(MANDOC_TERM_LNS) \
		   main.ln \
		   out.ln \
		   tree.ln

$(MANDOC_HTML_OBJS) $(MANDOC_HTML_LNS): html.h
$(MANDOC_TERM_OBJS) $(MANDOC_TERM_LNS): term.h
$(MANDOC_OBJS) $(MANDOC_LNS): main.h mandoc.h mdoc.h man.h config.h out.h
d235 1
a235 3
MANDOCDB_LNS	 = mandocdb.ln manpath.ln

$(MANDOCDB_OBJS) $(MANDOCDB_LNS): mandocdb.h mandoc.h mdoc.h man.h config.h manpath.h
d238 1
a238 17
PRECONV_LNS	 = preconv.ln

$(PRECONV_OBJS) $(PRECONV_LNS): config.h

APROPOS_OBJS	 = apropos.o apropos_db.o manpath.o
APROPOS_LNS	 = apropos.ln apropos_db.ln manpath.ln

$(APROPOS_OBJS) $(APROPOS_LNS): config.h mandoc.h apropos_db.h manpath.h mandocdb.h

CGI_OBJS	 = $(MANDOC_HTML_OBJS) \
		   $(MANDOC_MAN_OBJS) \
		   $(MANDOC_TERM_OBJS) \
		   cgi.o \
		   apropos_db.o \
		   manpath.o \
		   out.o \
		   tree.o
d240 2
a241 8
CGI_LNS	 	 = $(MANDOC_HTML_LNS) \
		   $(MANDOC_MAN_LNS) \
		   $(MANDOC_TERM_LNS) \
		   cgi.ln \
		   apropos_db.ln \
		   manpath.ln \
		   out.ln \
		   tree.ln
d243 2
a244 6
$(CGI_OBJS) $(CGI_LNS): main.h mdoc.h man.h out.h config.h mandoc.h apropos_db.h manpath.h mandocdb.h

CATMAN_OBJS	 = catman.o manpath.o
CATMAN_LNS 	 = catman.ln manpath.ln

$(CATMAN_OBJS) $(CATMAN_LNS): config.h mandoc.h manpath.h mandocdb.h
d247 1
a247 3
DEMANDOC_LNS	 = demandoc.ln

$(DEMANDOC_OBJS) $(DEMANDOC_LNS): config.h
d249 1
a249 11
INDEX_MANS	 = apropos.1.html \
		   apropos.1.xhtml \
		   apropos.1.ps \
		   apropos.1.pdf \
		   apropos.1.txt \
		   catman.8.html \
		   catman.8.xhtml \
		   catman.8.ps \
		   catman.8.pdf \
		   catman.8.txt \
		   demandoc.1.html \
a258 5
		   whatis.1.html \
		   whatis.1.xhtml \
		   whatis.1.ps \
		   whatis.1.pdf \
		   whatis.1.txt \
a273 5
		   man.cgi.7.html \
		   man.cgi.7.xhtml \
		   man.cgi.7.ps \
		   man.cgi.7.pdf \
		   man.cgi.7.txt \
a315 2
lint: llib-lmandoc.ln llib-lpreconv.ln llib-ldemandoc.ln $(DBLN)

d318 1
a318 1
	rm -f llib-llibmandoc.ln $(LIBMANDOC_LNS)
a319 1
	rm -f llib-lmandocdb.ln $(MANDOCDB_LNS)
d321 1
a321 7
	rm -f llib-lpreconv.ln $(PRECONV_LNS)
	rm -f apropos whatis $(APROPOS_OBJS)
	rm -f llib-lapropos.ln $(APROPOS_LNS)
	rm -f man.cgi $(CGI_OBJS)
	rm -f llib-lman.cgi.ln $(CGI_LNS)
	rm -f catman $(CATMAN_OBJS)
	rm -f llib-lcatman.ln $(CATMAN_LNS)
a322 1
	rm -f llib-ldemandoc.ln $(DEMANDOC_LNS)
d324 2
a325 3
	rm -f llib-lmandoc.ln $(MANDOC_LNS)
	rm -f config.h config.log $(COMPAT_OBJS) $(COMPAT_LNS)
	rm -f mdocml.tar.gz mdocml-win32.zip mdocml-win64.zip mdocml-macosx.zip
d327 1
a327 10
	rm -rf test-fgetln.dSYM
	rm -rf test-strlcpy.dSYM
	rm -rf test-strlcat.dSYM 
	rm -rf test-strptime.dSYM 
	rm -rf test-mmap.dSYM 
	rm -rf test-getsubopt.dSYM
	rm -rf apropos.dSYM
	rm -rf catman.dSYM
	rm -rf mandocdb.dSYM
	rm -rf whatis.dSYM
d348 1
a348 1
	$(INSTALL_PROGRAM) man.cgi $(DESTDIR)$(CGIBINDIR)
a365 3
llib-llibmandoc.ln: $(COMPAT_LNS) $(LIBMANDOC_LNS)
	$(LINT) $(LINTFLAGS) -Clibmandoc $(COMPAT_LNS) $(LIBMANDOC_LNS)

a368 3
llib-lmandoc.ln: $(MANDOC_LNS) llib-llibmandoc.ln
	$(LINT) $(LINTFLAGS) -Cmandoc $(MANDOC_LNS) llib-llibmandoc.ln

a371 3
llib-lmandocdb.ln: $(MANDOCDB_LNS) llib-llibmandoc.ln
	$(LINT) $(LINTFLAGS) -Cmandocdb $(MANDOCDB_LNS) llib-llibmandoc.ln

d375 2
a376 5
llib-lpreconv.ln: $(PRECONV_LNS) llib-llibmandoc.ln
	$(LINT) $(LINTFLAGS) -Cpreconv $(PRECONV_LNS) llib-llibmandoc.ln

whatis: apropos
	cp -f apropos whatis
a380 15
llib-lapropos.ln: $(APROPOS_LNS) llib-llibmandoc.ln
	$(LINT) $(LINTFLAGS) -Capropos $(APROPOS_LNS) llib-llibmandoc.ln

catman: $(CATMAN_OBJS) libmandoc.a
	$(CC) $(LDFLAGS) -o $@@ $(CATMAN_OBJS) libmandoc.a $(DBLIB)

llib-lcatman.ln: $(CATMAN_LNS) llib-llibmandoc.ln
	$(LINT) $(LINTFLAGS) -Ccatman $(CATMAN_LNS) llib-llibmandoc.ln

man.cgi: $(CGI_OBJS) libmandoc.a
	$(CC) $(LDFLAGS) $(STATIC) -o $@@ $(CGI_OBJS) libmandoc.a $(DBLIB)

llib-lman.cgi.ln: $(CGI_LNS) llib-llibmandoc.ln
	$(LINT) $(LINTFLAGS) -Cman.cgi $(CGI_LNS) llib-llibmandoc.ln

a383 3
llib-ldemandoc.ln: $(DEMANDOC_LNS) llib-llibmandoc.ln
	$(LINT) $(LINTFLAGS) -Cdemandoc $(DEMANDOC_LNS) llib-llibmandoc.ln

a392 31
mdocml-win32.zip: $(SRCS)
	mkdir -p .win32/mdocml-$(VERSION)/
	$(INSTALL_SOURCE) $(SRCS) .win32
	cp .win32/Makefile .win32/Makefile.old
	egrep -v -e DUSE_WCHAR -e ^DBBIN .win32/Makefile.old >.win32/Makefile
	( cd .win32; \
		CC=i686-w64-mingw32-gcc AR=i686-w64-mingw32-ar CFLAGS='-DOSNAME=\"Windows\"' make; \
		make install PREFIX=mdocml-$(VERSION) ; \
		zip -r ../$@@ mdocml-$(VERSION) )
	rm -rf .win32

mdocml-win64.zip: $(SRCS)
	mkdir -p .win64/mdocml-$(VERSION)/
	$(INSTALL_SOURCE) $(SRCS) .win64
	cp .win64/Makefile .win64/Makefile.old
	egrep -v -e DUSE_WCHAR -e ^DBBIN .win64/Makefile.old >.win64/Makefile
	( cd .win64; \
		CC=x86_64-w64-mingw32-gcc AR=x86_64-w64-mingw32-ar CFLAGS='-DOSNAME=\"Windows\"' make; \
		make install PREFIX=mdocml-$(VERSION) ; \
		zip -r ../$@@ mdocml-$(VERSION) )
	rm -rf .win64

mdocml-macosx.zip: $(SRCS)
	mkdir -p .macosx/mdocml-$(VERSION)/
	$(INSTALL_SOURCE) $(SRCS) .macosx
	( cd .macosx; \
		CFLAGS="-arch i386 -arch x86_64 -arch ppc" LDFLAGS="-arch i386 -arch x86_64 -arch ppc" make; \
		make install PREFIX=mdocml-$(VERSION) ; \
		zip -r ../$@@ mdocml-$(VERSION) )
	rm -rf .macosx

@


1.395.2.1
log
@Partial merge of rev. 1.396:
Remove lint support and Windows binaries.
@
text
@d176 4
d191 10
d208 6
d222 7
d234 18
d253 1
a253 14
arch.o: arch.in
att.o: att.in
chars.o: chars.in
lib.o: lib.in
msec.o: msec.in
roff.o: predefs.in
st.o: st.in
vol.o: vol.in

$(LIBMAN_OBJS): libman.h
$(LIBMDOC_OBJS): libmdoc.h
$(LIBROFF_OBJS): libroff.h
$(LIBMANDOC_OBJS): mandoc.h mdoc.h man.h libmandoc.h config.h
$(COMPAT_OBJS): config.h
d260 5
a264 1
$(MANDOC_HTML_OBJS): html.h
d267 1
d276 7
a282 1
$(MANDOC_TERM_OBJS): term.h
d290 10
a299 1
$(MANDOC_OBJS): main.h mandoc.h mdoc.h man.h config.h out.h
d302 3
a304 1
$(MANDOCDB_OBJS): mandocdb.h mandoc.h mdoc.h man.h config.h manpath.h
d307 3
a309 1
$(PRECONV_OBJS): config.h
d312 3
a314 1
$(APROPOS_OBJS): config.h mandoc.h apropos_db.h manpath.h mandocdb.h
d324 11
a334 1
$(CGI_OBJS): main.h mdoc.h man.h out.h config.h mandoc.h apropos_db.h manpath.h mandocdb.h
d337 3
a339 1
$(CATMAN_OBJS): config.h mandoc.h manpath.h mandocdb.h
d342 3
a344 1
$(DEMANDOC_OBJS): config.h
d433 2
d437 1
d439 1
d441 1
d443 1
d445 1
d447 1
d449 1
d451 3
a453 2
	rm -f config.h config.log $(COMPAT_OBJS)
	rm -f mdocml.tar.gz
d455 10
a464 1
	rm -rf *.dSYM
d503 3
d509 3
d515 3
d521 3
d530 3
d536 3
d542 3
d548 3
d560 31
@


1.395.2.2
log
@Merge rev. 1.400:
Stop producing xhtml/pdf/etc for webpage.
@
text
@d4 3
d8 1
d275 4
d280 4
d285 4
d290 4
d295 4
d300 4
d305 4
d310 4
d315 4
d320 4
d325 4
d330 4
d335 4
d340 9
a348 1
		   mandocdb.8.html
d482 3
d488 9
@


1.395.2.3
log
@Update VERSION, VDATE and CFLAGS for the upcoming 1.12.2 release.
Add tbl.3 and gmdiff to the tarball.
Add tbl.3.html to the website.
@
text
@d9 1
a9 1
# CFLAGS	+= -DOSNAME="\"OpenBSD 5.4\""
d11 2
a12 2
VERSION		 = 1.12.2
VDATE		 = 18 September 2013
a90 1
		   gmdiff \
a145 1
		   tbl.3 \
a275 1
		   tbl.3.html \
d323 1
a323 1
	$(INSTALL_MAN) mandoc.3 tbl.3 $(DESTDIR)$(MANDIR)/man3
@


1.395.2.4
log
@Final tweaks for the release candidate:
* Test for betoh64(), otherwise use be64toh().
* In the Makefile, improve the explanation of STATIC.
* Update VERSION and VDATE.
@
text
@d11 2
a12 2
VERSION		 = 1.12.2beta1
VDATE		 = 30 September 2013
d28 3
a30 2
# If your system does not support static binaries, comment this,
# for example on Mac OS X.
a31 2
# Linux requires -pthread to statically link with libdb.
#STATIC		+= -pthread
a158 1
		   test-betoh64.c \
a413 4
	  if $(CC) $(CFLAGS) -Werror -o test-betoh64 test-betoh64.c >> config.log 2>&1; then \
		echo '#define HAVE_BETOH64'; \
		rm test-betoh64; \
	  fi; \
@


1.395.2.5
log
@include the NEWS file into the tarball
@
text
@d11 2
a12 2
VERSION		 = 1.12.2beta2
VDATE		 = 01 October 2013
a63 1
		   NEWS \
@


1.395.2.6
log
@Release version 1.12.2.  This is no longer beta.
Sneak in a downstream link to Alpine Linux.
@
text
@d11 2
a12 2
VERSION		 = 1.12.2
VDATE		 = 05 October 2013
@


1.395.2.7
log
@Cleanup suggested by gcc-4.8.1, following hints by Christos Zoulas:
- avoid bad qualifier casting in roff.c, roff_parsetext()
  by changing the mandoc_escape arguments to "const char const **"
- avoid bad qualifier casting in mandocdb.c, index_merge()
- do not complain about unused variables in test-*.c
- garbage collect a few unused variables elsewhere
@
text
@d393 1
a393 1
	  if $(CC) $(CFLAGS) -Werror -Wno-unused -o test-fgetln test-fgetln.c >> config.log 2>&1; then \
d397 1
a397 1
	  if $(CC) $(CFLAGS) -Werror -Wno-unused -o test-strptime test-strptime.c >> config.log 2>&1; then \
d401 1
a401 1
	  if $(CC) $(CFLAGS) -Werror -Wno-unused -o test-getsubopt test-getsubopt.c >> config.log 2>&1; then \
d405 1
a405 1
	  if $(CC) $(CFLAGS) -Werror -Wno-unused -o test-strlcat test-strlcat.c >> config.log 2>&1; then \
d409 1
a409 1
	  if $(CC) $(CFLAGS) -Werror -Wno-unused -o test-mmap test-mmap.c >> config.log 2>&1; then \
d413 1
a413 1
	  if $(CC) $(CFLAGS) -Werror -Wno-unused -o test-strlcpy test-strlcpy.c >> config.log 2>&1; then \
d417 1
a417 1
	  if $(CC) $(CFLAGS) -Werror -Wno-unused -o test-betoh64 test-betoh64.c >> config.log 2>&1; then \
@


1.395.2.8
log
@Put VERSION into config.h.
This makes life easier for downstream maintainers having more than one
Makefile, for example DragonFly and FreeBSD.
Suggested by Franco Fichtner <franco at lastsummer dot de>.
@
text
@d34 1
a34 1
CFLAGS		+= -g -DHAVE_CONFIG_H
a392 1
	  echo '#define VERSION "$(VERSION)"'; \
@


1.395.2.9
log
@release 1.12.3
@
text
@d11 2
a12 2
VERSION		 = 1.12.3
VDATE		 = 31 December 2013
@


1.395.2.10
log
@Provide strcasestr(3) and strsep(3) for Solaris 10 compat;
reported missing by Matthias Scheler <tron at NetBSD> via wiz@@.
@
text
@a80 1
		   compat_strcasestr.c \
a82 1
		   compat_strsep.c \
a205 1
		   compat_strcasestr.o \
d207 1
a207 2
		   compat_strlcpy.o \
		   compat_strsep.o
a421 8
	  if $(CC) $(CFLAGS) -Werror -Wno-unused -o test-strcasestr test-strcasestr.c >> config.log 2>&1; then \
		echo '#define HAVE_STRCASESTR'; \
		rm test-strcasestr; \
	  fi; \
	  if $(CC) $(CFLAGS) -Werror -Wno-unused -o test-strsep test-strsep.c >> config.log 2>&1; then \
		echo '#define HAVE_STRSEP'; \
		rm test-strsep; \
	  fi; \
@


1.395.2.11
log
@Merge cleanup of feature tests to VERSION_1_12, resolving conflicts.
@
text
@a62 8
TESTSRCS	 = test-betoh64.c \
		   test-fgetln.c \
		   test-getsubopt.c \
		   test-mmap.c \
		   test-strlcat.c \
		   test-strlcpy.c \
		   test-strptime.c

d163 7
d173 1
a173 2
		   whatis.1 \
		   $(TESTSRCS)
d393 1
a393 1
config.h: configure config.h.pre config.h.post $(TESTSRCS)
d395 42
a436 1
	CC="$(CC)" CFLAGS="$(CFLAGS)" VERSION="$(VERSION)" ./configure
@


1.395.2.12
log
@Merge strnlen(3) configuration bits.
@
text
@a68 1
		   test-strnlen.c \
a91 1
		   compat_strnlen.c \
a212 1
		   compat_strnlen.o \
@


1.395.2.13
log
@Put ./configure into the distribution tarball.
@
text
@a96 1
		   configure \
d393 1
a393 2
	chmod 755 .dist/mdocml-$(VERSION)/configure
	( cd .dist/ && tar zcf ../$@@ mdocml-$(VERSION) )
@


1.395.2.14
log
@- remove index.html, is now part of the website repo
- and some general cleanup (installcgi is .PHONY)
@
text
@d1 2
a2 2
.PHONY: 	 clean install installcgi installwww
.SUFFIXES:	 .md5 .h .h.html
a5 4
VERSION		 = 1.12.3

# === USER SETTINGS ====================================================

d11 3
d105 1
d109 2
d285 1
a285 1
WWW_MANS	 = apropos.1.html \
d300 5
a304 1
		   mandocdb.8.html \
d307 3
a309 3
		   mdoc.h.html

$(WWW_MANS): mandoc
d311 1
a311 2
WWW_OBJS	 = mdocml.tar.gz \
		   mdocml.md5
d323 2
a324 1
	rm -f $(WWW_MANS) $(WWW_OBJS)
d350 10
a359 8
installwww: $(WWW_MANS) $(WWW_OBJS)
	mkdir -p $(DESTDIR)$(HTDOCDIR)/snapshots
	$(INSTALL_DATA) $(WWW_MANS) style.css $(DESTDIR)$(HTDOCDIR)
	$(INSTALL_DATA) $(WWW_OBJS) $(DESTDIR)$(HTDOCDIR)/snapshots
	$(INSTALL_DATA) mdocml.tar.gz \
		$(DESTDIR)$(HTDOCDIR)/snapshots/mdocml-$(VERSION).tar.gz
	$(INSTALL_DATA) mdocml.md5 \
		$(DESTDIR)$(HTDOCDIR)/snapshots/mdocml-$(VERSION).md5
d398 2
d409 4
@


1.395.2.15
log
@introduce mandoc_aux to 1.12
@
text
@a130 2
		   mandoc_aux.c \
		   mandoc_aux.h \
a205 1
		   mandoc_aux.o \
d229 1
a229 1
$(LIBMANDOC_OBJS): mandoc.h mandoc_aux.h mdoc.h man.h libmandoc.h config.h
d256 1
a256 1
$(MANDOC_OBJS): main.h mandoc.h mandoc_aux.h mdoc.h man.h config.h out.h
d259 1
a259 2
$(MANDOCDB_OBJS): mandocdb.h mandoc.h mandoc_aux.h \
		  mdoc.h man.h config.h manpath.h
d275 1
a275 2
$(CGI_OBJS): main.h mdoc.h man.h out.h config.h mandoc.h mandoc_aux.h \
	     apropos_db.h manpath.h mandocdb.h
@


1.395.2.16
log
@include the LICENSE into the distribution tarball
@
text
@d73 1
a73 2
SRCS		 = LICENSE \
		   Makefile \
@


1.395.2.17
log
@Audit malloc(3)/calloc(3)/realloc(3) in VERSION_1_12.
@
text
@a67 1
		   test-reallocarray.c \
a91 1
		   compat_reallocarray.c \
a214 1
		   compat_reallocarray.o \
@


1.395.2.18
log
@Merge from HEAD:
* Use sha256 rather than md5.
* Update .h dependencies for some objects.
* Provide `www' target to build everything needed for the web site.
* Move .SUFFIXES and .PHONY technicalities to the bottom.
* State Copyright and license, just for clarity.
* Bump VERSION in preparation for release.
@
text
@d1 4
a4 16
# $Id$
#
# Copyright (c) 2010, 2011, 2012 Kristaps Dzonsons <kristaps@@bsd.lv>
# Copyright (c) 2011, 2013, 2014 Ingo Schwarze <schwarze@@openbsd.org>
#
# Permission to use, copy, modify, and distribute this software for any
# purpose with or without fee is hereby granted, provided that the above
# copyright notice and this permission notice appear in all copies.
#
# THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
# WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
# MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
# ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
# WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
# ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
# OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
d6 1
a6 1
VERSION		 = 1.12.4
d13 1
a13 1
# CFLAGS	+= -DOSNAME="\"OpenBSD 5.5\""
d60 1
d62 1
a62 5
# === END OF USER SETTINGS =============================================

ALLBIN		 = mandoc preconv demandoc $(DBBIN)

all: $(ALLBIN)
a223 2
# === DEPENDENCY HANDLING ==============================================

d273 1
a273 2
$(APROPOS_OBJS): config.h mandoc.h mandoc_aux.h manpath.h \
		 apropos_db.h mandocdb.h
d287 1
a287 1
$(CATMAN_OBJS): config.h mandoc_aux.h manpath.h mandocdb.h
d290 1
a290 1
$(DEMANDOC_OBJS): config.h mandoc.h man.h mdoc.h
a295 1
		   preconv.1.html \
d304 1
a309 2
		   mandoc_aux.h.html \
		   manpath.h.html \
d312 2
d315 1
a315 5
		   mdocml.sha256

www: $(WWW_OBJS) $(WWW_MANS)

# === TARGETS CONTAINING SHELL COMMANDS ================================
a318 1
	rm -f apropos whatis $(APROPOS_OBJS)
d321 1
d343 1
a343 2
	$(INSTALL_MAN) man.7 mdoc.7 roff.7 eqn.7 tbl.7 mandoc_char.7 \
		$(DESTDIR)$(MANDIR)/man7
d353 1
a353 1
installwww: www
d359 2
a360 2
	$(INSTALL_DATA) mdocml.sha256 \
		$(DESTDIR)$(HTDOCDIR)/snapshots/mdocml-$(VERSION).sha256
d389 2
a390 2
mdocml.sha256: mdocml.tar.gz
	sha256 mdocml.tar.gz > $@@
a402 4
.PHONY: 	 clean install installcgi installwww
.SUFFIXES:	 .1       .3       .5       .7       .8       .h
.SUFFIXES:	 .1.html  .3.html  .5.html  .7.html  .8.html  .h.html

d404 1
a404 1
	highlight -I $< > $@@
d406 2
a407 3
.1.1.html .3.3.html .5.5.html .7.7.html .8.8.html: mandoc
	./mandoc -Thtml -Wall,stop \
		-Ostyle=style.css,man=%N.%S.html,includes=%I.html $< > $@@
@


1.395.2.19
log
@remove strnlen(3) compat, we no longer use it
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.395.2.18 2014/04/24 00:36:44 schwarze Exp $
d86 1
d112 1
d236 1
@


1.395.2.20
log
@Remove the old man.cgi.
Running that would not be a responsible thing to do, nowadays.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.395.2.19 2014/08/04 23:45:37 schwarze Exp $
d37 1
a37 1
# and mandocdb(8) will popen(3) manpath(1) to get the MANPATH
d41 6
d52 1
d71 1
a71 1
DBBIN		 = apropos mandocdb whatis
d100 3
d135 2
d290 14
d308 1
d317 1
d341 2
d366 7
d400 6
d423 1
a423 1
.PHONY: 	 clean install installwww
@


1.395.2.21
log
@sort user settings; no functional change
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.395.2.20 2014/08/05 00:42:53 schwarze Exp $
a21 2
# --- user settings relevant for all builds ----------------------------

d35 6
d44 2
a50 1

a57 7
# --- user settings related to database support ------------------------

# If you want to build without database support, for example to avoid
# the dependency on Berkeley DB, comment the following line.
#
DBBIN		 = apropos mandocdb whatis

d60 2
d64 1
a64 9

# If your system has manpath(1), uncomment this.  This is most any
# system that's not OpenBSD or NetBSD.  If uncommented, apropos(1)
# and mandocdb(8) will use manpath(1) to get the MANPATH variable.
#
#CFLAGS		+= -DUSE_MANPATH

WWWPREFIX	 = /var/www
HTDOCDIR	 = $(WWWPREFIX)/htdocs
@


1.395.2.22
log
@Various minor corrections:
* Do not install programs and libs root-writeable.
* Add missing test-strcasestr.c and test-strsep.c to TESTSRCS.
* Add missing mandoc_html.3 to SRCS.
* Add missing mandoc_html.3.html to WWW_MANS.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.395.2.21 2014/08/05 01:07:42 schwarze Exp $
d47 1
a47 1
INSTALL_PROGRAM	 = $(INSTALL) -m 0555
d49 1
a49 1
INSTALL_LIB	 = $(INSTALL) -m 0444
a84 1
		   test-strcasestr.c \
d87 1
a87 2
		   test-strptime.c \
		   test-strsep.c
a145 1
		   mandoc_html.3 \
a294 1
		   mandoc_html.3.html \
@


1.395.2.23
log
@Properly partition the build system and install some missing stuff:
* Introduce targets base-build and db-build.
* Introduce targets base-install and db-install.
* Introduce a BUILD_TARGETS variable to contain db-build.
* Introduce an INSTALL_TARGETS variable and fill it using BUILD_TARGETS.
* Install the apropos(1) and mandocdb(8) binaries.
* Install whatis(1) as a hard link to apropos(1).
* Install the apropos(1), whatis(1), and mandocdb(8) manuals.
* Install mandoc_aux.h.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.395.2.22 2014/08/05 01:46:07 schwarze Exp $
a56 1
# However, you won't get apropos(1) and makewhatis(8) in that case.
d58 1
a58 5
BUILD_TARGETS	+= db-build

# The remaining settings in this section
# are only relevant if db-build is enabled.
# Otherwise, they have no effect either way.
d76 1
a76 1
INSTALL_TARGETS	 = $(BUILD_TARGETS:-build=-install)
d78 1
a78 2
BASEBIN		 = mandoc preconv demandoc
DBBIN		 = apropos mandocdb
a236 8
all: base-build $(BUILD_TARGETS)

base-build: $(BASEBIN)

db-build: $(DBBIN)

install: base-install $(INSTALL_TARGETS)

d322 1
a322 1
	rm -f apropos $(APROPOS_OBJS)
d331 1
a331 1
base-install: base-build
d339 1
a339 1
	$(INSTALL_PROGRAM) $(BASEBIN) $(DESTDIR)$(BINDIR)
d341 1
a341 2
	$(INSTALL_LIB) man.h mandoc.h mandoc_aux.h mdoc.h \
		$(DESTDIR)$(INCLUDEDIR)
d348 1
a348 10
db-install: db-build
	mkdir -p $(DESTDIR)$(BINDIR)
	mkdir -p $(DESTDIR)$(MANDIR)/man1
	mkdir -p $(DESTDIR)$(MANDIR)/man8
	$(INSTALL_PROGRAM) $(DBBIN) $(DESTDIR)$(BINDIR)
	ln -f $(DESTDIR)$(BINDIR)/apropos $(DESTDIR)$(BINDIR)/whatis
	$(INSTALL_MAN) apropos.1 whatis.1 $(DESTDIR)$(MANDIR)/man1
	$(INSTALL_MAN) mandocdb.8 $(DESTDIR)$(MANDIR)/man8

www-install: www
d369 3
d392 1
a392 1
.PHONY: 	 base-install clean db-install install www-install
@


1.395.2.24
log
@Switch to autogenerated dependency rules; they are less error-prone.
Provide a maintainer target to regenerate them.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.395.2.23 2014/08/05 03:15:22 schwarze Exp $
d97 6
a102 1
SRCS		 = apropos.c \
d104 1
d106 1
d108 1
d110 1
d118 4
d123 1
d127 2
d130 1
d132 5
d138 2
d141 1
d147 2
d150 1
d152 4
d157 1
d159 2
d162 1
d171 1
d173 2
d176 1
d178 1
d181 4
d192 1
a196 49
		   $(TESTSRCS)

DISTFILES	 = LICENSE \
		   Makefile \
		   Makefile.depend \
		   NEWS \
		   TODO \
		   apropos.1 \
		   apropos_db.h \
		   arch.in \
		   att.in \
		   chars.in \
		   config.h.post \
		   config.h.pre \
		   configure \
		   demandoc.1 \
		   eqn.7 \
		   example.style.css \
		   gmdiff \
		   html.h \
		   lib.in \
		   libman.h \
		   libmandoc.h \
		   libmdoc.h \
		   libroff.h \
		   main.h \
		   man.7 \
		   man.h \
		   mandoc.1 \
		   mandoc.3 \
		   mandoc.h \
		   mandoc_aux.h \
		   mandoc_char.7 \
		   mandoc_html.3 \
		   mandocdb.8 \
		   mandocdb.h \
		   manpath.h \
		   mdoc.7 \
		   mdoc.h \
		   msec.in \
		   out.h \
		   preconv.1 \
		   predefs.in \
		   roff.7 \
		   st.in \
		   style.css \
		   tbl.3 \
		   tbl.7 \
		   term.h \
d199 1
a199 1
		   $(SRCS)
d241 25
d271 1
d282 1
d290 1
d293 2
d297 1
d300 2
d304 1
a329 10
# === DEPENDENCY HANDLING ==============================================

all: base-build $(BUILD_TARGETS)

base-build: $(BASEBIN)

db-build: $(DBBIN)

install: base-install $(INSTALL_TARGETS)

a331 2
.include "Makefile.depend"

a380 6
Makefile.depend: $(SRCS) config.h Makefile
	mkdep -f Makefile.depend $(CFLAGS) $(SRCS)
	perl -e 'undef $$/; $$_ = <>; s|/usr/include/\S+||g; \
		s|\\\n||g; s|  +| |g; print;' Makefile.depend > Makefile.tmp
	mv Makefile.tmp Makefile.depend

d402 1
a402 1
mdocml.tar.gz: $(DISTFILES)
d404 1
a404 1
	$(INSTALL_SOURCE) $(DISTFILES) .dist/mdocml-$(VERSION)
@


1.395.2.25
log
@Split mandoc_escape(3), mandoc_malloc(3), and mchars_alloc(3)
out of mandoc(3), adding lots of new information.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.395.2.24 2014/08/05 05:29:53 schwarze Exp $
a183 1
		   mandoc_escape.3 \
a184 1
		   mandoc_malloc.3 \
a187 1
		   mchars_alloc.3 \
a280 1
		   mandoc_escape.3.html \
a281 2
		   mandoc_malloc.3.html \
		   mchars_alloc.3.html \
d339 1
a339 2
	$(INSTALL_MAN) mandoc.3 mandoc_escape.3 mandoc_malloc.3 \
		mchars_alloc.3 tbl.3 $(DESTDIR)$(MANDIR)/man3
@


1.395.2.26
log
@merge portability fix from HEAD
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.395.2.25 2014/08/05 05:51:33 schwarze Exp $
d317 1
a317 1
include Makefile.depend
d369 1
a369 1
depend: config.h
d407 1
a407 2
.PHONY: 	 base-install db-install install www-install
.PHONY: 	 clean depend
@


1.395.2.27
log
@Get rid of HAVE_CONFIG_H, it is always defined; idea from libnbcompat.
Include <sys/types.h> where needed, it does not belong in config.h.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.395.2.26 2014/08/05 11:19:46 schwarze Exp $
d37 2
a38 2
CFLAGS		+= -g -W -Wall -Wstrict-prototypes
CFLAGS     	+= -Wno-unused-parameter -Wwrite-strings
@


1.395.2.28
log
@typo in comment; Guy Harris <guy at alum dot mit dot edu>
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.395.2.27 2014/08/11 00:31:13 schwarze Exp $
d33 1
a33 1
# If you don't define it, -Tlocale is a synonym for -Tascii.
@


1.395.2.29
log
@Add INSTALL, and remove WWW gunk from the Makefile, we are not
going to rebuild the website from this version.
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.395.2.28 2014/08/12 21:37:42 schwarze Exp $
d76 3
d153 1
a153 2
DISTFILES	 = INSTALL \
		   LICENSE \
d278 24
d315 1
a315 1
www: $(WWW_OBJS)
d329 1
a329 1
	rm -f $(WWW_OBJS)
d360 9
d407 1
a407 1
.PHONY: 	 base-install db-install install
d409 9
@


1.394
log
@Remove some Mac OS crap in the Makefile.
@
text
@d15 2
a16 2
VERSION		 = 1.12.0
VDATE		 = 8 October 2011
a144 1
		   regress \
@


1.393
log
@Don't run superfluous mkdir when installing.
@
text
@d456 10
a465 6
	rm -rf test-fgetln.DSYM
	rm -rf test-strlcpy.DSYM
	rm -rf test-strlcat.DSYM 
	rm -rf test-strptime.DSYM 
	rm -rf test-mmap.DSYM 
	rm -rf test-getsubopt.DSYM
@


1.392
log
@Continue changing mandoc.{index,db} into whatis.{index,db}.  Use mandocdb.h
to do so.
@
text
@a470 1
	mkdir -p $(DESTDIR)$(MANDIR)/man8
@


1.391
log
@Some presentation polish in man.cgi:

 - include search bar above result page (I relent: it's annoying to
   follow three links then press back three times to get a search page);
 - make man.cgi.css into man-cgi.css so Apache isn't confused by two
   handlers (css, cgi);
 - finally consolidate example.style.css to be under the div.mandoc css
   selector;
 - put catman pages under div.catman;
 - put search bar under div#mancgi;
 - reflect this properly in the bundled CSS files.
@
text
@d340 1
a340 1
$(CATMAN_OBJS) $(CATMAN_LNS): config.h mandoc.h manpath.h 
@


1.390
log
@Compatibility support fgetln() on Linux.  This uses the BSD-licensed
implementation from NetBSD tnftpd, Christos Zoulas (copyright message
retained in the compat_fgetln.c file).  Patch verified by schwarze@@.  He
notes that you'll need -pthread for -static binaries (due to libdb), so
I've noted that -static should really only be used for BSD UNIX.

While here, add some forgotten goop to the Makefile, building and
cleaning extra manpages.
@
text
@d110 1
a110 1
		   man.cgi.css \
d485 1
a485 1
	$(INSTALL_DATA) man.cgi.css $(DESTDIR)$(HTDOCDIR)
@


1.389
log
@Adding some missing "install" bits to Makefile.
@
text
@d32 3
a34 1
# If your system supports static binaries only, uncomment this.
d81 1
d162 1
d231 2
a232 1
COMPAT_OBJS	 = compat_getsubopt.o \
d235 2
a236 1
COMPAT_LNS	 = compat_getsubopt.ln \
d352 5
d387 5
d456 1
d595 4
@


1.388
log
@Have a whatis/apropos mode, with the default (hitting enter within the
expression text) be whatis.  This is a much nicer default than apropos,
which can be scary.  While here, fix the cat.css location (erroneously
put in the response page instead of the catman page) and add bits for
a default style-sheet.
@
text
@d65 1
d68 2
d74 3
d84 1
a85 1
		   demandoc.1 \
a103 1
		   man.h \
d107 2
d118 1
a121 1
		   mandoc_char.7 \
a123 3
		   catman.c \
		   catman.8 \
		   mdoc.h \
d126 1
d142 1
d166 2
a167 1
		   vol.in
d356 5
d427 1
a427 1
	rm -f apropos $(APROPOS_OBJS)
@


1.387
log
@Make installing CGI a bit easier.
@
text
@d456 1
@


1.386
log
@By default, man.cgi should compile with -static (this was unset by mistake).
Also, set a custom CSS for man.cgi catman files.
@
text
@d38 3
d451 6
@


1.385
log
@In man(7), when no explicit volume name is given, use the default
volume name for the respective manual section, just like in mdoc(7).
This gives us nicer page headers for cvs(1), lynx(1), tic(1),
mkhybrid(8), and many curses(3) manuals.

ok kristaps@@

To not break compatibility, i wrote a corresponding patch for GNU troff
which Werner Lemberg accepted upstream at rev. 1.65 of:
http://cvs.savannah.gnu.org/viewvc/groff/tmac/an-old.tmac?root=groff
@
text
@d33 1
a33 1
#STATIC		 = -static
@


1.384
log
@Backout -DUSE_MANPATH that sneaked in;
ok kristaps@@.
@
text
@a175 1
		   msec.o \
a185 1
		   msec.ln \
d207 1
d214 1
@


1.383
log
@Removing INSECURE mode.  This is a work in progress!  Logic for
formatting manpages is now linked into man.cgi.
@
text
@d30 1
a30 1
CFLAGS		+= -DUSE_MANPATH
d32 1
a32 1
# If your system doesn't support static binaries, comment this.
@


1.382
log
@Make a small manual for how to run man.cgi.
This exists almost entirely to document that /tmp must exist in a jailed
Apache directory for dbopen() not to fail.  This was a massive headache
to track down.
@
text
@d30 4
a33 1
# CFLAGS	+= -DUSE_MANPATH
d56 2
a57 2
DBBIN		 = apropos mandocdb man.cgi manup
DBLN		 = llib-lapropos.ln llib-lmandocdb.ln llib-lman.cgi.ln llib-lmanup.ln
d114 2
a115 2
		   manup.c \
		   manup.8 \
d301 8
a308 2
CGI_OBJS	 = cgi.o apropos_db.o manpath.o
CGI_LNS	 	 = cgi.ln apropos_db.ln manpath.ln
d310 8
a317 1
$(CGI_OBJS) $(CGI_LNS): config.h mandoc.h apropos_db.h manpath.h mandocdb.h
d319 1
a319 2
MANUP_OBJS	 = manup.o manpath.o
MANUP_LNS 	 = manup.ln manpath.ln
d321 4
a324 1
$(MANUP_OBJS) $(MANUP_LNS): config.h mandoc.h manpath.h 
d416 2
a417 2
	rm -f manup $(MANUP_OBJS)
	rm -f llib-lmanup.ln $(MANUP_LNS)
d483 3
d492 2
a493 2
manup: $(MANUP_OBJS) libmandoc.a
	$(CC) $(LDFLAGS) -o $@@ $(MANUP_OBJS) libmandoc.a $(DBLIB)
d495 2
a496 2
llib-lmanup.ln: $(MANUP_LNS) llib-llibmandoc.ln
	$(LINT) $(LINTFLAGS) -Cmanup $(MANUP_LNS) llib-llibmandoc.ln
d499 1
a499 1
	$(CC) $(LDFLAGS) -static -o $@@ $(CGI_OBJS) libmandoc.a $(DBLIB)
@


1.381
log
@Add manup(8).  This runs through mandocdb(8) databases (in the same way that
apropos(1) does so) and updates an HTML fragment cache for use by man.cgi.
Right now man.cgi is "online" in that it requires mandoc(1) in its path,
but this doesn't work for, say, OpenBSD's apache chroot(1).  This allows
a cache to be maintained.
@
text
@d95 1
@


1.380
log
@Adjust Makefile for manpath.{c,h} linking.
@
text
@d53 2
a54 2
DBBIN		 = apropos mandocdb man.cgi
DBLN		 = llib-lapropos.ln llib-lmandocdb.ln llib-lman.cgi.ln
d110 2
d302 5
d397 2
d470 6
@


1.379
log
@Initial support for man.conf/makepath(1).
@
text
@d26 4
a29 1
# If your system has manpath(1), check this off.
d108 2
d280 2
a281 2
MANDOCDB_OBJS	 = mandocdb.o
MANDOCDB_LNS	 = mandocdb.ln
d283 1
a283 1
$(MANDOCDB_OBJS) $(MANDOCDB_LNS): mandocdb.h mandoc.h mdoc.h man.h config.h
d290 2
a291 2
APROPOS_OBJS	 = apropos.o apropos_db.o
APROPOS_LNS	 = apropos.ln apropos_db.ln
d293 1
a293 1
$(APROPOS_OBJS) $(APROPOS_LNS): config.h mandoc.h mandocdb.h apropos_db.h
d295 2
a296 2
CGI_OBJS	 = cgi.o apropos_db.o
CGI_LNS	 	 = cgi.ln apropos_db.ln
d298 1
a298 1
$(CGI_OBJS) $(CGI_LNS): config.h mandoc.h mandocdb.h apropos_db.h
d462 1
a462 1
	$(CC) $(LDFLAGS) -o $@@ $(CGI_OBJS) libmandoc.a $(DBLIB)
@


1.378
log
@Inventing new keywords for mostly the same thing when a well-established
set of keywords already exists is a bad idea, so reuse the mdoc(7)
macro names as apropos(1) search types.  This is a gain in brevity
as well.  Some time ago, kristaps@@ agreed in principle.

The search type bit field constants are used by both mandocdb(8) and
apropos(1) and should better stay in sync, so give them their own
header file.
@
text
@d26 3
@


1.377
log
@Less misleading file names; ok kristaps@@.
@
text
@d100 1
d275 1
a275 1
$(MANDOCDB_OBJS) $(MANDOCDB_LNS): mandoc.h mdoc.h man.h config.h
d285 1
a285 1
$(APROPOS_OBJS) $(APROPOS_LNS): config.h mandoc.h apropos_db.h
d290 1
a290 1
$(CGI_OBJS) $(CGI_LNS): config.h mandoc.h apropos_db.h
@


1.376
log
@Split apropos.c into db.c and apropos.h with simpler code (re-written, but
inspired by apropos.c and mandoc-tools' mandoc-cgi.c).  This uses UTF-8
right now for its re-writing, but will soon accomodate for the regular
suspects (this is a rather simple matter).

I also introduce man.cgi (cgi.c), which is a standalone CGI that replaces
mandoc-tools' mandoc.cgi.  Right now it's just a framework.
@
text
@d281 2
a282 2
APROPOS_OBJS	 = apropos.o db.o
APROPOS_LNS	 = apropos.ln db.ln
d284 1
a284 1
$(APROPOS_OBJS) $(APROPOS_LNS): config.h mandoc.h apropos.h
d286 2
a287 2
CGI_OBJS	 = cgi.o db.o
CGI_LNS	 	 = cgi.ln db.ln
d289 1
a289 1
$(CGI_OBJS) $(CGI_LNS): config.h mandoc.h apropos.h
@


1.375
log
@Tweak Makefile and add config.h to -Tman to allow cross-compiling on
Windows (via MingW).
@
text
@d47 2
a48 1
DBBIN		 = apropos mandocdb
d281 2
a282 2
APROPOS_OBJS	 = apropos.o
APROPOS_LNS	 = apropos.ln
d284 6
a289 1
$(APROPOS_OBJS) $(APROPOS_LNS): config.h mandoc.h
d368 1
a368 1
lint: llib-llibmandoc.ln llib-lmandoc.ln llib-lpreconv.ln llib-ldemandoc.ln
d379 2
d431 2
a432 2
llib-lmandoc.ln: $(MANDOC_LNS)
	$(LINT) $(LINTFLAGS) -Cmandoc $(MANDOC_LNS)
d437 2
a438 2
llib-lmandocdb.ln: $(MANDOCDB_LNS)
	$(LINT) $(LINTFLAGS) -Cmandocdb $(MANDOCDB_LNS)
d443 2
a444 2
llib-lpreconv.ln: $(PRECONV_LNS)
	$(LINT) $(LINTFLAGS) -Cpreconv $(PRECONV_LNS)
d449 8
a456 2
llib-lapropos.ln: $(APROPOS_LNS)
	$(LINT) $(LINTFLAGS) -Capropos $(APROPOS_LNS)
d461 2
a462 2
llib-ldemandoc.ln: $(DEMANDOC_LNS)
	$(LINT) $(LINTFLAGS) -Cdemandoc $(DEMANDOC_LNS)
@


1.374
log
@Get ready for version.  I'm bumping the minor release to 1.12 because
this involves both a major functionality addition (-Tman), a new utility
(apropos), and both apropos and mandocdb being built by default.
@
text
@d12 1
d17 1
d23 1
d25 1
d41 5
a45 1
# Linux needs -ldb to compile mandocdb.
d47 1
d49 1
a49 1
all: mandoc preconv demandoc apropos mandocdb
d463 1
a463 1
	grep -v DUSE_WCHAR .win32/Makefile.old >.win32/Makefile
d474 1
a474 1
	grep -v DUSE_WCHAR .win64/Makefile.old >.win64/Makefile
@


1.373
log
@Make apropos and mandocdb build by default.
@
text
@d14 2
a15 2
VERSION		 = 1.11.7
VDATE		 = 2 September 2011
@


1.372
log
@Import apropos from mandoc-tools after inlining all source files
(originally including extern.h, state.c, and sort.c).  The apropos
utility interfaces with the databases of mandocdb to provide semantic
searching capabilities.  It Works For Me, but will need lots of cleanup
in the coming months.
@
text
@d40 1
a40 1
all: mandoc preconv demandoc
d430 1
a430 1
	$(CC) $(LDFLAGS) -o $@@ $(APROPOS_OBJS) libmandoc.a
@


1.371
log
@Initial, incomplete support for -Tman
to convert mdoc(7) documents to the man(7) language.
This is work in progress and will be developed in tree.
It does already handle the cat(1) manual,
but will hardly handle all your fancy manuals yet.
go ahead  kristaps@@ jmc@@ millert@@ deraadt@@
@
text
@d43 2
d271 5
d281 6
a286 1
INDEX_MANS	 = demandoc.1.html \
d362 2
d429 6
@


1.370
log
@Adding version notes.
@
text
@d96 1
d224 3
d243 1
d249 1
@


1.369
log
@Add demandoc utility, a replacement for deroff.
@
text
@d14 2
a15 2
VERSION		 = 1.11.6
VDATE		 = 16 August 2011
@


1.368
log
@Added generation of Universal binary.  Fixed up index.sgml to be shorter
and more expressive.
@
text
@d40 1
a40 1
all: mandoc preconv
d54 2
d263 11
a273 1
INDEX_MANS	 = mandoc.1.html \
d335 1
a335 1
lint: llib-llibmandoc.ln llib-lmandoc.ln llib-lpreconv.ln
d344 2
d366 1
a366 1
	$(INSTALL_PROGRAM) mandoc preconv $(DESTDIR)$(BINDIR)
d369 1
a369 1
	$(INSTALL_MAN) mandoc.1 preconv.1 $(DESTDIR)$(MANDIR)/man1
d409 6
@


1.367
log
@Version: 1.11.6.
@
text
@d335 1
a335 1
	rm -f mdocml.tar.gz mdocml-win32.zip mdocml-win64.zip
d378 1
a378 1
	$(CC) -o $@@ $(MANDOC_OBJS) libmandoc.a
d384 1
a384 1
	$(CC) -o $@@ $(MANDOCDB_OBJS) libmandoc.a $(DBLIB)
d390 1
a390 1
	$(CC) -o $@@ $(PRECONV_OBJS)
d409 2
a410 1
	( cd .win32; CC=i686-w64-mingw32-gcc AR=i686-w64-mingw32-ar CFLAGS='-DOSNAME=\"Windows\"' make; \
d420 2
a421 1
	( cd .win64; CC=x86_64-w64-mingw32-gcc AR=x86_64-w64-mingw32-ar CFLAGS='-DOSNAME=\"Windows\"' make; \
d426 8
@


1.366
log
@Updating mingw32 install hooks for new mingw version.
@
text
@d14 2
a15 2
VERSION		 = 1.11.5
VDATE		 = 24 July 2011
@


1.365
log
@Initial version bits in place.  Also added forgotten tests to installed files.
@
text
@d335 1
a335 1
	rm -f mdocml.tar.gz mdocml-win32.zip
d409 1
a409 1
	( cd .win32; CC=i586-mingw32msvc-cc AR=i586-mingw32msvc-ar CFLAGS='-DOSNAME=\"Windows\"' make; \
d414 11
@


1.364
log
@Implement the first steps of equation parsing from within libmdoc.
This consists of a shim around the text parser that calls out to libroff
if equation components exist on the line.  Right now this will do
nothing, as the equation delimiter always returns nil.
@
text
@d120 1
d124 1
@


1.363
log
@We're officially no longer UNIX-specific; make this clear.
@
text
@d335 5
@


1.362
log
@Scary-looking but otherwise harmless changes allow me to build for Windows.
That is to say, with mingw32.  This amounts to the following:

 (1) break compat.c into compat_strlcpy.c and compat_strlcat.c
 (2) add compat_getsubopt.c (from OpenBSD) and test-getsubopt.c
 (3) add test-strptime.c for HAVE_STRPTIME
 (4) add ifdef bits here and there, where necessary
 (5) remove some harmless unportable stuff (u_char, localtime_r)

I've added the appropriate mdocml.zip target to the Makefile, too.
@
text
@d333 1
a333 1
	rm -f mdocml.tar.gz mdocml.zip
d355 1
d397 1
a397 1
mdocml.zip: $(SRCS)
@


1.361
log
@Tuned the initial eqn output, making it completely simple.  This
completes a full initial eqn system, so I'm tagging a release on it.
@
text
@d21 2
a22 1
CFLAGS		+= -g -DUSE_WCHAR -DHAVE_CONFIG_H -DVERSION="\"$(VERSION)\""
d49 3
a51 1
		   compat.c \
d185 7
d206 2
a248 2
compat.o compat.ln: config.h

d332 2
a333 2
	rm -f config.h config.log compat.o compat.ln
	rm -f mdocml.tar.gz
d363 2
a364 2
libmandoc.a: compat.o $(LIBMANDOC_OBJS)
	$(AR) rs $@@ compat.o $(LIBMANDOC_OBJS)
d366 2
a367 2
llib-llibmandoc.ln: compat.ln $(LIBMANDOC_LNS)
	$(LINT) $(LINTFLAGS) -Clibmandoc compat.ln $(LIBMANDOC_LNS)
d396 10
d412 8
@


1.360
log
@Flip on equation printing for -T[x]html.
@
text
@d14 2
a15 2
VERSION		 = 1.11.4
VDATE		 = 12 July 2011
@


1.359
log
@Add character output (-Tpdf, -Tps, -Tascii) for equations.  This is the
minimum: unseparated terms.
@
text
@d53 1
d196 2
a197 1
MANDOC_HTML_OBJS = html.o \
d201 2
a202 1
MANDOC_HTML_LNS	 = html.ln \
@


1.358
log
@Make `struct roff' be passed into libmdoc and libman upon creation.
This is required for supporting in-line equations.  While here, push
registers properly into roff and add an set/get/mod interface.
@
text
@d53 1
d204 2
a205 1
MANDOC_TERM_OBJS = man_term.o \
d211 2
a212 1
MANDOC_TERM_LNS	 = man_term.ln \
@


1.357
log
@Remember to NULL-ify new keys/vals.
@
text
@d36 3
a358 1
# You'll need -ldb for Linux.
d360 1
a360 1
	$(CC) -o $@@ $(MANDOCDB_OBJS) libmandoc.a -ldb
@


1.356
log
@move mandocdb(1) to mandocdb(8)
"please make this change" kristaps@@
@
text
@d358 1
a358 1
	$(CC) -o $@@ $(MANDOCDB_OBJS) libmandoc.a
@


1.355
log
@Rename makewhatis [back] into mandocdb.  This is to maintain consistency
with OpenBSD, which is sandboxing the code for merge.  It makes sense
because it doesn't really make a `makewhatis' file in the traditional
sense, so it may be confusing.
@
text
@d3 6
a8 6
.SUFFIXES:	 .1       .3       .7
.SUFFIXES:	 .1.txt   .3.txt   .7.txt
.SUFFIXES:	 .1.pdf   .3.pdf   .7.pdf
.SUFFIXES:	 .1.ps    .3.ps    .7.ps
.SUFFIXES:	 .1.html  .3.html  .7.html 
.SUFFIXES:	 .1.xhtml .3.xhtml .7.xhtml 
d76 1
a76 1
		   mandocdb.1 \
d240 1
a240 6
INDEX_MANS	 = mandocdb.1.html \
		   mandocdb.1.xhtml \
		   mandocdb.1.ps \
		   mandocdb.1.pdf \
		   mandocdb.1.txt \
		   mandoc.1.html \
d284 6
a289 1
		   tbl.7.txt
d325 1
d403 1
a403 1
.1.1.txt .3.3.txt .7.7.txt:
d406 1
a406 1
.1.1.html .3.3.html .7.7.html:
d409 1
a409 1
.1.1.ps .3.3.ps .7.7.ps:
d412 1
a412 1
.1.1.xhtml .3.3.xhtml .7.7.xhtml:
d415 1
a415 1
.1.1.pdf .3.3.pdf .7.7.pdf:
@


1.354
log
@Note version 1.11.4 bits.  Here we go!
@
text
@d76 2
a77 2
		   makewhatis.1 \
		   makewhatis.c \
d230 2
a231 2
MAKEWHATIS_OBJS	 = makewhatis.o
MAKEWHATIS_LNS	 = makewhatis.ln
d233 1
a233 1
$(MAKEWHATIS_OBJS) $(MAKEWHATIS_LNS): mandoc.h mdoc.h man.h config.h
d240 5
a244 5
INDEX_MANS	 = makewhatis.1.html \
		   makewhatis.1.xhtml \
		   makewhatis.1.ps \
		   makewhatis.1.pdf \
		   makewhatis.1.txt \
d307 2
a308 2
	rm -f makewhatis $(MAKEWHATIS_OBJS)
	rm -f llib-lmakewhatis.ln $(MAKEWHATIS_LNS)
d356 2
a357 2
makewhatis: $(MAKEWHATIS_OBJS) libmandoc.a
	$(CC) -o $@@ $(MAKEWHATIS_OBJS) libmandoc.a
d359 2
a360 2
llib-lmakewhatis.ln: $(MAKEWHATIS_LNS)
	$(LINT) $(LINTFLAGS) -Cmakewhatis $(MAKEWHATIS_LNS)
@


1.353
log
@Install sources with mode 0644.  Noted by Jack Nagel.  Ok schwarze@@.
@
text
@d14 2
a15 2
VERSION		 = 1.11.3
VDATE		 = 26 May 2011
@


1.352
log
@We obviously need man.h and mdoc.h installed as mentioned in mandoc.3.
@
text
@d33 1
d373 1
a373 1
	$(INSTALL) -m 0444 $(SRCS) .dist/mdocml-$(VERSION)
@


1.351
log
@Let descriptions (bit-mask 0x100) also be mined for text.  This doubles
the database size (one record for each file), but it's critical
information.
@
text
@d326 1
a326 1
	$(INSTALL_LIB) mandoc.h $(DESTDIR)$(INCLUDEDIR)
@


1.350
log
@Don't let empty strings into the makewhatis keyword database.
@
text
@d356 1
a356 1
	$(CC) -o $@@ $(MAKEWHATIS_OBJS) libmandoc.a -ldb
@


1.349
log
@Version 1.11.3.  Here we go!
@
text
@d356 1
a356 1
	$(CC) -o $@@ $(MAKEWHATIS_OBJS) libmandoc.a
@


1.348
log
@Some small lint checks in preconv.  Also add it to the default lint rule.
@
text
@d14 2
a15 2
VERSION		 = 1.11.2
VDATE		 = 12 May 2011
@


1.347
log
@At least in theory, this patch lets us compile on Windows (which does
not have mmap(), from what I can tell).
@
text
@d301 1
a301 1
lint: llib-llibmandoc.ln llib-lmandoc.ln
@


1.346
log
@Have preconv install with mandoc.
@
text
@d111 1
d386 4
@


1.345
log
@preconv is now on encoding-recognition parity with groff.  This last
commit adds parsing of "File Variables" in the first two lines in order
to grok the encoding.  This completes groff's recognition sequence (-e,
BOM, File variables, -D, default).  I've also cleaned up the manual to
indicate this and for some general readability.

preconv is now compiled by default in the Makefile.
@
text
@d323 1
a323 1
	$(INSTALL_PROGRAM) mandoc $(DESTDIR)$(BINDIR)
d326 1
a326 1
	$(INSTALL_MAN) mandoc.1 $(DESTDIR)$(MANDIR)/man1
@


1.344
log
@Significantly improve preconv.  Allow it to recode UTF-8 characters into
the \[uNNNN] strings (taking into account big-endian archs).  Also allow
it to determine from the BOM whether it's a UTF-8 file.  Also add the
initial manual.  This has been tested over a random selection of UTF-8
documents, as

 % preconv -e utf-8 foo.1 | ./mandoc -Tlocale

where -Tlocale is allowed (-DUSE_WCHAR).

Note that we're still missing the "type" indicator that preconv accepts.
@
text
@d35 1
a35 1
all: mandoc
@


1.343
log
@It's annoying that we don't have preconv, so throw together a quick
version and let it grow in-tree.  Right now, this only supports the
Latin-1 and US-ASCII encoding.  I'll do UTF-8 next.  It's
call-compatible with GNU's preconv although I don't do fancy stuff like
BOM or header check.  This will come.  I used read.c's file-grokking
code.
@
text
@d91 2
d273 5
@


1.342
log
@Most important move in getting predefined strings entirely contained
within roff.c.  These are now grokked from a table in the roff
allocation routine and rest in the newly-created predefs.in (for
consistency with chars.in).  This is a first implementation and will
likely be optimised along with the ds/de lookup table itself.

This allows mandoc-defined predefined strings to be correctly removed or
whatnot; earlier they couldn't.  What will follow is the stripping-away
of all predefined-string crud in the other parts of the system.
@
text
@d231 5
d300 2
d343 3
a349 3
llib-lmandoc.ln: $(MANDOC_LNS)
	$(LINT) $(LINTFLAGS) -Cmandoc $(MANDOC_LNS)

d353 6
@


1.341
log
@It seems that __STDC_ISO_10646__ isn't defined even where it can be
defined, so remove the check for it and leave it up to people compiling
the software (DOWNSTREAM) to take care of this.  This will eventually
need to be fixed up with a proper non-10646 converter and so on, but
this is a simple start.  While here, strengthen then language in the
Makefile to this effect.
@
text
@d91 1
d178 1
@


1.340
log
@Add TODO entry for standalone `.' in tbl pages (pointed out by Yuri
Pankov).  Also fix typo in Makefile, same reporter.  Thanks!
@
text
@d16 5
a20 3
# If your system doesn't support multi-byte functions (specifically
# setlocale(), wcwidth(), putwchar()), then remove -DUSE_WCHAR.  You'll
# still be able to use -Tlocale, but it becomes a synonym for -Tascii.
@


1.339
log
@Locale support.  I'm checking this in to clean up fall-out in-tree, but
it looks pretty good.  Basically, the -Tlocale option propogates into
term_ascii.c, where we set locale-specific console call-backs IFF (1)
setlocale() works; (2) locale support is compiled in (see Makefile for
-DUSE_WCHAR); (3) the internal structure of wchar_t maps directly to
Unicode codepoints as defined by __STDC_ISO_10646__; and (4) the console
supports multi-byte characters.

To date, this configuration only supports GNU/Linux.  OpenBSD doesn't
export __STDC_ISO_10646__ although I'm told by stsp@@openbsd.org that it
should (it has the correct map).  Apparently FreeBSD is the same way.
NetBSD?  Don't know.  Apple also supports this, but doesn't define the
macro.  Special-casing!

Benchmark: -Tlocale incurs less than 0.2 factor overhead when run
through several thousand manuals when UTF8 output is enabled.  Native
mode (whether directly -Tascii or through no locale or whatever) is
UNCHANGED: the function callbacks are the same as before.

Note.  If the underlying system does NOT support STDC_ISO_10646, there
is a "slow" version possible with iconv or other means of flipping from
a Unicode codepoint to a wchar_t.
@
text
@d17 1
a17 1
# setlocale(), wcwidth(), putwchar()), then remove -DUSE_CHAR.  You'll
@


1.338
log
@Ooops, forgot to install makewhatis manual.
@
text
@d16 4
a19 1
CFLAGS		+= -g -DHAVE_CONFIG_H -DVERSION="\"$(VERSION)\""
@


1.337
log
@Version up!  1.11.2.  Let's go...
@
text
@d224 6
a229 1
INDEX_MANS	 = mandoc.1.html \
@


1.336
log
@Rename mandoc-db to makewhatis.  On the suggestion of schwarze@@; I agree.
Add initial version notes.
@
text
@d14 2
a15 2
VERSION		 = 1.11.1
VDATE		 = 04 April 2011
@


1.335
log
@Don't let Linux-isms creep into Makefile.
@
text
@d70 2
a71 2
		   mandoc-db.1 \
		   mandoc-db.c \
d219 2
a220 2
MANDOCDB_OBJS	 = mandoc-db.o
MANDOCDB_LNS	 = mandoc-db.ln
d222 1
a222 1
$(MANDOCDB_OBJS) $(MANDOCDB_LNS): mandoc.h mdoc.h man.h config.h
d281 2
a282 2
	rm -f mandoc-db $(MANDOCDB_OBJS)
	rm -f llib-lmandoc-db.ln $(MANDOCDB_LNS)
d325 2
a326 2
mandoc-db: $(MANDOCDB_OBJS) libmandoc.a
	$(CC) -o $@@ $(MANDOCDB_OBJS) libmandoc.a
d331 2
a332 2
llib-lmandoc-db.ln: $(MANDOCDB_LNS)
	$(LINT) $(LINTFLAGS) -Cmandoc-db $(MANDOCDB_LNS)
@


1.334
log
@Was installing libmandoc.a without mandoc.h...
@
text
@d326 1
a326 1
	$(CC) -o $@@ $(MANDOCDB_OBJS) libmandoc.a -ldb
@


1.333
log
@Move "chars" interface out of out.h and into mandoc.h.  This doesn't
change any code but for renaming functions and types to be consistent
with other mandoc.h stuff.  The reason for moving into libmandoc is that
the rendering of special characters is part of mandoc itself---not an
external part.  From mandoc(1)'s perspective, this changes nothing, but
for other utilities, it's important to have these part of libmandoc.
Note this isn't documented [yet] in mandoc.3 because there are some
parts I'd like to change around beforehand.
@
text
@d293 1
d299 1
@


1.332
log
@Make sure to create LIBDIR.  From a patch by Thomas Klausner, thanks!
@
text
@d157 1
d163 1
d169 1
a203 1
		   chars.o \
a208 1
		   chars.ln \
a212 2
chars.o chars.ln: chars.in

d324 1
a324 1
	$(CC) -o $@@ $(MANDOCDB_OBJS) libmandoc.a
@


1.331
log
@Snafu: forgetting to tar up critical files.  Pointed out by Yuri Pankov.
@
text
@d293 1
@


1.330
log
@Version up to 1.11.1: here we go!
@
text
@d58 1
d70 2
d73 1
@


1.329
log
@Roll back Linux-ism that crept into Makefile.
@
text
@d14 2
a15 2
VERSION		 = 1.10.10
VDATE		 = 20 March 2011
@


1.328
log
@Fix possible segfaults in `Lk' -T[x]html handler, which made some
assumptions about its children.  Also remove superfluous reassignment to
local variable.
@
text
@d320 1
a320 1
	$(CC) -o $@@ $(MANDOCDB_OBJS) libmandoc.a -ldb
@


1.327
log
@Have mandoc-db use config.h for strlcat().  Then create the btree
database from a directory, instead of a path.  This is because it'll
also output an index of files to that same directory.  Add documentation
to the local variable names, too.
@
text
@d320 1
a320 1
	$(CC) -o $@@ $(MANDOCDB_OBJS) libmandoc.a
@


1.326
log
@Add an initial keyword-indexer as an alternative front-end to libmandoc.a.
This will be used during BSDCan-2011, paired with a web front-end, as a
demonstrandum of semantic annotations (mdoc) versus those of man.  This
isn't linked to the build in any way but for cleaning created files.  This
code has been heavily tested under valgrind and is known to work on
GNU/Linux (needs -ldb library), all BSDs, and Mac OSX.

Please don't repost this, for the time being, as I don't want to spoil the
fun for the conference.  This utility is still constantly under development
(e.g., it will also generate a recno database of filenames and `Nd' output
so that paths needn't be hard-coded) but is mature enough to warrant being
checked in.
@
text
@d219 1
a219 1
$(MANDOCDB_OBJS) $(MANDOCDB_LNS): mandoc.h mdoc.h man.h
d319 2
a320 2
mandoc-db: mandoc-db.o libmandoc.a
	$(CC) -o $@@ mandoc-db.o libmandoc.a 
@


1.325
log
@Add lint target to Makefile.
@
text
@d216 5
d278 2
d318 4
d325 3
@


1.324
log
@Put mandocerrs and mandoclevels arrays into libmandoc with accessors
mparse_strerror() and mparse_strlevel().
@
text
@d109 5
d125 12
d143 7
d155 17
a171 12

arch.o: arch.in
att.o: att.in
lib.o: lib.in
msec.o: msec.in
st.o: st.in
vol.o: vol.in

$(LIBMAN_OBJS): libman.h
$(LIBMDOC_OBJS): libmdoc.h
$(LIBROFF_OBJS): libroff.h
$(LIBMANDOC_OBJS): mandoc.h mdoc.h man.h libmandoc.h config.h
d177 5
d188 7
d201 12
d214 1
a214 7
chars.o: chars.in

$(MANDOC_HTML_OBJS): html.h
$(MANDOC_TERM_OBJS): term.h
$(MANDOC_OBJS): main.h mandoc.h mdoc.h man.h config.h out.h

compat.o: config.h
d268 2
d272 1
d274 2
a275 1
	rm -f config.h compat.o config.log
d305 3
d311 3
@


1.323
log
@Merge man_args() into man_macro.c, the only place where it's called, and
make its return value boolean (we don't care about QWORD).  We can move
it into mdoc_macro.c because it's basically just a wrapper around
mandoc_getarg().  Then blow away man_argv.c, which is left empty.
@
text
@d235 1
a235 1
	$(INSTALL_LIB) libmandoc.a $(DESTDIR)$(LIBDIR)/
@


1.322
log
@Fix "libman" dependence.
@
text
@a59 1
		   man_argv.c \
a105 1
		   man_argv.o \
@


1.321
log
@Have the default include/lib install path end with "mandoc" to prevent
clobbering other stuff that may have the same name.
@
text
@d141 1
a141 1
$(LIBMAN_OBJS): libmdoc.h
@


1.320
log
@Note the TODO file on the website.  Also install index.html (oops).
@
text
@d20 2
a21 2
INCLUDEDIR	 = $(PREFIX)/include
LIBDIR		 = $(PREFIX)/lib
d144 1
a144 1
$(LIBMANDOC_OBJS): mandoc.h libmandoc.h config.h
d167 1
a167 1
$(MANDOC_OBJS): main.h mandoc.h config.h out.h
@


1.319
log
@Step 5: re-write Makefile and relax.  This restructures the Makefile to
do actual dependency checking for headers and to build everything nicer
(www properly depends on mandoc, etc.).

Note that the ChangeLog isn't being built any more: if people are
interested, they can visit the source-changes mailing list archive.
@
text
@d245 2
a246 1
	$(INSTALL_DATA) $(INDEX_MANS) $(PREFIX)
a247 1
	$(INSTALL_DATA) external.png style.css index.css $(PREFIX)
@


1.318
log
@Step 4: merge chars.h into out.h.  The functions in this file are
necessary to all [real] front-ends, so stop pretending it's special.
While here, add some documentation to the variable types.
@
text
@d1 8
a8 26
.SUFFIXES:	.html .xml .sgml .1 .3 .7 .md5 .tar.gz 
.SUFFIXES:	.1.txt .3.txt .7.txt
.SUFFIXES:	.1.xhtml .3.xhtml .7.xhtml
.SUFFIXES:	.1.sgml .3.sgml .7.sgml 
.SUFFIXES:	.h .h.html 
.SUFFIXES:	.1.ps .3.ps .7.ps
.SUFFIXES:	.1.pdf .3.pdf .7.pdf

PREFIX		= /usr/local
BINDIR		= $(PREFIX)/bin
INCLUDEDIR	= $(PREFIX)/include
LIBDIR		= $(PREFIX)/lib
MANDIR		= $(PREFIX)/man
EXAMPLEDIR	= $(PREFIX)/share/examples/mandoc
INSTALL		= install
INSTALL_PROGRAM	= $(INSTALL) -m 0755
INSTALL_DATA	= $(INSTALL) -m 0444
INSTALL_LIB	= $(INSTALL) -m 0644
INSTALL_MAN	= $(INSTALL_DATA)

VERSION	   = 1.10.10
VDATE	   = 20 March 2011

VFLAGS	   = -DVERSION="\"$(VERSION)\""
WFLAGS     = -W -Wall -Wstrict-prototypes -Wno-unused-parameter -Wwrite-strings
CFLAGS    += -g $(WFLAGS) $(VFLAGS) -DHAVE_CONFIG_H
d12 1
a12 1
# CFLAGS += -DOSNAME="\"OpenBSD 4.5\""
d14 206
a219 1
LINTFLAGS += $(VFLAGS)
d221 1
a221 122
ROFFLNS    = roff.ln tbl.ln tbl_opts.ln tbl_layout.ln tbl_data.ln eqn.ln

ROFFSRCS   = roff.c tbl.c tbl_opts.c tbl_layout.c tbl_data.c eqn.c

ROFFOBJS   = roff.o tbl.o tbl_opts.o tbl_layout.o tbl_data.o eqn.o

MANDOCLNS  = mandoc.ln

MANDOCSRCS = mandoc.c

MANDOCOBJS = mandoc.o

MDOCLNS	   = mdoc_macro.ln mdoc.ln mdoc_hash.ln \
	     mdoc_argv.ln mdoc_validate.ln \
	     lib.ln att.ln arch.ln vol.ln msec.ln st.ln

MDOCOBJS   = mdoc_macro.o mdoc.o mdoc_hash.o \
	     mdoc_argv.o mdoc_validate.o lib.o att.o \
	     arch.o vol.o msec.o st.o

MDOCSRCS   = mdoc_macro.c mdoc.c mdoc_hash.c \
	     mdoc_argv.c mdoc_validate.c lib.c att.c \
	     arch.c vol.c msec.c st.c

MANLNS	   = man_macro.ln man.ln man_hash.ln man_validate.ln \
	     man_argv.ln

MANOBJS	   = man_macro.o man.o man_hash.o man_validate.o \
	     man_argv.o
MANSRCS	   = man_macro.c man.c man_hash.c man_validate.c \
	     man_argv.c

MAINLNS	   = main.ln mdoc_term.ln chars.ln term.ln tree.ln \
	     compat.ln man_term.ln html.ln mdoc_html.ln \
	     man_html.ln out.ln term_ps.ln term_ascii.ln \
	     tbl_term.ln tbl_html.ln read.ln

MAINOBJS   = main.o mdoc_term.o chars.o term.o tree.o compat.o \
	     man_term.o html.o mdoc_html.o man_html.o out.o \
	     term_ps.o term_ascii.o tbl_term.o tbl_html.o read.o

MAINSRCS   = main.c mdoc_term.c chars.c term.c tree.c compat.c \
	     man_term.c html.c mdoc_html.c man_html.c out.c \
	     term_ps.c term_ascii.c tbl_term.c tbl_html.c read.c

LLNS	   = llib-llibmdoc.ln llib-llibman.ln llib-lmandoc.ln \
	     llib-llibmandoc.ln llib-llibroff.ln

LNS	   = $(MAINLNS) $(MDOCLNS) $(MANLNS) \
	     $(MANDOCLNS) $(ROFFLNS)

LIBS	   = libmdoc.a libman.a libmandoc.a libroff.a

OBJS	   = $(MDOCOBJS) $(MAINOBJS) $(MANOBJS) \
	     $(MANDOCOBJS) $(ROFFOBJS)

SRCS	   = $(MDOCSRCS) $(MAINSRCS) $(MANSRCS) \
	     $(MANDOCSRCS) $(ROFFSRCS)

DATAS	   = arch.in att.in lib.in msec.in st.in \
	     vol.in chars.in

HEADS	   = mdoc.h libmdoc.h man.h libman.h term.h \
	     libmandoc.h html.h out.h main.h \
	     mandoc.h libroff.h

GSGMLS	   = mandoc.1.sgml mdoc.7.sgml \
	     mandoc_char.7.sgml man.7.sgml mandoc.3.sgml roff.7.sgml \
	     tbl.7.sgml eqn.7.sgml

SGMLS	   = index.sgml

XHTMLS	   = mandoc.1.xhtml \
	     mandoc.3.xhtml mdoc.7.xhtml man.7.xhtml mandoc_char.7.xhtml \
	     roff.7.xhtml tbl.7.xhtml eqn.7.xhtml

HTMLS	   = ChangeLog.html index.html man.h.html mdoc.h.html \
	     mandoc.h.html mandoc.1.html \
	     mandoc.3.html mdoc.7.html man.7.html mandoc_char.7.html \
	     roff.7.html tbl.7.html eqn.7.html

PSS	   = mandoc.1.ps mandoc.3.ps mdoc.7.ps man.7.ps \
	     mandoc_char.7.ps roff.7.ps tbl.7.ps eqn.7.ps

PDFS	   = mandoc.1.pdf mandoc.3.pdf mdoc.7.pdf man.7.pdf \
	     mandoc_char.7.pdf roff.7.pdf tbl.7.pdf eqn.7.pdf

XSLS	   = ChangeLog.xsl

TEXTS	   = mandoc.1.txt mandoc.3.txt mdoc.7.txt man.7.txt \
	     mandoc_char.7.txt ChangeLog.txt \
	     roff.7.txt tbl.7.txt eqn.7.txt

EXAMPLES   = example.style.css

XMLS	   = ChangeLog.xml

STATICS	   = index.css style.css external.png

MD5S	   = mdocml-$(VERSION).md5 

TARGZS	   = mdocml-$(VERSION).tar.gz

MANS	   = mandoc.1 mdoc.7 mandoc_char.7 man.7 \
	     mandoc.3 roff.7 tbl.7 eqn.7

BINS	   = mandoc

TESTS	   = test-strlcat.c test-strlcpy.c

CONFIGS	   = config.h.pre config.h.post

DOCLEAN	   = $(BINS) $(LNS) $(LLNS) $(LIBS) $(OBJS) $(HTMLS) \
	     $(TARGZS) tags $(MD5S) $(XMLS) $(TEXTS) $(GSGMLS) \
	     config.h config.log $(PSS) $(PDFS) $(XHTMLS)

DOINSTALL  = $(SRCS) $(HEADS) Makefile $(MANS) $(SGMLS) $(STATICS) \
	     $(DATAS) $(XSLS) $(EXAMPLES) $(TESTS) $(CONFIGS)

all:	$(BINS)

lint:	$(LLNS)
d224 5
a228 9
	rm -f $(DOCLEAN)

dist:	mdocml-$(VERSION).tar.gz

www:	all $(GSGMLS) $(HTMLS) $(XHTMLS) $(TEXTS) $(MD5S) $(TARGZS) $(PSS) $(PDFS)

ps:	$(PSS)

pdf:	$(PDFS)
d230 1
a230 8
installwww: www
	$(INSTALL_DATA) $(HTMLS) $(XHTMLS) $(PSS) $(PDFS) $(TEXTS) $(STATICS) $(DESTDIR)$(PREFIX)/
	$(INSTALL_DATA) mdocml-$(VERSION).tar.gz $(DESTDIR)$(PREFIX)/snapshots/
	$(INSTALL_DATA) mdocml-$(VERSION).md5 $(DESTDIR)$(PREFIX)/snapshots/
	$(INSTALL_DATA) mdocml-$(VERSION).tar.gz $(DESTDIR)$(PREFIX)/snapshots/mdocml.tar.gz
	$(INSTALL_DATA) mdocml-$(VERSION).md5 $(DESTDIR)$(PREFIX)/snapshots/mdocml.md5

install:
d234 1
d237 1
d239 1
d243 23
a265 88
uninstall:
	rm -f $(DESTDIR)$(BINDIR)/mandoc
	rm -f $(DESTDIR)$(MANDIR)/man1/mandoc.1
	rm -f $(DESTDIR)$(MANDIR)/man7/mdoc.7
	rm -f $(DESTDIR)$(MANDIR)/man7/roff.7
	rm -f $(DESTDIR)$(MANDIR)/man7/eqn.7
	rm -f $(DESTDIR)$(MANDIR)/man7/tbl.7
	rm -f $(DESTDIR)$(MANDIR)/man7/man.7
	rm -f $(DESTDIR)$(MANDIR)/man7/mandoc_char.7
	rm -f $(DESTDIR)$(EXAMPLEDIR)/example.style.css

$(OBJS): config.h

$(LNS): config.h

man_macro.ln man_macro.o: man_macro.c libman.h

lib.ln lib.o: lib.c lib.in libmdoc.h

att.ln att.o: att.c att.in libmdoc.h

arch.ln arch.o: arch.c arch.in libmdoc.h

vol.ln vol.o: vol.c vol.in libmdoc.h

chars.ln chars.o: chars.c chars.in 

msec.ln msec.o: msec.c msec.in libmdoc.h

st.ln st.o: st.c st.in libmdoc.h

mdoc_macro.ln mdoc_macro.o: mdoc_macro.c libmdoc.h

mdoc_term.ln mdoc_term.o: mdoc_term.c term.h mdoc.h

man_hash.ln man_hash.o: man_hash.c libman.h

mdoc_hash.ln mdoc_hash.o: mdoc_hash.c libmdoc.h

mdoc.ln mdoc.o: mdoc.c libmdoc.h

man.ln man.o: man.c libman.h

main.ln main.o: main.c mdoc.h man.h 

compat.ln compat.o: compat.c 

term.ln term.o: term.c term.h man.h mdoc.h 

term_ps.ln term_ps.o: term_ps.c term.h main.h

term_ascii.ln term_ascii.o: term_ascii.c term.h main.h

html.ln html.o: html.c html.h

mdoc_html.ln mdoc_html.o: mdoc_html.c html.h mdoc.h

man_html.ln man_html.o: man_html.c html.h man.h out.h

out.ln out.o: out.c out.h

mandoc.ln mandoc.o: mandoc.c libmandoc.h

tree.ln tree.o: tree.c man.h mdoc.h

mdoc_argv.ln mdoc_argv.o: mdoc_argv.c libmdoc.h

man_argv.ln man_argv.o: man_argv.c libman.h

man_validate.ln man_validate.o: man_validate.c libman.h

mdoc_validate.ln mdoc_validate.o: mdoc_validate.c libmdoc.h

libmdoc.h: mdoc.h

ChangeLog.xml:
	cvs2cl --xml --xml-encoding iso-8859-15 -t --noxmlns -f $@@

ChangeLog.txt:
	cvs2cl -t -f $@@

ChangeLog.html: ChangeLog.xml ChangeLog.xsl
	xsltproc -o $@@ ChangeLog.xsl ChangeLog.xml

mdocml-$(VERSION).tar.gz: $(DOINSTALL)
	mkdir -p .dist/mdocml/mdocml-$(VERSION)/
	cp -f $(DOINSTALL) .dist/mdocml/mdocml-$(VERSION)/
	( cd .dist/mdocml/ && tar zcf ../../$@@ mdocml-$(VERSION)/ )
d268 1
a268 2
llib-llibmdoc.ln: $(MDOCLNS)
	$(LINT) -Clibmdoc $(MDOCLNS)
d270 15
a284 2
llib-llibman.ln: $(MANLNS)
	$(LINT) -Clibman $(MANLNS)
d286 2
a287 27
llib-llibmandoc.ln: $(MANDOCLNS)
	$(LINT) -Clibmandoc $(MANDOCLNS)

llib-llibroff.ln: $(ROFFLNS)
	$(LINT) -Clibroff $(ROFFLNS)

llib-lmandoc.ln: $(MAINLNS) llib-llibmdoc.ln llib-llibman.ln llib-llibmandoc.ln llib-llibroff.ln
	$(LINT) -Cmandoc $(MAINLNS) llib-llibmdoc.ln llib-llibman.ln llib-llibmandoc.ln llib-llibroff.ln

libmdoc.a: $(MDOCOBJS)
	$(AR) rs $@@ $(MDOCOBJS)

libman.a: $(MANOBJS)
	$(AR) rs $@@ $(MANOBJS)

libmandoc.a: $(MANDOCOBJS)
	$(AR) rs $@@ $(MANDOCOBJS)

libroff.a: $(ROFFOBJS)
	$(AR) rs $@@ $(ROFFOBJS)

mandoc: $(MAINOBJS) libroff.a libmdoc.a libman.a libmandoc.a
	$(CC) $(CFLAGS) -o $@@ $(MAINOBJS) libroff.a libmdoc.a libman.a libmandoc.a

.sgml.html:
	validate --warn $<
	sed -e "s!@@VERSION@@!$(VERSION)!" -e "s!@@VDATE@@!$(VDATE)!" $< > $@@
d290 1
a290 1
	./mandoc -Tascii -Wall,stop $< | col -b > $@@
d292 2
a293 2
.1.1.sgml .3.3.sgml .7.7.sgml:
	./mandoc -Thtml -Wall,stop -Ostyle=style.css,man=%N.%S.html,includes=%I.html $< > $@@
d296 1
a296 1
	./mandoc -Tps -Wall,stop $< > $@@
d299 1
a299 1
	./mandoc -Txhtml -Wall,stop -Ostyle=style.css,man=%N.%S.xhtml,includes=%I.html $< > $@@
d302 1
a302 1
	./mandoc -Tpdf -Wall,stop $< > $@@
d304 3
a306 21
.tar.gz.md5:
	md5 $< > $@@

.h.h.html:
	highlight -I $< >$@@

config.h: config.h.pre config.h.post
	rm -f config.log
	( cat config.h.pre; \
	echo; \
	if $(CC) $(CFLAGS) -Werror -o test-strlcat test-strlcat.c >> config.log 2>&1; then \
		echo '#define HAVE_STRLCAT'; \
		rm test-strlcat; \
	fi; \
	if $(CC) $(CFLAGS) -Werror -o test-strlcpy test-strlcpy.c >> config.log 2>&1; then \
		echo '#define HAVE_STRLCPY'; \
		rm test-strlcpy; \
	fi; \
	echo; \
	cat config.h.post \
	) > $@@
@


1.317
log
@Step 3: consolidate manuals.  The parse functions in mdoc.h, roff.h, and
man.h are now part of libmandoc.h, so remove these from their respective
manuals (they're no longer public-facing and we don't need a libmandoc.3
(yet?)).  Before that, move the juicy data (parse tree syntax) into
new-born mandoc.3.  Peck around in Makefile and index.sgml to reflect
reality.
@
text
@d97 1
a97 1
	     libmandoc.h html.h chars.h out.h main.h \
d210 1
a210 1
chars.ln chars.o: chars.c chars.in chars.h
d232 1
a232 1
term.ln term.o: term.c term.h man.h mdoc.h chars.h
d238 1
a238 1
html.ln html.o: html.c html.h chars.h
@


1.316
log
@Step 2: blow away roff.h, as all of its functions have been moved into
libmandoc.h and there's nothing left.
@
text
@d100 3
a102 3
GSGMLS	   = mandoc.1.sgml mdoc.3.sgml mdoc.7.sgml \
	     mandoc_char.7.sgml man.7.sgml man.3.sgml roff.7.sgml \
	     roff.3.sgml tbl.7.sgml eqn.7.sgml
d106 3
a108 3
XHTMLS	   = mandoc.1.xhtml mdoc.3.xhtml \
	     man.3.xhtml mdoc.7.xhtml man.7.xhtml mandoc_char.7.xhtml \
	     roff.7.xhtml roff.3.xhtml tbl.7.xhtml eqn.7.xhtml
d111 3
a113 3
	     mandoc.h.html mandoc.1.html mdoc.3.html \
	     man.3.html mdoc.7.html man.7.html mandoc_char.7.html \
	     roff.7.html roff.3.html tbl.7.html eqn.7.html
d115 2
a116 2
PSS	   = mandoc.1.ps mdoc.3.ps man.3.ps mdoc.7.ps man.7.ps \
	     mandoc_char.7.ps roff.7.ps roff.3.ps tbl.7.ps eqn.7.ps
d118 2
a119 2
PDFS	   = mandoc.1.pdf mdoc.3.pdf man.3.pdf mdoc.7.pdf man.7.pdf \
	     mandoc_char.7.pdf roff.7.pdf roff.3.pdf tbl.7.pdf eqn.7.pdf
d123 1
a123 1
TEXTS	   = mandoc.1.txt mdoc.3.txt man.3.txt mdoc.7.txt man.7.txt \
d125 1
a125 1
	     roff.7.txt roff.3.txt tbl.7.txt eqn.7.txt
d137 2
a138 2
MANS	   = mandoc.1 mdoc.3 mdoc.7 mandoc_char.7 man.7 \
	     man.3 roff.7 roff.3 tbl.7 eqn.7
@


1.315
log
@Split the document parsing sequence out of main.c and into read.c,
putting the interface into mandoc.h.  This effectively makes the
function of main.c be command-line handling, invoking the parser, and
sending its output to the output handler.  The sequence of parsing
(pfile(), pdesc(), etc.) has changed very little but for clean-up of
some state variables (curp->fd, etc.).
@
text
@d97 1
a97 1
	     libmandoc.h html.h chars.h out.h main.h roff.h \
d111 1
a111 1
	     mandoc.h.html roff.h.html mandoc.1.html mdoc.3.html \
d228 1
a228 1
main.ln main.o: main.c mdoc.h man.h roff.h
@


1.314
log
@Bumped internal version.  There will be no formal release with this: it
precedes some major structural changes for easier roll-back in the case
of errors or whatnot.
@
text
@d69 1
a69 1
	     tbl_term.ln tbl_html.ln
d73 1
a73 1
	     term_ps.o term_ascii.o tbl_term.o tbl_html.o
d77 1
a77 1
	     term_ps.c term_ascii.c tbl_term.c tbl_html.c
@


1.313
log
@Kill off mdoc_strings.c, which is now empty.  Byeeeeeeeee!
@
text
@d21 2
a22 2
VERSION	   = 1.10.9
VDATE	   = 07 January 2011
@


1.312
log
@Allow compilation with pcc, which has interesting/broken handling of -W
with missing function prototypes.  Ok joerg@@.
@
text
@d46 1
a46 1
MDOCLNS	   = mdoc_macro.ln mdoc.ln mdoc_hash.ln mdoc_strings.ln \
d50 1
a50 1
MDOCOBJS   = mdoc_macro.o mdoc.o mdoc_hash.o mdoc_strings.o \
d54 1
a54 1
MDOCSRCS   = mdoc_macro.c mdoc.c mdoc_hash.c mdoc_strings.c \
a219 2
mdoc_strings.ln mdoc_strings.o: mdoc_strings.c libmdoc.h

@


1.311
log
@Add stub for eqn.7 manual and flip it on.  Also note COMPATIBILITY issue
of how we considered .TS (etc.) macros and how the preprocessors do.
@
text
@d336 1
a336 1
	if $(CC) $(CFLAGS) -Werror -c test-strlcat.c >> config.log 2>&1; then \
d338 1
a338 1
		rm test-strlcat.o; \
d340 1
a340 1
	if $(CC) $(CFLAGS) -Werror -c test-strlcpy.c >> config.log 2>&1; then \
d342 1
a342 1
		rm test-strlcpy.o; \
@


1.310
log
@Add initial EQN support to mandoc.  This parses, then throws away, data
between EQ and EN roff blocks.  EQN is different from TBL in that data
after .EQ is unilaterally considered an equation until an .EN.  Thus,
there's no need to jump through hoops in having table spans and so on.
This is ONLY the parse code framework in libroff.  EQN is not yet passed
into the backends.
@
text
@d102 1
a102 1
	     roff.3.sgml tbl.7.sgml
d108 1
a108 1
	     roff.7.xhtml roff.3.xhtml tbl.7.xhtml
d113 1
a113 1
	     roff.7.html roff.3.html tbl.7.html
d116 1
a116 1
	     mandoc_char.7.ps roff.7.ps roff.3.ps tbl.7.ps
d119 1
a119 1
	     mandoc_char.7.pdf roff.7.pdf roff.3.pdf tbl.7.pdf
d125 1
a125 1
	     roff.7.txt roff.3.txt tbl.7.txt
d138 1
a138 1
	     man.3 roff.7 roff.3 tbl.7
d182 1
a182 1
	$(INSTALL_MAN) man.7 mdoc.7 roff.7 tbl.7 mandoc_char.7 $(DESTDIR)$(MANDIR)/man7
d190 1
@


1.309
log
@Meh, 2010->2011.  Changed the live index.html file so as not to confuse
people (although the tagged 1.10.9 release will show 2010).
@
text
@d34 1
a34 1
ROFFLNS    = roff.ln tbl.ln tbl_opts.ln tbl_layout.ln tbl_data.ln
d36 1
a36 1
ROFFSRCS   = roff.c tbl.c tbl_opts.c tbl_layout.c tbl_data.c
d38 1
a38 1
ROFFOBJS   = roff.o tbl.o tbl_opts.o tbl_layout.o tbl_data.o
@


1.308
log
@Version bits.  Here we go...
@
text
@d22 1
a22 1
VDATE	   = 07 January 2010
@


1.307
log
@Moved table stuff from roff.7 into the new tbl.7 (suggested by Jason McIntyre).

Added cross-links to tbl.7 from other manuals.
@
text
@d21 2
a22 2
VERSION	   = 1.10.8
VDATE	   = 24 December 2010
@


1.306
log
@Add skeleton for -T[x]html tbl stuff.  Also start to put in some bits about
the up-coming version, although we're not quite there yet.
@
text
@d102 1
a102 1
	     roff.3.sgml 
d108 1
a108 1
	     roff.7.xhtml roff.3.xhtml 
d113 1
a113 1
	     roff.7.html roff.3.html 
d116 1
a116 1
	     mandoc_char.7.ps roff.7.ps roff.3.ps 
d119 1
a119 1
	     mandoc_char.7.pdf roff.7.pdf roff.3.pdf 
d125 1
a125 1
	     roff.7.txt roff.3.txt 
d138 1
a138 1
	     man.3 roff.7 roff.3 
d182 1
a182 1
	$(INSTALL_MAN) man.7 mdoc.7 roff.7 mandoc_char.7 $(DESTDIR)$(MANDIR)/man7
d190 1
@


1.305
log
@Turn on -Tascii tbl printing.  The output still has some issues---I'm
not sure whether it's in the header calculation or term.c squashing
spaces or whatever, but let's get this in for general testing as soon as
possible.
@
text
@d69 1
a69 1
	     tbl_term.ln
d73 1
a73 1
	     term_ps.o term_ascii.o tbl_term.o
d77 1
a77 1
	     term_ps.c term_ascii.c tbl_term.c
@


1.304
log
@Initial check-in of table data-row processing.  For the time being, this
parses table data then throws it away immediately.  It does not yet try
to cross-check data rows against layout or anything.  This copied more
or less completely from tbl.bsd.lv.
@
text
@d68 2
a69 1
	     man_html.ln out.ln term_ps.ln term_ascii.ln
d73 1
a73 1
	     term_ps.o term_ascii.o
d77 1
a77 1
	     term_ps.c term_ascii.c
@


1.303
log
@Merge, with considerable changes, tbl.bsd.lv's layout-handling code.
@
text
@d34 1
a34 1
ROFFLNS    = roff.ln tbl.ln tbl_opts.ln tbl_layout.ln
d36 1
a36 1
ROFFSRCS   = roff.c tbl.c tbl_opts.c tbl_layout.c
d38 1
a38 1
ROFFOBJS   = roff.o tbl.o tbl_opts.o tbl_layout.o
@


1.302
log
@Adding initial options processing (not hooked into parse yet).  This is
more or less copied from tbl.bsd.lv and still needs integration with the
general mandoc framework, e.g., with error messages.
@
text
@d34 1
a34 1
ROFFLNS    = roff.ln tbl.ln tbl_opts.ln
d36 1
a36 1
ROFFSRCS   = roff.c tbl.c tbl_opts.c
d38 1
a38 1
ROFFOBJS   = roff.o tbl.o tbl_opts.o
@


1.301
log
@Initial tbl framework.  Parse point is in libroff, which keeps a
reference to a current tbl parse and routes ALL text into the tbl parse
after stripping reserved words and making block-level pre-processing
(e.g., `ig').  This is consistent with an analysis of embedded `TS/TE'
in manuals with sprinkled -mdoc, roff, and -man macros.

Fact of a parse is exposed to main.c by a return value (ROFF_TBL), which
will trigger main.c to add a foreign parsed body to the -mdoc or -man
parse stream.  This interface isn't in yet, but will follow the
parse-text functions in both libraries.  I put this login in main.c
because I don't want libroff calling directly into libmdoc or libman.

As a consequence, a parsed row can be pushed directly into any -mdoc or
-man context (put a `Bd -literal -offset indent' into a `TE/TS' block to
see why this is necessary).  It will then absorb formatting cues in the
front-ends.

A note on naming.  I decided on libroff.h instead of tbl.h because this
is purely within the roff layer.  Separate tbl implementations will
need, then, to interface with libroff.  This is "how it should be"
because tbl is tightly linked with roff in terms of `ds' and other
formatting macros, as well as, of course, special characters and other
roffisms.
@
text
@d34 1
a34 1
ROFFLNS    = roff.ln tbl.ln
d36 1
a36 1
ROFFSRCS   = roff.c tbl.c
d38 1
a38 1
ROFFOBJS   = roff.o tbl.o
@


1.300
log
@Have Makefile build XHTML files too.
@
text
@d34 1
a34 1
ROFFLNS    = roff.ln
d36 1
a36 1
ROFFSRCS   = roff.c
d38 1
a38 1
ROFFOBJS   = roff.o
d97 1
a97 1
	     mandoc.h
@


1.299
log
@Apparently the U tag is deprecated, so use a SPAN instead (blah).  Bump
version date for release.
@
text
@d105 4
d147 1
a147 1
	     config.h config.log $(PSS) $(PDFS)
d161 1
a161 1
www:	all $(GSGMLS) $(HTMLS) $(TEXTS) $(MD5S) $(TARGZS) $(PSS) $(PDFS)
d168 1
a168 1
	$(INSTALL_DATA) $(HTMLS) $(PSS) $(PDFS) $(TEXTS) $(STATICS) $(DESTDIR)$(PREFIX)/
@


1.298
log
@Added last version notes and bumped version number and date.
@
text
@d22 1
a22 1
VDATE	   = 23 December 2010
@


1.297
log
@Build xhtml files for www site exemplaria.
@
text
@d21 2
a22 2
VERSION	   = 1.10.7
VDATE	   = 6 December 2010
@


1.296
log
@Tag an internal release, 1.10.7, that marks being in sync with OpenBSD's
changes these last months (less tbl).  There are still some issues that
require thought, but this extends beyond synchronisation.

This WILL NOT be pushed to the main site; it's merely a logical tag so
that there's a common fall-back in future changes.

Note that the TODO file is NOT up to date.  This is ok since the tag is
purely internal.
@
text
@d3 1
d313 3
@


1.295
log
@Kill man_action.c.
@
text
@d20 2
a21 2
VERSION	   = 1.10.6
VDATE	   = 27 September 2010
@


1.294
log
@mdoc_action.c is no more.  Attic it and remove it from the Makefile.
Remove references to MDOC_ACTED (it was only assertions) and the pre-
and post-action functions.
@
text
@d58 1
a58 1
	     man_action.ln man_argv.ln
d61 1
a61 1
	     man_action.o man_argv.o
d63 1
a63 1
	     man_action.c man_argv.c
@


1.293
log
@Cleaned up library manuals: removed old escapes, added EXAMPLES, stripped
out some superfluous stuff.
@
text
@d46 1
a46 1
	     mdoc_argv.ln mdoc_validate.ln mdoc_action.ln \
d50 1
a50 1
	     mdoc_argv.o mdoc_validate.o mdoc_action.o lib.o att.o \
d54 1
a54 1
	     mdoc_argv.c mdoc_validate.c mdoc_action.c lib.c att.c \
a251 2
mdoc_action.ln mdoc_action.o: mdoc_action.c libmdoc.h

@


1.292
log
@Prepping for version.
@
text
@d1 6
a6 1
.SUFFIXES:	.html .xml .sgml .1 .3 .7 .md5 .tar.gz .1.txt .3.txt .7.txt .1.sgml .3.sgml .7.sgml .h .h.html .1.ps .3.ps .7.ps .1.pdf .3.pdf .7.pdf
d100 1
a100 1
	     roff.3.sgml
d107 1
a107 1
	     roff.7.html roff.3.html
d110 1
a110 1
	     mandoc_char.7.ps roff.7.ps roff.3.ps
d113 1
a113 1
	     mandoc_char.7.pdf roff.7.pdf roff.3.pdf
d119 1
a119 1
	     roff.7.txt roff.3.txt
d132 1
a132 1
	     man.3 roff.7 roff.3
@


1.291
log
@Fixed Makefile auto-generation of manuals not to use -fstrict and [old] -Werror.
@
text
@d15 2
a16 2
VERSION	   = 1.10.5
VDATE	   = 27 July 2010
@


1.290
log
@Add PDF files to www.  We also show text and ps, just to show off.
@
text
@d301 1
a301 1
	./mandoc -Tascii -Wall,error -fstrict $< | col -b > $@@
d304 1
a304 1
	./mandoc -Thtml -Wall,error -fstrict -Ostyle=style.css,man=%N.%S.html,includes=%I.html $< > $@@
d307 1
a307 1
	./mandoc -Tps -Wall,error -fstrict $< > $@@
d310 1
a310 1
	./mandoc -Tpdf -Wall,error -fstrict $< > $@@
@


1.289
log
@Get version bits in: 1.10.5.
@
text
@d1 1
a1 1
.SUFFIXES:	.html .xml .sgml .1 .3 .7 .md5 .tar.gz .1.txt .3.txt .7.txt .1.sgml .3.sgml .7.sgml .h .h.html .1.ps .3.ps .7.ps
a27 6
MANDOCFLAGS = -Wall -fstrict

MANDOCHTML = -Thtml -Ostyle=style.css,man=%N.%S.html,includes=%I.html

MANDOCPS   = -Tps

d107 3
d137 1
a137 1
	     config.h config.log $(PSS)
d151 1
a151 1
www:	all $(GSGMLS) $(HTMLS) $(TEXTS) $(MD5S) $(TARGZS) $(PSS)
d155 2
d158 1
a158 1
	$(INSTALL_DATA) $(HTMLS) $(PSS) $(TEXTS) $(STATICS) $(DESTDIR)$(PREFIX)/
d301 1
a301 1
	./mandoc $(MANDOCFLAGS) $< | col -b > $@@
d304 1
a304 1
	./mandoc $(MANDOCFLAGS) $(MANDOCHTML) $< > $@@
d307 4
a310 1
	./mandoc $(MANDOCFLAGS) $(MANDOCPS) $< > $@@
@


1.288
log
@Pre-tag checkin of release bits and shortlist.
@
text
@d15 2
a16 2
VERSION	   = 1.10.4
VDATE	   = 12 July 2010
@


1.287
log
@Re-constitution of `ds' symbol processing.  First, push the
roff_getstr() family of functions into roff.c with the "first_string"
directly in struct roff.  Second, pre-process each line for reserved
words in libroff, splicing and re-running a line if it has one (this
allows defined symbols to be macros).  Remove term.c's invocation of the
roff_getstrn() function.  Removed function documentation in roff.3 and
added roff.7 `ds' documentation.
@
text
@d15 2
a16 2
VERSION	   = 1.10.3
VDATE	   = 29 June 2010
@


1.286
log
@Revert Makefile to using mandoc.c instead of libmandoc.c.  Remove
newborn libmandoc.c.

While here, remove superfluous dep of libman on mandoc.c.
@
text
@d97 1
a97 1
	     mandoc.h regs.h
@


1.285
log
@Renamed mandoc.c to libmandoc.c.  This is in the efforts of getting a
cleaner namespace for functions across the entire system (mandoc.h:
getting parsed-string values, or declarations necessary for the AST
data), and compiler functions (libmandoc.h: back-end functions and
declarations).
@
text
@d40 1
a40 1
MANDOCLNS  = libmandoc.ln
d42 1
a42 1
MANDOCSRCS = libmandoc.c
d44 1
a44 1
MANDOCOBJS = libmandoc.o
d64 1
a64 1
	     man_action.c libmandoc.c man_argv.c
d236 1
a236 1
libmandoc.ln libmandoc.o: libmandoc.c libmandoc.h
@


1.284
log
@Inter-release tag.
@
text
@d40 1
a40 1
MANDOCLNS  = mandoc.ln
d42 1
a42 1
MANDOCSRCS = mandoc.c
d44 1
a44 1
MANDOCOBJS = mandoc.o
d64 1
a64 1
	     man_action.c mandoc.c man_argv.c
d236 1
a236 1
mandoc.ln mandoc.o: mandoc.c libmandoc.h
@


1.283
log
@Downstream maintainers: this removes UGLY!  I don't want diverging
functionality and UGLY works quite well thanks to schwarze@@'s careful
attention.

This also backs out function-prototype changes for struct regset,
instead stuffing a pointer to the regset directly into struct
mdoc/man/roff.
@
text
@d15 2
a16 2
VERSION	   = 1.10.2
VDATE	   = 19 June 2010
@


1.282
log
@First step of adding register support.  This is inspired by a significant
patch by schwarze@@.  This commit adds support to libroff parsing `nr'
into register set defined in regs.h.  This will propogate into libmdoc
and libman in later commits.
@
text
@a25 4
# Unset this if you don't want Xo/Xc allowing split `It' lines, which
# breaks symmetry.
CFLAGS	  += -DUGLY

@


1.281
log
@Fix slipped in after tag: install PS files with installwww.
@
text
@d101 1
a101 1
	     mandoc.h
@


1.280
log
@Version notes for 1.10.2.
@
text
@d163 1
a163 1
	$(INSTALL_DATA) $(HTMLS) $(TEXTS) $(STATICS) $(DESTDIR)$(PREFIX)/
@


1.279
log
@Broke ascii_*() functions into term_ascii.c

Made low-level engine functions into function pointers.
@
text
@d15 2
a16 2
VERSION	   = 1.10.1
VDATE	   = 07 June 2010
@


1.278
log
@No functionality changes: just restructuring.  Deprecated
terminal_free() in favour of ps_free() and ascii_free().  Moved ps_*()
functions into term_ps.c so that they don't clutter up term.c.
@
text
@d72 1
a72 1
	     man_html.ln out.ln term_ps.ln
d76 1
a76 1
	     term_ps.o
d80 1
a80 1
	     term_ps.c
d230 2
@


1.277
log
@First check-in of PostScript output.  This does not change any logic
within term.c, but does add a small shim over putchar() that switches on
the output engine.  Prints, for this initial version, only monospace and
without font decorations.  It's a start.
@
text
@d72 1
a72 1
	     man_html.ln out.ln
d75 2
a76 1
	     man_term.o html.o mdoc_html.o man_html.o out.o
d79 2
a80 1
	     man_term.c html.c mdoc_html.c man_html.c out.c
d228 2
@


1.276
log
@Added version bits for 1.10.1.

Spell-checked manuals.
@
text
@d1 1
a1 1
.SUFFIXES:	.html .xml .sgml .1 .3 .7 .md5 .tar.gz .1.txt .3.txt .7.txt .1.sgml .3.sgml .7.sgml .h .h.html
d36 2
d112 3
d142 1
a142 1
	     config.h config.log
d154 1
a154 2
cleanlint:
	rm -f $(LNS) $(LLNS)
d156 1
a156 2
cleanhtml:
	rm -f $(HTMLS) $(GSGMLS)
d158 1
a158 3
dist:	mdocml-$(VERSION).tar.gz

www:	all $(GSGMLS) $(HTMLS) $(TEXTS) $(MD5S) $(TARGZS)
d305 3
@


1.275
log
@Remove manuals.7 (see http://manpages.bsd.lv).
@
text
@d16 1
a16 1
VDATE	   = 03 June 2010
@


1.274
log
@Version bits for 1.10.1.
@
text
@d99 1
a99 1
GSGMLS	   = mandoc.1.sgml mdoc.3.sgml mdoc.7.sgml manuals.7.sgml \
d108 1
a108 1
	     manuals.7.html roff.7.html roff.3.html
d113 1
a113 1
	     mandoc_char.7.txt manuals.7.txt ChangeLog.txt \
d126 1
a126 1
MANS	   = mandoc.1 mdoc.3 mdoc.7 manuals.7 mandoc_char.7 man.7 \
@


1.273
log
@Bump 1.10.0 version in Makefile.
@
text
@d15 2
a16 2
VERSION	   = 1.10.0
VDATE	   = 29 May 2010
@


1.272
log
@Added roff.3, which documents the roff parser interface.

Small fix in mdoc.3 and man.3 pointing to old mdoc_cb and man_cb.

Fix in Makefile adding mandoc.h to HEADS.

Collapsed all HTML files into HTMLS variable (too confusing otherwise).

Removed "htmls" command from Makefile (only I used it and it's just
taking up space).
@
text
@d15 2
a16 2
VERSION	   = 1.9.25
VDATE	   = 13 May 2010
@


1.271
log
@Documented ie/el.
Installing roff.7 and added it to index.sgml.
Small fix for `D1' and `Bd' in -Thtml.
@
text
@d96 2
a97 1
	     libmandoc.h html.h chars.h out.h main.h roff.h
d100 2
a101 1
	     mandoc_char.7.sgml man.7.sgml man.3.sgml roff.7.sgml
d105 4
a108 1
HTMLS	   = ChangeLog.html index.html man.h.html mdoc.h.html
a111 3
GHTMLS	   = mandoc.1.html mdoc.3.html man.3.html mdoc.7.html \
	     man.7.html mandoc_char.7.html manuals.7.html roff.7.html

d113 2
a114 1
	     mandoc_char.7.txt manuals.7.txt ChangeLog.txt roff.7.txt
d127 1
a127 1
	     man.3 roff.7
d137 1
a137 1
	     $(GHTMLS) config.h config.log
d153 1
a153 1
	rm -f $(HTMLS) $(GSGMLS) $(GHTMLS)
d157 1
a157 3
www:	all $(GSGMLS) $(GHTMLS) $(HTMLS) $(TEXTS) $(MD5S) $(TARGZS)

htmls:	all $(GSGMLS) $(GHTMLS)
d160 1
a160 1
	$(INSTALL_DATA) $(GHTMLS) $(HTMLS) $(TEXTS) $(STATICS) $(DESTDIR)$(PREFIX)/
@


1.270
log
@Use a default prefix of /usr/local. Honour DESTDIR for install targets.
@
text
@d99 1
a99 1
	     mandoc_char.7.sgml man.7.sgml man.3.sgml
d108 1
a108 1
	     man.7.html mandoc_char.7.html manuals.7.html
d111 1
a111 1
	     mandoc_char.7.txt manuals.7.txt ChangeLog.txt
d123 2
a124 2
MANS	   = mandoc.1 mdoc.3 mdoc.7 manuals.7 mandoc_char.7 \
	     man.7 man.3
d172 1
a172 1
	$(INSTALL_MAN) man.7 mdoc.7 mandoc_char.7 $(DESTDIR)$(MANDIR)/man7
d179 1
@


1.269
log
@Initial roff shim skeleton in place.
@
text
@d3 1
d159 5
a163 5
	$(INSTALL_DATA) $(GHTMLS) $(HTMLS) $(TEXTS) $(STATICS) $(PREFIX)/
	$(INSTALL_DATA) mdocml-$(VERSION).tar.gz $(PREFIX)/snapshots/
	$(INSTALL_DATA) mdocml-$(VERSION).md5 $(PREFIX)/snapshots/
	$(INSTALL_DATA) mdocml-$(VERSION).tar.gz $(PREFIX)/snapshots/mdocml.tar.gz
	$(INSTALL_DATA) mdocml-$(VERSION).md5 $(PREFIX)/snapshots/mdocml.md5
d166 8
a173 8
	mkdir -p $(BINDIR)
	mkdir -p $(EXAMPLEDIR)
	mkdir -p $(MANDIR)/man1
	mkdir -p $(MANDIR)/man7
	$(INSTALL_PROGRAM) mandoc $(BINDIR)
	$(INSTALL_MAN) mandoc.1 $(MANDIR)/man1
	$(INSTALL_MAN) man.7 mdoc.7 mandoc_char.7 $(MANDIR)/man7
	$(INSTALL_DATA) example.style.css $(EXAMPLEDIR)
d176 6
a181 6
	rm -f $(BINDIR)/mandoc
	rm -f $(MANDIR)/man1/mandoc.1
	rm -f $(MANDIR)/man7/mdoc.7
	rm -f $(MANDIR)/man7/man.7
	rm -f $(MANDIR)/man7/mandoc_char.7
	rm -f $(EXAMPLEDIR)/example.style.css
@


1.268
log
@Making room for libroff in Makefile: properly split out libmandoc.a.
@
text
@d32 1
d35 6
d78 1
a78 1
	     llib-llibmandoc.ln
d80 2
a81 1
LNS	   = $(MAINLNS) $(MDOCLNS) $(MANLNS) $(MANDOCLNS)
d83 1
a83 1
LIBS	   = libmdoc.a libman.a libmandoc.a
d85 2
a86 1
OBJS	   = $(MDOCOBJS) $(MAINOBJS) $(MANOBJS) $(MANDOCOBJS)
d88 2
a89 1
SRCS	   = $(MDOCSRCS) $(MAINSRCS) $(MANSRCS) $(MANDOCSRCS)
d95 1
a95 1
	     libmandoc.h html.h chars.h out.h main.h
d216 1
a216 1
main.ln main.o: main.c mdoc.h
d270 5
a274 2
llib-lmandoc.ln: $(MAINLNS) llib-llibmdoc.ln llib-llibman.ln llib-llibmandoc.ln
	$(LINT) -Cmandoc $(MAINLNS) llib-llibmdoc.ln llib-llibman.ln llib-llibmandoc.ln
d285 5
a289 2
mandoc: $(MAINOBJS) libmdoc.a libman.a libmandoc.a
	$(CC) $(CFLAGS) -o $@@ $(MAINOBJS) libmdoc.a libman.a libmandoc.a
@


1.267
log
@Documented version bits.
@
text
@d34 6
d42 2
a43 2
	     lib.ln att.ln arch.ln vol.ln msec.ln st.ln \
	     mandoc.ln
d46 2
a47 1
	     arch.o vol.o msec.o st.o mandoc.o
d50 1
a50 1
	     arch.c vol.c msec.c st.c mandoc.c
d53 2
a54 1
	     man_action.ln mandoc.ln man_argv.ln
d56 1
a56 1
	     man_action.o mandoc.o man_argv.o
d63 1
d66 1
d70 11
a80 5
LLNS	   = llib-llibmdoc.ln llib-llibman.ln llib-lmandoc.ln
LNS	   = $(MAINLNS) $(MDOCLNS) $(MANLNS)
LIBS	   = libmdoc.a libman.a
OBJS	   = $(MDOCOBJS) $(MAINOBJS) $(MANOBJS)
SRCS	   = $(MDOCSRCS) $(MAINSRCS) $(MANSRCS)
d83 1
d86 1
d89 1
d91 1
d93 1
d95 1
d98 1
d101 1
d103 1
d105 1
d107 1
d109 1
d111 1
d114 1
d116 1
d118 1
d120 1
d124 1
d220 2
d257 5
a261 2
llib-lmandoc.ln: $(MAINLNS) llib-llibmdoc.ln
	$(LINT) -Cmandoc $(MAINLNS) llib-llibmdoc.ln
d269 5
a273 2
mandoc: $(MAINOBJS) libmdoc.a libman.a
	$(CC) $(CFLAGS) -o $@@ $(MAINOBJS) libmdoc.a libman.a
@


1.266
log
@Use "=" instead of "?=" for compatibility.
@
text
@d14 2
a15 2
VERSION	   = 1.9.24
VDATE	   = 09 May 2010
@


1.265
log
@Getting version ready.
@
text
@d8 1
a8 1
INSTALL		?= install
@


1.264
log
@margerr -> margserr (getting ready for margverr).
@
text
@d14 2
a15 2
VERSION	   = 1.9.23
VDATE	   = 07 April 2010
@


1.263
log
@Protection against running lookup() against quoted words.
@
text
@d25 3
a27 3
# Specify this if you want to accept Xo/Xc macros extending the head of
# block full-implicit macros.
# CFLAGS += -DUGLY
@


1.262
log
@Noting version.
@
text
@d8 4
a11 3
INSTALL_PROGRAM	= install -m 0755
INSTALL_DATA	= install -m 0444
INSTALL_LIB	= install -m 0644
d88 1
a88 1
CLEAN	   = $(BINS) $(LNS) $(LLNS) $(LIBS) $(OBJS) $(HTMLS) \
d91 1
a91 1
INSTALL	   = $(SRCS) $(HEADS) Makefile $(MANS) $(SGMLS) $(STATICS) \
d99 1
a99 1
	rm -f $(CLEAN)
d114 5
a118 5
	install -m 0444 $(GHTMLS) $(HTMLS) $(TEXTS) $(STATICS) $(PREFIX)/
	install -m 0444 mdocml-$(VERSION).tar.gz $(PREFIX)/snapshots/
	install -m 0444 mdocml-$(VERSION).md5 $(PREFIX)/snapshots/
	install -m 0444 mdocml-$(VERSION).tar.gz $(PREFIX)/snapshots/mdocml.tar.gz
	install -m 0444 mdocml-$(VERSION).md5 $(PREFIX)/snapshots/mdocml.md5
d209 1
a209 1
mdocml-$(VERSION).tar.gz: $(INSTALL)
d211 1
a211 1
	cp -f $(INSTALL) .dist/mdocml/mdocml-$(VERSION)/
@


1.261
log
@Added mandoc_char.7 to installed manuals (noted by Joerg Sonnenberger).
@
text
@d13 2
a14 2
VERSION	   = 1.9.22
VDATE	   = 31 March 2010
@


1.260
log
@Added generation of mdoc.h.html and man.h.html as linked from generated mdoc.3.html and man.3.html, respectively.
@
text
@d126 1
a126 1
	$(INSTALL_MAN) man.7 mdoc.7 $(MANDIR)/man7
d134 1
@


1.259
log
@Added new version information.  Fixing up Makefile a bit.
@
text
@d1 1
a1 1
.SUFFIXES:	.html .xml .sgml .1 .3 .7 .md5 .tar.gz .1.txt .3.txt .7.txt .1.sgml .3.sgml .7.sgml
d71 1
a71 1
HTMLS	   = ChangeLog.html index.html
d244 3
@


1.258
log
@Fixed fatal bug in Xo/Xc patch that caused segfaults with last-child explicit-scope macros.
@
text
@d13 1
a13 1
VERSION	   = 1.9.21
d16 1
a16 1
VFLAGS     = -DVERSION="\"$(VERSION)\"" -DHAVE_CONFIG_H  -DUGLY
d18 10
a27 2
CFLAGS    += -g $(VFLAGS) $(WFLAGS)
#CFLAGS	  += -DOSNAME="\"OpenBSD 4.5\""
@


1.257
log
@Re-adjusting UGLY tags.
Fixed removed assignment of type.
Removed superfluous checks of mdoc_argflags (from days when comments were a macro tag).
@
text
@d16 1
a16 1
VFLAGS     = -DVERSION="\"$(VERSION)\"" -DHAVE_CONFIG_H 
@


1.256
log
@Macro types enum-ated (enum mdoct) (for easier debugging in gdb of "tok" values).
Initial check-in of Ingo Schwarze's patch for Xo/Xc handling (in blocks ifdef'd "UGLY").
Put Oc-close-Op parts into UGLY ifdef blocks.
@
text
@d16 1
a16 1
VFLAGS     = -DVERSION="\"$(VERSION)\"" -DHAVE_CONFIG_H -DUGLY
@


1.255
log
@Version (bug-fix).
@
text
@d16 1
a16 1
VFLAGS     = -DVERSION="\"$(VERSION)\"" -DHAVE_CONFIG_H
@


1.254
log
@Modified in_line_eoln() to handle leading punctuation.
@
text
@d13 2
a14 2
VERSION	   = 1.9.20
VDATE	   = 30 March 2010
@


1.253
log
@Fixed re-adjustment of scope in exiting roff instructions (libman).
Added title-case check for (libman).
Fixed premature closure of roff instruction scope (libman).
Added documentation of ignored roff macros to man(3).
@
text
@d13 2
a14 2
VERSION	   = 1.9.18
VDATE	   = 27 March 2010
@


1.252
log
@Cleaned up version info.
@
text
@d13 2
a14 2
VERSION	   = 1.9.17
VDATE	   = 22 March 2010
@


1.251
log
@Updated web-site with new version.
Allowed double-rule entries in Makefile (clean-up).
@
text
@d13 1
a13 1
VERSION	   = 1.9.16
@


1.250
log
@Added news item for new version.
Version: 1.9.15.
@
text
@d13 2
a14 2
VERSION	   = 1.9.15
VDATE	   = 18 February 2010
d132 1
a132 2
man_macro.ln: man_macro.c libman.h
man_macro.o: man_macro.c libman.h
d134 1
a134 2
lib.ln: lib.c lib.in libmdoc.h
lib.o: lib.c lib.in libmdoc.h
d136 1
a136 2
att.ln: att.c att.in libmdoc.h
att.o: att.c att.in libmdoc.h
d138 1
a138 2
arch.ln: arch.c arch.in libmdoc.h
arch.o: arch.c arch.in libmdoc.h
d140 1
a140 2
vol.ln: vol.c vol.in libmdoc.h
vol.o: vol.c vol.in libmdoc.h
d142 1
a142 2
chars.ln: chars.c chars.in chars.h
chars.o: chars.c chars.in chars.h
d144 1
a144 2
msec.ln: msec.c msec.in libmdoc.h
msec.o: msec.c msec.in libmdoc.h
d146 1
a146 2
st.ln: st.c st.in libmdoc.h
st.o: st.c st.in libmdoc.h
d148 1
a148 2
mdoc_macro.ln: mdoc_macro.c libmdoc.h
mdoc_macro.o: mdoc_macro.c libmdoc.h
d150 1
a150 2
mdoc_term.ln: mdoc_term.c term.h mdoc.h
mdoc_term.o: mdoc_term.c term.h mdoc.h
d152 1
a152 2
mdoc_strings.ln: mdoc_strings.c libmdoc.h
mdoc_strings.o: mdoc_strings.c libmdoc.h
d154 1
a154 2
man_hash.ln: man_hash.c libman.h
man_hash.o: man_hash.c libman.h
d156 1
a156 2
mdoc_hash.ln: mdoc_hash.c libmdoc.h
mdoc_hash.o: mdoc_hash.c libmdoc.h
d158 1
a158 2
mdoc.ln: mdoc.c libmdoc.h
mdoc.o: mdoc.c libmdoc.h
d160 1
a160 2
man.ln: man.c libman.h
man.o: man.c libman.h
d162 1
a162 2
main.ln: main.c mdoc.h
main.o: main.c mdoc.h
d164 1
a164 2
compat.ln: compat.c 
compat.o: compat.c
d166 1
a166 2
term.ln: term.c term.h man.h mdoc.h chars.h
term.o: term.c term.h man.h mdoc.h chars.h
d168 1
a168 2
html.ln: html.c html.h chars.h
html.o: html.c html.h chars.h
d170 1
a170 2
mdoc_html.ln: mdoc_html.c html.h mdoc.h
mdoc_html.o: mdoc_html.c html.h mdoc.h
d172 1
a172 2
man_html.ln: man_html.c html.h man.h out.h
man_html.o: man_html.c html.h man.h out.h
d174 1
a174 2
out.ln: out.c out.h
out.o: out.c out.h
d176 1
a176 2
tree.ln: tree.c man.h mdoc.h
tree.o: tree.c man.h mdoc.h
d178 1
a178 2
mdoc_argv.ln: mdoc_argv.c libmdoc.h
mdoc_argv.o: mdoc_argv.c libmdoc.h
d180 1
a180 2
man_argv.ln: man_argv.c libman.h
man_argv.o: man_argv.c libman.h
d182 1
a182 2
man_validate.ln: man_validate.c libman.h
man_validate.o: man_validate.c libman.h
d184 1
a184 2
mdoc_validate.ln: mdoc_validate.c libmdoc.h
mdoc_validate.o: mdoc_validate.c libmdoc.h
d186 1
a186 2
mdoc_action.ln: mdoc_action.c libmdoc.h
mdoc_action.o: mdoc_action.c libmdoc.h
@


1.249
log
@Fixed Makefile for `make lint' dep. on config.h
Added -Txhtml for XHTML output (minimal increase to programme logic).  Because groff has it and it bothers me that we don't.
@
text
@d13 2
a14 2
VERSION	   = 1.9.15-pre2
VDATE	   = 02 January 2010
@


1.248
log
@Version (pre): 1.9.15-pre2
@
text
@d130 2
@


1.247
log
@CFLAGS need -Werror to make the strlcpy/strlcat check work.
@
text
@d13 2
a14 2
VERSION	   = 1.9.14
VDATE	   = 16 November 2009
@


1.246
log
@Big check-in of compatibility layer.  This should work on most major architectures. Thanks to Joerg Sonnenberger.
@
text
@d266 1
a266 1
	if $(CC) $(CFLAGS) -c test-strlcat.c >> config.log 2>&1; then \
d270 1
a270 1
	if $(CC) $(CFLAGS) -c test-strlcpy.c >> config.log 2>&1; then \
@


1.245
log
@Fixed handling of exampledir (pointed out by Ulrich Sporlein, forgotten, discovered again).
@
text
@d16 3
a18 3
VFLAGS     = -DVERSION="\"$(VERSION)\""
CFLAGS    += -W -Wall -Wstrict-prototypes -Wno-unused-parameter -Wwrite-strings -g
CFLAGS    += $(VFLAGS)
d77 2
d81 1
a81 1
	     $(GHTMLS)
d83 1
a83 1
	     $(DATAS) $(XSLS) $(EXAMPLES)
d128 2
d261 16
@


1.244
log
@Version: 1.9.14.
@
text
@d111 1
d116 1
a116 1
	$(INSTALL_MAN) mdoc.7 $(MANDIR)/man7
d123 2
@


1.243
log
@More clarification in manuals.  Added per-OUTPUT section in mandoc.1.
@
text
@d13 2
a14 2
VERSION	   = 1.9.13
VDATE	   = 02 November 2009
@


1.242
log
@Version: 1.9.13.
@
text
@d7 1
d116 1
@


1.241
log
@Finished section-by-section definitions in man.7 (will be used as baseline for mdoc.7).
@
text
@d12 2
a13 2
VERSION	   = 1.9.12
VDATE	   = 31 October 2009
@


1.240
log
@Fixed in make dist (in version 1.9.12).
@
text
@d62 1
d64 2
a65 3
HTMLS	   = index.html mandoc.1.html mdoc.3.html ChangeLog.html \
	     man.3.html mdoc.7.html man.7.html mandoc_char.7.html \
	     manuals.7.html
d77 2
a78 1
	     $(TARGZS) tags $(MD5S) $(XMLS) $(TEXTS) $(GSGMLS)
d93 1
a93 1
	rm -f $(HTML) $(GSGMLS)
d97 3
a99 1
www:	all $(HTMLS) $(TEXTS) $(MD5S) $(TARGZS)
d102 1
a102 1
	install -m 0444 $(HTMLS) $(TEXTS) $(STATICS) $(PREFIX)/
@


1.239
log
@Version: 1.9.12.
@
text
@d61 1
a61 1
SGMLS	   = index.sgml $(GSGMLS)
@


1.238
log
@Using "--warn" for validate, plus some accessibility fixes.
@
text
@d12 2
a13 2
VERSION	   = 1.9.11
VDATE	   = 26 October 2009
@


1.237
log
@Fixed `sp', `br', `Pp', etc. so as not to have an empty div (-Thtml, -man, -mdoc).
Made html_idcat be completely correct (messy standard) (-Thtml).
Fixed warnings about -ohang and -item lists (-Thtml, -mdoc).
Fixed typo in index.sgml.
@
text
@d238 1
a238 1
	validate $<
@


1.236
log
@Fix to segfault in ordering Rs blocks (d'oh!).
Version: 1.9.11.
@
text
@d91 3
d238 1
a238 1
	#validate $<
@


1.235
log
@Version: 1.9.10.
@
text
@d12 1
a12 1
VERSION	   = 1.9.10
@


1.234
log
@Changed `-o' to `-O' for clarity.  THIS BREAKS UTILITIES DEPENDING ON -o!
@
text
@d12 2
a13 2
VERSION	   = 1.9.9
VDATE	   = 21 October 2009
@


1.233
log
@Added ability to set OS name at compile-time with -DOSNAME="\"foo\"".
@
text
@d22 1
a22 1
MANDOCHTML = -Thtml -ostyle=style.css,man=%N.%S.html,includes=%I.html
@


1.232
log
@Temporarily turned off validation (mandoc -Thtml needs URI encoding!).
Aesthetic fixes in index.sgml.
@
text
@d15 1
a15 1
VFLAGS     = -DVERSION=\"$(VERSION)\"
d18 1
@


1.231
log
@Version: 1.9.9.
@
text
@d234 1
a234 1
	validate $<
@


1.230
log
@Fixed typo in Makefile.
Added initial scaling-units section in mdoc.7.
@
text
@d12 2
a13 2
VERSION	   = 1.9.8
VDATE	   = 10 October 2009
d20 2
a21 2
MANDOCFLAGS	= -Wall -fstrict
MANDOCHTML	= -Thtml -ostyle=style.css,man=%N.%S.html,includes=%I.html
@


1.229
log
@Re-added HTML changelog.
@
text
@d240 1
a240 1
.1.1.sgml 3.3.sgml .7.7.sgml:
@


1.228
log
@Makefile uses multiple deps for some rules (shorter file).
@
text
@d62 1
a62 1
HTMLS	   = index.html mandoc.1.html mdoc.3.html \
@


1.227
log
@Moved output definitions into main.h.
Pushed terminal_{mdoc,man} into {mdoc,man}_term.c.
@
text
@d237 1
a237 1
.1.1.txt:
d240 1
a240 13
.1.1.sgml:
	./mandoc $(MANDOCFLAGS) $(MANDOCHTML) $< > $@@

.3.3.txt:
	./mandoc $(MANDOCFLAGS) $< | col -b > $@@

.3.3.sgml:
	./mandoc $(MANDOCFLAGS) $(MANDOCHTML) $< > $@@

.7.7.txt:
	./mandoc $(MANDOCFLAGS) $< | col -b > $@@

.7.7.sgml:
@


1.226
log
@Clean up consts (noted by Joerg Sonnenberger and Ulrich Sporlein).
@
text
@d57 1
a57 1
	     libmandoc.h html.h chars.h out.h
@


1.225
log
@Version: 1.9.8.
@
text
@d16 1
a16 1
CFLAGS    += -W -Wall -Wstrict-prototypes -Wno-unused-parameter -g
@


1.224
log
@Version up.
@
text
@d12 2
a13 2
VERSION	   = 1.9.7
VDATE	   = 9 October 2009
@


1.223
log
@Additions to -Tman -Thtml: all structural components tested & in place.
Fitted both -Thtml with handling of arbitrary vertical and horizontal scaling units (see groff(7)).  Undocumented until fitted into -Tascii (next release).
@
text
@d12 2
a13 2
VERSION	   = 1.9.6
VDATE	   = 25 September 2009
@


1.222
log
@Fixed mandoc.1 examples (new -Thtml options).
Fixed manuals to use `In', not `Fd'.
Moved buf* functions into html.c.
@
text
@d43 1
a43 1
	     man_html.ln
d45 1
a45 1
	     man_term.o html.o mdoc_html.o man_html.o
d47 1
a47 1
	     man_term.c html.c mdoc_html.c man_html.c
d57 1
a57 1
	     libmandoc.h html.h chars.h
d174 5
a178 2
man_html.ln: man_html.c html.h man.h
man_html.o: man_html.c html.h man.h
@


1.221
log
@Temporarily disabled ChangeLog.html (server's hosed and doesn't have xsltproc).
@
text
@d20 3
d235 1
a235 1
	./mandoc -Wall,error -fstrict $< | col -b > $@@
d238 1
a238 1
	./mandoc -Thtml -ostyle=style.css -Wall,error -fstrict $< > $@@
d241 1
a241 1
	./mandoc -Wall,error -fstrict $< | col -b > $@@
d244 1
a244 1
	./mandoc -Thtml -ostyle=style.css -Wall,error -fstrict $< > $@@
d247 1
a247 1
	./mandoc -Wall,error -fstrict $< | col -b > $@@
d250 1
a250 1
	./mandoc -Thtml -ostyle=style.css -Wall,error -fstrict $< > $@@
@


1.220
log
@Version: 1.9.6.
@
text
@d59 1
a59 1
HTMLS	   = index.html ChangeLog.html mandoc.1.html mdoc.3.html \
d63 1
a63 1
	     mandoc_char.7.txt manuals.7.html
d197 3
@


1.219
log
@Many more macros added to -Thtml.
Minor space issues fixed in -Tascii.
@
text
@d12 2
a13 2
VERSION	   = 1.9.5
VDATE	   = 21 September 2009
@


1.218
log
@All special characters sync'd with groff, both -Thtml and -Tascii.
Re-added text links to index.sgml (just for show).
@
text
@d1 1
a1 1
.SUFFIXES:	.html .xml .sgml .1 .3 .7 .md5 .tar.gz .1.html .3.html .7.html .1.txt .3.txt .7.txt
d55 3
a57 1
SGMLS	   = index.sgml 
d73 1
a73 1
	     $(TARGZS) tags $(MD5S) $(XMLS) $(TEXTS)
d231 1
a231 1
.1.1.html:
d237 1
a237 1
.3.3.html:
d243 1
a243 1
.7.7.html:
@


1.217
log
@Added chars.h to HEADS.
@
text
@d1 1
a1 1
.SUFFIXES:	.html .xml .sgml .1 .3 .7 .md5 .tar.gz .1.html .3.html .7.html
d60 2
d71 1
a71 1
	     $(TARGZS) tags $(MD5S) $(XMLS) 
d87 1
a87 1
www:	all $(HTMLS) $(MD5S) $(TARGZS)
d90 1
a90 1
	install -m 0444 $(HTMLS) $(STATICS) $(PREFIX)/
@


1.216
log
@Added html.h to headers that should be distributed.
@
text
@d51 4
a54 2
DATAS	   = arch.in att.in lib.in msec.in st.in vol.in chars.in
HEADS	   = mdoc.h libmdoc.h man.h libman.h term.h libmandoc.h html.h
@


1.215
log
@Version: 1.9.5.
@
text
@d52 1
a52 1
HEADS	   = mdoc.h libmdoc.h man.h libman.h term.h libmandoc.h
d58 1
d69 1
a69 1
	     $(DATAS) $(XSLS)
@


1.214
log
@Split html.c into html.h, mdoc_html.c, man_html.c.
@
text
@d12 2
a13 2
VERSION	   = 1.9.2
VDATE	   = 05 September 2009
@


1.213
log
@Fixed body/divbody structure of html pages.
Added example style.css (example.style.css).
Enabled using -Thtml to generate manuals in Makefile.
Stopped making text manuals for webpage.
@
text
@d39 2
a40 1
	     compat.ln man_term.ln html.ln
d42 1
a42 1
	     man_term.o html.o
d44 1
a44 1
	     man_term.c html.c
d155 2
a156 2
term.ln: term.c term.h man.h mdoc.h
term.o: term.c term.h man.h mdoc.h
d158 8
a165 2
html.ln: html.c man.h mdoc.h
html.o: html.c man.h mdoc.h
@


1.212
log
@Removed new-born out.{h,c} (not a good idea).
Removed if 0 for HTML-mode output (why not).
Added option -oxxxx for passing options to output devices.
@
text
@d1 1
a1 1
.SUFFIXES:	.html .xml .sgml .1.txt .3.txt .7.txt .1 .3 .7 .md5 .tar.gz .1.html .3.html .7.html
d58 1
a58 1
STATICS	   = style.css external.png
a62 2
TEXTS	   = mandoc.1.txt mdoc.3.txt mdoc.7.txt manuals.7.txt \
	     mandoc_char.7.txt man.7.txt man.3.txt
d65 1
a65 1
	     $(TARGZS) tags $(TEXTS) $(MD5S) $(XMLS) 
d81 1
a81 1
www:	all $(HTMLS) $(MD5S) $(TARGZS) $(TEXTS) 
d84 1
a84 1
	install -m 0444 $(TEXTS) $(HTMLS) $(STATICS) $(PREFIX)/
@


1.211
log
@Tentative addition of front-end utility functions (out.h) (not sure if it's necessary).
More -Thtml installments.
@
text
@d1 1
a1 1
.SUFFIXES:	.html .xml .sgml .1.txt .3.txt .7.txt .1 .3 .7 .md5 .tar.gz 
d39 1
a39 1
	     compat.ln man_term.ln html.ln out.ln
d41 1
a41 1
	     man_term.o html.o out.o
d43 1
a43 1
	     man_term.c html.c out.c
d54 3
a56 1
HTMLS	   = index.html ChangeLog.html
a82 2
html:	$(HTMLS)

d159 2
a160 5
html.ln: html.c out.h man.h mdoc.h
html.o: html.c out.h man.h mdoc.h

out.ln: out.c out.h man.h mdoc.h
out.o: out.c out.h man.h mdoc.h
d219 3
d225 3
d231 3
@


1.210
log
@ascii_xxx -> chars_xxx (intended to hold more than just ascii encoding).
More html work.
@
text
@d39 1
a39 1
	     compat.ln man_term.ln html.ln
d41 1
a41 1
	     man_term.o html.o
d43 1
a43 1
	     man_term.c html.c
d159 5
a163 2
html.ln: html.c man.h mdoc.h
html.o: html.c man.h mdoc.h
@


1.209
log
@More updates to html.c.
Secretly enabled -Thtml in main.c (obviously not yet documented).
@
text
@d38 1
a38 1
MAINLNS	   = main.ln mdoc_term.ln ascii.ln term.ln tree.ln \
d40 1
a40 1
MAINOBJS   = main.o mdoc_term.o ascii.o term.o tree.o compat.o \
d42 1
a42 1
MAINSRCS   = main.c mdoc_term.c ascii.c term.c tree.c compat.c \
d50 1
a50 1
DATAS	   = arch.in att.in lib.in msec.in st.in vol.in ascii.in
d120 2
a121 2
ascii.ln: ascii.c ascii.in term.h
ascii.o: ascii.c ascii.in term.h
@


1.208
log
@Lookup hashes are now static tables, ordered first-level by second character, then randomly along a chain.  Improves performance by a small fraction and considerably cleans up hash sources.
@
text
@d39 1
a39 1
	     compat.ln man_term.ln
d41 1
a41 1
	     man_term.o
d43 1
a43 1
	     man_term.c
d159 3
@


1.207
log
@Removed TERMP_BOLD, TERMP_UNDER, TERMP_STYLE in favour of recursive-friendly increments.
Cleaned up confusing behaviour of p->flags.
@
text
@d187 1
a187 1
	install -m 0644 $(INSTALL) .dist/mdocml/mdocml-$(VERSION)/
@


1.206
log
@Version: 1.9.2.
Fixed man.7 syntax error (oops).
@
text
@d159 3
@


1.205
log
@Removed superfluous XXX.
Version: 1.9.1.
@
text
@d12 2
a13 2
VERSION	   = 1.9.1
VDATE	   = 21 August 2009
@


1.204
log
@Updated libman AST documentation.
Version (not yet finalised, but tagging in Makefile): 1.9.0.
@
text
@d12 2
a13 2
VERSION	   = 1.9.0
VDATE	   = 17 August 2009
@


1.203
log
@Significant overhaul in libman.  Macros are now block- and line-scoped (with
next-line scope extensions possible).  man.7 reflects block and line scoping,
and also includes a REFERENCE section that will be used as a template for the
big mdoc reference.  Many fixes in next-line behaviour for both inline and
block macros.  Added some macros for compatibility (from me.7).  Corrected
quoted-literal handling for libman.
@
text
@d12 2
a13 2
VERSION	   = 1.8.5
VDATE	   = 28 July 2009
@


1.202
log
@Version: 1.8.5.
Added \*R, \*(Tm (obscure -man predefined strings).
@
text
@d32 1
a32 1
	     man_action.ln mandoc.ln
d34 1
a34 1
	     man_action.o mandoc.o
d36 1
a36 1
	     man_action.c mandoc.c
d162 3
@


1.201
log
@Version.
@
text
@d12 2
a13 2
VERSION	   = 1.8.4
VDATE	   = 26 July 2009
@


1.200
log
@Version.
@
text
@d12 2
a13 2
VERSION	   = 1.8.3
VDATE	   = 23 July 2009
@


1.199
log
@Version.
@
text
@d12 2
a13 2
VERSION	   = 1.8.2
VDATE	   = 20 July 2009
@


1.198
log
@Fixed broken `make www' dep.
@
text
@d12 2
a13 2
VERSION	   = 1.8.1
VDATE	   = 19 July 2009
@


1.197
log
@Version.
@
text
@d66 2
a67 2
INSTALL	   = $(SRCS) $(HEADS) Makefile DESCR $(MANS) $(SGMLS) \
	     $(STATICS) $(DATAS) $(XSLS)
@


1.196
log
@ChangeLog xsl reflects symbolic tag.
@
text
@d12 2
a13 2
VERSION	   = 1.8.0
VDATE	   = 14 July 2009
@


1.195
log
@Removed automatic port generation, as the downstream versions should be used instead.
@
text
@d174 1
a174 1
	cvs2cl --xml --xml-encoding iso-8859-15 --noxmlns -f $@@
@


1.194
log
@Proper html showing of ChangeLog.
@
text
@d57 2
a58 8
MD5S	   = mdocml-$(VERSION).md5 \
	     mdocml-oport-$(VERSION).md5 \
	     mdocml-fport-$(VERSION).md5 \
	     mdocml-nport-$(VERSION).md5
TARGZS	   = mdocml-$(VERSION).tar.gz \
	     mdocml-oport-$(VERSION).tar.gz \
	     mdocml-fport-$(VERSION).tar.gz \
	     mdocml-nport-$(VERSION).tar.gz
d65 2
a66 5
	     $(TARGZS) tags $(TEXTS) ChangeLog.html $(MD5S) \
	     $(XMLS)
MAKEFILES  = Makefile.netbsd Makefile.openbsd Makefile.freebsd \
	     Makefile
INSTALL	   = $(SRCS) $(HEADS) $(MAKEFILES) DESCR $(MANS) $(SGMLS) \
a90 12
	install -m 0444 mdocml-oport-$(VERSION).tar.gz $(PREFIX)/ports-openbsd/
	install -m 0444 mdocml-oport-$(VERSION).tar.gz $(PREFIX)/ports-openbsd/mdocml.tar.gz
	install -m 0444 mdocml-oport-$(VERSION).md5 $(PREFIX)/ports-openbsd/
	install -m 0444 mdocml-oport-$(VERSION).md5 $(PREFIX)/ports-openbsd/mdocml.md5
	install -m 0444 mdocml-nport-$(VERSION).tar.gz $(PREFIX)/ports-netbsd/
	install -m 0444 mdocml-nport-$(VERSION).tar.gz $(PREFIX)/ports-netbsd/mdocml.tar.gz
	install -m 0444 mdocml-nport-$(VERSION).md5 $(PREFIX)/ports-netbsd/
	install -m 0444 mdocml-nport-$(VERSION).md5 $(PREFIX)/ports-netbsd/mdocml.md5
	install -m 0444 mdocml-fport-$(VERSION).tar.gz $(PREFIX)/ports-freebsd/
	install -m 0444 mdocml-fport-$(VERSION).tar.gz $(PREFIX)/ports-freebsd/mdocml.tar.gz
	install -m 0444 mdocml-fport-$(VERSION).md5 $(PREFIX)/ports-freebsd/
	install -m 0444 mdocml-fport-$(VERSION).md5 $(PREFIX)/ports-freebsd/mdocml.md5
a178 44
mdocml-nport-$(VERSION).tar.gz: mdocml-$(VERSION).tar.gz Makefile.netbsd DESCR
	mkdir -p .dist/mdocml/
	sed -e "s!@@VERSION@@!$(VERSION)!" Makefile.netbsd > \
		.dist/mdocml/Makefile
	md5 mdocml-$(VERSION).tar.gz > .dist/mdocml/distinfo
	rmd160 mdocml-$(VERSION).tar.gz >> .dist/mdocml/distinfo
	sha1 mdocml-$(VERSION).tar.gz >> .dist/mdocml/distinfo
	install -m 0644 DESCR .dist/mdocml/
	echo @@comment $$NetBSD$$ > .dist/mdocml/PLIST
	echo bin/mandoc >> .dist/mdocml/PLIST
	echo man/man1/mandoc.1 >> .dist/mdocml/PLIST
	echo man/man7/mdoc.7 >> .dist/mdocml/PLIST
	( cd .dist/ && tar zcf ../$@@ mdocml/ )
	rm -rf .dist/

mdocml-oport-$(VERSION).tar.gz: mdocml-$(VERSION).tar.gz Makefile.openbsd DESCR
	mkdir -p .dist/mdocml/pkg
	sed -e "s!@@VERSION@@!$(VERSION)!" Makefile.openbsd > \
		.dist/mdocml/Makefile
	md5 mdocml-$(VERSION).tar.gz > .dist/mdocml/distinfo
	rmd160 mdocml-$(VERSION).tar.gz >> .dist/mdocml/distinfo
	sha1 mdocml-$(VERSION).tar.gz >> .dist/mdocml/distinfo
	install -m 0644 DESCR .dist/mdocml/pkg/DESCR
	echo @@comment $$OpenBSD$$ > .dist/mdocml/pkg/PLIST
	echo bin/mandoc >> .dist/mdocml/pkg/PLIST
	echo @@man man/man1/mandoc.1 >> .dist/mdocml/pkg/PLIST
	echo @@man man/man7/mdoc.7 >> .dist/mdocml/pkg/PLIST
	( cd .dist/ && tar zcf ../$@@ mdocml/ )
	rm -rf .dist/

mdocml-fport-$(VERSION).tar.gz: mdocml-$(VERSION).tar.gz Makefile.freebsd DESCR
	mkdir -p .dist/mdocml
	sed -e "s!@@VERSION@@!$(VERSION)!" Makefile.freebsd > \
		.dist/mdocml/Makefile
	( md5 mdocml-$(VERSION).tar.gz; \
	  cksum -a SHA256 mdocml-$(VERSION).tar.gz; \
	  echo -n "SIZE (mdocml-$(VERSION).tar.gz) = "; \
	  ls -l mdocml-$(VERSION).tar.gz | awk '{print $$5}' \
	  ) > .dist/mdocml/distinfo
	install -m 0644 DESCR .dist/mdocml/pkg-descr
	( echo; echo "WWW: http://mdocml.bsd.lv/") >> .dist/mdocml/pkg-descr
	( cd .dist/ && tar zcf ../$@@ mdocml/ )
	rm -rf .dist/

@


1.193
log
@Using xsl for html changelog.
@
text
@d197 1
a197 1
ChangeLog.html: ChangeLog.xml
@


1.192
log
@Minor version bumped: -hang lists were the last major missing formatting "feature".
@
text
@d1 1
a1 1
.SUFFIXES:	.html .sgml .1.txt .3.txt .7.txt .1 .3 .7 .md5 .tar.gz
d53 3
a55 1
HTMLS	   = index.html
d71 2
a72 1
	     $(TARGZS) tags $(TEXTS) ChangeLog $(MD5S)
d76 1
a76 1
	     $(STATICS) $(DATAS)
d92 1
a92 1
www:	all $(HTMLS) $(MD5S) $(TARGZS) $(TEXTS) ChangeLog
a95 1
	install -m 0444 ChangeLog $(PREFIX)/snapshots/
d194 5
a198 2
ChangeLog::
	cvs2cl -P -t --no-indent --FSF --no-times
@


1.191
log
@Version.
@
text
@d12 2
a13 2
VERSION	   = 1.7.24
VDATE	   = 12 July 2009
@


1.190
log
@Small clean-ups in error message usage.
Version.
@
text
@d12 2
a13 2
VERSION	   = 1.7.23
VDATE	   = 7 July 2009
@


1.189
log
@Version.
@
text
@d12 2
a13 2
VERSION	   = 1.7.22
VDATE	   = 5 July 2009
@


1.188
log
@Version up.
@
text
@d12 2
a13 2
VERSION	   = 1.7.21
VDATE	   = 4 July 2009
@


1.187
log
@Moved escape validation into libmandoc.h/mandoc.c (common between libman/libmdoc1).
libman supports MAN_IGN_ESCAPE (like MDOC_IGN_ESCAPE).
All popular escapes now handled consistently.
@
text
@d12 2
a13 2
VERSION	   = 1.7.20
VDATE	   = 22 June 2009
@


1.186
log
@Makefile properly generates MD5 sums.
More clean-ups of new, simplified webpage.
@
text
@d22 2
a23 1
	     lib.ln att.ln arch.ln vol.ln msec.ln st.ln
d26 1
a26 1
	     arch.o vol.o msec.o st.o
d29 1
a29 1
	     arch.c vol.c msec.c st.c
d32 1
a32 1
	     man_action.ln
d34 1
a34 1
	     man_action.o
d36 1
a36 1
	     man_action.c
d51 1
a51 1
HEADS	   = mdoc.h libmdoc.h man.h libman.h term.h 
@


1.185
log
@Updating web-page to be a bit more compact.
@
text
@d68 1
a68 1
	     $(TARGZS) tags $(TEXTS) ChangeLog
d88 1
a88 3
md5:	$(MD5)

www:	all $(TARGZS) $(TEXTS) ChangeLog
d94 1
d96 1
d99 2
d103 2
d107 2
d191 1
a191 1
ChangeLog:
d276 1
a276 1
	md5 $< $@@
@


1.184
log
@Lint fixes.
Version up.
@
text
@d1 1
a1 1
.SUFFIXES:	.html .sgml .1.txt .3.txt .7.txt .1 .3 .7
d54 4
d86 1
a86 3
port:	mdocml-oport-$(VERSION).tar.gz \
	mdocml-fport-$(VERSION).tar.gz \
	mdocml-nport-$(VERSION).tar.gz
d88 3
a90 1
www:	all $(HTMLS) $(TARGZS) $(TEXTS) ChangeLog
d268 3
@


1.183
log
@Bumped version.
Removed CVS note from index (they'll contact me if they need it).
Properly ordered mandoc.1 CAVEATS/COMPATIBILITY.
@
text
@d12 2
a13 2
VERSION	   = 1.7.19
VDATE	   = 17 June 2009
@


1.182
log
@Put $VFLAGS back into $LINTFLAGS (broke on NetBSD).
@
text
@d12 2
a13 2
VERSION	   = 1.7.18
VDATE	   = 15 June 2009
d257 1
a257 1
	./mandoc -Wall $< | col -b > $@@
d260 1
a260 1
	./mandoc -Wall $< | col -b > $@@
d263 1
a263 1
	./mandoc -Wall $< | col -b > $@@
@


1.181
log
@Fixed lint invocation in Makefile.
Minor cleanups in mdoc.c.
@
text
@d18 1
@


1.180
log
@Removed superfluous ifdef around strftime (schwarze@@openbsd.org).
Bumped version (this was supposed to be in 1.7.17).
@
text
@a16 1
LINTFLAGS += $(VFLAGS)
d234 1
a234 1
	$(LINT) $(LINTFLAGS) -Clibmdoc $(MDOCLNS)
d237 1
a237 1
	$(LINT) $(LINTFLAGS) -Clibman $(MANLNS)
d240 1
a240 1
	$(LINT) $(LINTFLAGS) -Cmandoc $(MAINLNS) llib-llibmdoc.ln
@


1.179
log
@Tagging version 1.7.17.
@
text
@d12 1
a12 1
VERSION	   = 1.7.17
@


1.178
log
@Version.
@
text
@d12 2
a13 2
VERSION	   = 1.7.16
VDATE	   = 13 June 2009
@


1.177
log
@Don't run with -Werror when generating texts.
@
text
@d12 2
a13 2
VERSION	   = 1.7.15
VDATE	   = 12 June 2009
@


1.176
log
@Lint fixes (no effect).
Versioning up.
@
text
@d257 1
a257 1
	./mandoc -Wall,error $< | col -b > $@@
d260 1
a260 1
	./mandoc -Wall,error $< | col -b > $@@
d263 1
a263 1
	./mandoc -Wall,error $< | col -b > $@@
@


1.175
log
@Added automatic ChangeLog generation with each snapshot.
Added ChangeLog to main page.
@
text
@d12 2
a13 2
VERSION	   = 1.7.14
VDATE	   = 11 June 2009
@


1.174
log
@Version up.  Testing.
@
text
@d64 1
a64 1
	     $(TARGZS) tags $(TEXTS)
d86 1
a86 1
www:	all $(HTMLS) $(TARGZS) $(TEXTS)
d90 1
d181 3
@


1.173
log
@Added compat to Makefile.
@
text
@d12 2
a13 2
VERSION	   = 1.7.13
VDATE	   = 12 April 2009
@


1.172
log
@Version bumped.
`.Er' has more section restrictions (Joerg).
@
text
@d160 3
@


1.171
log
@*** empty log message ***
@
text
@d12 2
a13 2
VERSION	   = 1.7.12
VDATE	   = 06 April 2009
@


1.170
log
@Version (BIG fix).
@
text
@d12 1
a12 1
VERSION	   = 1.7.11
@


1.169
log
@Added TEXTS to installwww.
@
text
@d12 2
a13 2
VERSION	   = 1.7.10
VDATE	   = 05 April 2009
@


1.168
log
@man(3) doesn't use err.h anymore.
Added .i to man(3).
Fixed up manuals.
Fixed up webpage.
Assertion fixes in man(3) (hashtable).
Fixed assertion for .IP in mandoc -man.
@
text
@d89 1
a89 1
	install -m 0444 $(HTMLS) $(STATICS) $(PREFIX)/
@


1.167
log
@Version.
@
text
@d1 1
a1 1
.SUFFIXES:	.html .sgml
d12 2
a13 2
VERSION	   = 1.7.9
VDATE	   = 03 April 2009
d58 4
a61 1
MANS	   = mandoc.1 mdoc.3 mdoc.7 manuals.7
d63 2
a64 2
CLEAN	   = $(BINS) $(LNS) $(LLNS) $(LIBS) $(OBJS) $(HTMLS) $(TARGZS) \
	     tags
d86 1
a86 1
www:	$(HTMLS) $(TARGZS)
d248 9
@


1.166
log
@Initial -mandoc auto-switch in place.
@
text
@d12 2
a13 2
VERSION	   = 1.7.8
VDATE	   = 31 March 2009
@


1.165
log
@General clean-ups.
@
text
@d60 2
a61 1
CLEAN	   = $(BINS) $(LNS) $(LLNS) $(LIBS) $(OBJS) $(HTMLS) $(TARGZS) 
@


1.164
log
@Version.  Added forgotten file.
@
text
@d12 2
a13 2
VERSION	   = 1.7.7
VDATE	   = 27 March 2009
d20 4
a23 4
MDOCLNS	   = mdoc_macro.ln mdoc.ln mdoc_hash.ln strings.ln xstd.ln \
	     mdoc_argv.ln mdoc_validate.ln mdoc_action.ln lib.ln \
	     att.ln arch.ln vol.ln msec.ln st.ln
MDOCOBJS   = mdoc_macro.o mdoc.o mdoc_hash.o strings.o xstd.o \
d26 1
a26 1
MDOCSRCS   = mdoc_macro.c mdoc.c mdoc_hash.c strings.c xstd.c \
d37 1
a37 1
MAINLNS	   = main.ln mdoc_term.ln ascii.ln terminal.ln tree.ln \
d39 1
a39 1
MAINOBJS   = main.o mdoc_term.o ascii.o terminal.o tree.o compat.o \
d41 1
a41 1
MAINSRCS   = main.c mdoc_term.c ascii.c terminal.c tree.c compat.c \
d138 2
a139 2
strings.ln: strings.c libmdoc.h
strings.o: strings.c libmdoc.h
d156 2
a157 5
terminal.ln: terminal.c term.h man.h mdoc.h
terminal.o: terminal.c term.h man.h mdoc.h

xstd.ln: xstd.c libmdoc.h
xstd.o: xstd.c libmdoc.h
@


1.163
log
@Fixes in going over all OpenBSD manuals.
@
text
@d12 2
a13 2
VERSION	   = 1.7.6
VDATE	   = 26 March 2009
@


1.162
log
@All macro-invocations, for consistency, begin with `.' in documentation.
Fixed \\ -> \e in manual documentation.
All preliminary -man macros in place.
@
text
@d21 8
a28 8
	     argv.ln mdoc_validate.ln mdoc_action.ln lib.ln att.ln \
	     arch.ln vol.ln msec.ln st.ln
MDOCOBJS   = mdoc_macro.o mdoc.o mdoc_hash.o strings.o xstd.o argv.o \
	     mdoc_validate.o mdoc_action.o lib.o att.o arch.o vol.o \
	     msec.o st.o
MDOCSRCS   = mdoc_macro.c mdoc.c mdoc_hash.c strings.c xstd.c argv.c \
	     mdoc_validate.c mdoc_action.c lib.c att.c arch.c vol.c \
	     msec.c st.c
d162 2
a163 2
argv.ln: argv.c libmdoc.h
argv.o: argv.c libmdoc.h
@


1.161
log
@Fixed after-NLINE-error assertion.
Scanned over all manuals with valgrind.
Version up.
@
text
@d12 1
a12 1
VERSION	   = 1.7.5
@


1.160
log
@Initial front-end formatting for -man pages.
@
text
@d12 1
a12 1
VERSION	   = 1.7.4
@


1.159
log
@Version (getting ready for abstracting term.c).
@
text
@d37 6
a42 3
MAINLNS	   = main.ln term.ln ascii.ln terminal.ln tree.ln compat.ln
MAINOBJS   = main.o term.o ascii.o terminal.o tree.o compat.o
MAINSRCS   = main.c term.c ascii.c terminal.c tree.c compat.c
d135 2
a136 2
term.ln: term.c term.h 
term.o: term.c term.h
d156 2
a157 2
terminal.ln: terminal.c term.h
terminal.o: terminal.c term.h
a175 2
term.h: mdoc.h

@


1.158
log
@Fixed inheritence of initial macro into man_macro.
Removed warnxs from man_macro (man_vwarn).
@
text
@d12 2
a13 2
VERSION	   = 1.7.3
VDATE	   = 24 March 2009
@


1.157
log
@Fixed reading whitespace for man.7 `.    TH'.
Documented this.
@
text
@d44 1
a44 1
OBJS	   = $(MDOCOBJS) $(MAINOBJS)
@


1.156
log
@Added man_action.c, renamed mdoc_action.c.
@
text
@d42 1
a42 1
LNS	   = $(MAINLNS) $(MDOCLNS)
@


1.155
log
@Added man validator, renamed mdoc validator.
@
text
@d21 1
a21 1
	     argv.ln mdoc_validate.ln action.ln lib.ln att.ln \
d24 1
a24 1
	     mdoc_validate.o action.o lib.o att.o arch.o vol.o \
d27 1
a27 1
	     mdoc_validate.c action.c lib.c att.c arch.c vol.c \
d30 6
a35 3
MANLNS	   = man_macro.ln man.ln man_hash.ln man_validate.ln
MANOBJS	   = man_macro.o man.o man_hash.o man_validate.o
MANSRCS	   = man_macro.c man.c man_hash.c man_validate.c
d168 2
a169 2
action.ln: action.c libmdoc.h
action.o: action.c libmdoc.h
@


1.154
log
@FreeBSD uses sha256 now.
@
text
@d21 2
a22 2
	     argv.ln validate.ln action.ln lib.ln att.ln arch.ln \
	     vol.ln msec.ln st.ln
d24 2
a25 1
	     validate.o action.o lib.o att.o arch.o vol.o msec.o st.o
d27 2
a28 1
	     validate.c action.c lib.c att.c arch.c vol.c msec.c st.c
d30 3
a32 3
MANLNS	   = man_macro.ln man.ln man_hash.ln
MANOBJS	   = man_macro.o man.o man_hash.o
MANSRCS	   = man_macro.c man.c man_hash.c
d159 5
a163 2
validate.ln: validate.c libmdoc.h
validate.o: validate.c libmdoc.h
@


1.153
log
@More fixes from Ulrich Sporlein. (freebsd)
@
text
@d202 1
a202 1
	  sha1 mdocml-$(VERSION).tar.gz; \
@


1.152
log
@Added FreeBSD port.
@
text
@d12 2
a13 2
VERSION	   = 1.7.2
VDATE	   = 23 March 2009
d53 4
a56 2
INSTALL	   = $(SRCS) $(HEADS) Makefile DESCR $(MANS) $(SGMLS) \
	     $(STATICS) Makefile.netbsd Makefile.openbsd $(DATAS)
@


1.151
log
@Bumped version (testing).
@
text
@d48 1
d68 3
a70 1
port:	mdocml-oport-$(VERSION).tar.gz mdocml-nport-$(VERSION).tar.gz
d82 2
d195 14
@


1.150
log
@Fixed inclusion of MANSRCS (sorry, Ulrich).
Added DragonFlyBSD __dead2.
@
text
@d12 1
a12 1
VERSION	   = 1.7.1
@


1.149
log
@-man printing linked to -Ttree.
@
text
@d40 1
a40 1
SRCS	   = $(MDOCSRCS) $(MAINSRCS)
@


1.148
log
@First addition of -man macro support.
Abstraction of mdoc.
@
text
@d12 2
a13 2
VERSION	   = 1.6.10
VDATE	   = 22 March 2009
@


1.147
log
@Fixed Bd -compact.
Fixed vspace before Bd and Bl.
@
text
@d20 11
a30 12
# If you want to strip `Xo/Xc' macro pairs, enable this.  Really, only
# OpenBSD should be doing this while it kicks its cruft.
#CFLAGS	  += -DSTRIP_XO
#LINTFLAGS += -DSTRIP_XO

LIBLNS	   = macro.ln mdoc.ln hash.ln strings.ln xstd.ln argv.ln \
	     validate.ln action.ln lib.ln att.ln arch.ln vol.ln \
	     msec.ln st.ln
LIBOBJS	   = macro.o mdoc.o hash.o strings.o xstd.o argv.o validate.o \
	     action.o lib.o att.o arch.o vol.o msec.o st.o
LIBSRCS	   = macro.c mdoc.c hash.c strings.c xstd.c argv.c validate.c \
	     action.c lib.c att.c arch.c vol.c msec.c st.c
d36 5
a40 5
LLNS	   = llib-llibmdoc.ln llib-lmandoc.ln
LNS	   = $(MAINLNS) $(LIBLNS)
LIBS	   = libmdoc.a
OBJS	   = $(LIBOBJS) $(MAINOBJS)
SRCS	   = $(LIBSRCS) $(MAINSRCS)
d42 1
a42 1
HEADS	   = mdoc.h private.h term.h 
d93 2
a94 2
lib.ln: lib.c lib.in private.h
lib.o: lib.c lib.in private.h
d96 2
a97 2
att.ln: att.c att.in private.h
att.o: att.c att.in private.h
d99 2
a100 2
arch.ln: arch.c arch.in private.h
arch.o: arch.c arch.in private.h
d102 5
a106 2
vol.ln: vol.c vol.in private.h
vol.o: vol.c vol.in private.h
d111 2
a112 2
msec.ln: msec.c msec.in private.h
msec.o: msec.c msec.in private.h
d114 2
a115 2
st.ln: st.c st.in private.h
st.o: st.c st.in private.h
d117 2
a118 2
macro.ln: macro.c private.h
macro.o: macro.c private.h
d123 8
a130 2
strings.ln: strings.c private.h
strings.o: strings.c private.h
d132 2
a133 2
hash.ln: hash.c private.h
hash.o: hash.c private.h
d135 2
a136 2
mdoc.ln: mdoc.c private.h
mdoc.o: mdoc.c private.h
d144 2
a145 2
xstd.ln: xstd.c private.h
xstd.o: xstd.c private.h
d147 2
a148 2
argv.ln: argv.c private.h
argv.o: argv.c private.h
d150 2
a151 2
validate.ln: validate.c private.h
validate.o: validate.c private.h
d153 2
a154 2
action.ln: action.c private.h
action.o: action.c private.h
d156 1
a156 1
private.h: mdoc.h
d196 5
a200 2
llib-llibmdoc.ln: $(LIBLNS)
	$(LINT) $(LINTFLAGS) -Clibmdoc $(LIBLNS)
d205 5
a209 2
libmdoc.a: $(LIBOBJS)
	$(AR) rs $@@ $(LIBOBJS)
d211 2
a212 2
mandoc: $(MAINOBJS) libmdoc.a
	$(CC) $(CFLAGS) -o $@@ $(MAINOBJS) libmdoc.a 
@


1.146
log
@Backed-out STRIP_XO by default.
@
text
@d12 1
a12 1
VERSION	   = 1.6.9
@


1.145
log
@Lint fixes.
@
text
@d22 2
a23 2
CFLAGS	  += -DSTRIP_XO
LINTFLAGS += -DSTRIP_XO
@


1.144
log
@Removed Xo/Xc no-support notices.
@
text
@d23 1
@


1.143
log
@Stripping of Xo/Xc macros in main.c (ifdef STRIP_XO).
@
text
@d12 2
a13 2
VERSION	   = 1.6.8
VDATE	   = 21 March 2009
@


1.142
log
@More documentation clarification.
@
text
@d16 1
a16 1
CFLAGS    += -W -Wall -Wstrict-prototypes -Wno-unused-parameter -g 
d20 4
@


1.141
log
@Freed more macros from zero-length restrictions.
Fixed `Fn' spacing.
@
text
@d39 1
a39 1
SGMLS	   = index.sgml
d45 1
a45 1
MANS	   = mandoc.1 mdoc.3 mdoc.7
@


1.140
log
@Versioning.
@
text
@d12 1
a12 1
VERSION	   = 1.6.7
@


1.139
log
@Versioning up.
@
text
@d12 1
a12 1
VERSION	   = 1.6.6
@


1.138
log
@Versioning up.
@
text
@d12 1
a12 1
VERSION	   = 1.6.5
@


1.137
log
@Proper .Dl literalism.
@
text
@d12 2
a13 2
VERSION	   = 1.6.4
VDATE	   = 20 March 2009
@


1.136
log
@Fixed literal-formatting error with `Dl'.
@
text
@d12 1
a12 1
VERSION	   = 1.6.3
@


1.135
log
@Support for `Bd' of all types (see mdoc.7 for newline/tab rules).
Renamed term.c and terminal.c functions to be term_.
Some bugfixes to lists.
@
text
@d12 1
a12 1
VERSION	   = 1.6.2
@


1.134
log
@Some Linux-isms.
@
text
@d12 2
a13 2
VERSION	   = 1.6.1
VDATE	   = 19 March 2009
@


1.133
log
@Lintified & versioned.
@
text
@d12 1
a12 1
VERSION	   = 1.6.0
d28 3
a30 3
MAINLNS	   = main.ln term.ln ascii.ln terminal.ln tree.ln
MAINOBJS   = main.o term.o ascii.o terminal.o tree.o 
MAINSRCS   = main.c term.c ascii.c terminal.c tree.c
@


1.132
log
@Split mdocterm.c -> main.c terminal.c.
Abstracted output with -T selector (default ascii).
Name change: mdocterm -> mandoc.
Re-imported tree with -Ttree.
@
text
@d12 1
a12 1
VERSION	   = 1.5.5
@


1.131
log
@Many more ASCII escapes added.
Stripped nroff punt from mdocterm.c.
Fixed multiple-file handling for mdocterm.c.
Cleared up mdoc.h API.
@
text
@d19 1
d25 9
a33 4
TERMLNS	   = mdocterm.ln term.ln ascii.ln
TERMOBJS   = mdocterm.o term.o ascii.o
LLNS	   = llib-llibmdoc.ln llib-lmdocterm.ln
LNS	   = $(TERMLNS) $(LIBLNS)
d35 2
a36 4
OBJS	   = $(LIBOBJS) $(TERMOBJS)
SRCS	   = macro.c mdoc.c hash.c strings.c xstd.c argv.c validate.c \
	     action.c term.c mdocterm.c lib.c att.c arch.c vol.c \
	     msec.c st.c ascii.c
d42 2
a43 1
TARGZS	   = mdocml-$(VERSION).tar.gz mdocml-oport-$(VERSION).tar.gz \
d45 2
a46 2
MANS	   = mdocterm.1 mdoc.3 mdoc.7
BINS	   = mdocterm 
a77 2
	mkdir -p $(INCLUDEDIR)
	mkdir -p $(LIBDIR)/lib
a78 1
	mkdir -p $(MANDIR)/man3
d80 2
a81 3
	$(INSTALL_PROGRAM) mdocterm $(BINDIR)
	$(INSTALL_MAN) mdocterm.1 $(MANDIR)/man1
	$(INSTALL_MAN) mdoc.3 $(MANDIR)/man3
a82 2
	$(INSTALL_LIB) libmdoc.a $(LIBDIR)
	$(INSTALL_DATA) mdoc.h $(INCLUDEDIR)
d85 2
a86 3
	rm -f $(BINDIR)/mdocterm
	rm -f $(MANDIR)/man1/mdocterm.1
	rm -f $(MANDIR)/man3/mdoc.3
a87 2
	rm -f $(LIBDIR)/libmdoc.a
	rm -f $(INCLUDEDIR)/mdoc.h
d125 5
a129 2
mdocterm.ln: mdocterm.c
mdocterm.o: mdocterm.c
d156 3
a158 5
	echo bin/mdocterm >> .dist/mdocml/PLIST
	echo lib/libmdoc.a >> .dist/mdocml/PLIST
	echo include/mdoc.h >> .dist/mdocml/PLIST
	echo man/man1/mdocterm.1 >> .dist/mdocml/PLIST
	echo man/man3/mdoc.3 >> .dist/mdocml/PLIST
d171 3
a173 5
	echo bin/mdocterm >> .dist/mdocml/pkg/PLIST
	echo lib/libmdoc.a >> .dist/mdocml/pkg/PLIST
	echo include/mdoc.h >> .dist/mdocml/pkg/PLIST
	echo @@man man/man1/mdocterm.1 >> .dist/mdocml/pkg/PLIST
	echo @@man man/man3/mdoc.3 >> .dist/mdocml/pkg/PLIST
d186 2
a187 2
llib-lmdocterm.ln: $(TERMLNS) llib-llibmdoc.ln
	$(LINT) $(LINTFLAGS) -Cmdocterm $(TERMLNS) llib-llibmdoc.ln
d192 2
a193 2
mdocterm: $(TERMOBJS) libmdoc.a
	$(CC) $(CFLAGS) -o $@@ $(TERMOBJS) libmdoc.a 
a197 1

@


1.130
log
@*** empty log message ***
@
text
@a2 3
VERSION	= 1.5.3
VDATE	= 17 March 2009

a6 1

d12 2
a13 2
VFLAGS  = -DVERSION=\"$(VERSION)\"
CFLAGS += -W -Wall -Wstrict-prototypes -Wno-unused-parameter -g 
d15 2
d19 26
a44 55

LIBLNS	= macro.ln mdoc.ln hash.ln strings.ln xstd.ln argv.ln \
	  validate.ln action.ln lib.ln att.ln arch.ln vol.ln \
	  msec.ln st.ln

TREELNS	= mdoctree.ln mmain.ln 

TERMLNS	= mdoctree.ln mmain.ln term.ln ascii.ln

LINTLNS	= mdoclint.ln mmain.ln

LNS	= $(LIBLNS) $(TREELNS) $(TERMLNS)

LLNS	= llib-llibmdoc.ln llib-lmdoctree.ln llib-lmdocterm.ln

LIBS	= libmdoc.a

LIBOBJS	= macro.o mdoc.o hash.o strings.o xstd.o argv.o \
	  validate.o action.o lib.o att.o arch.o vol.o msec.o \
	  st.o

TERMOBJS= mdocterm.o mmain.o term.o ascii.o

TREEOBJS= mdoctree.o mmain.o

LINTOBJS= mdoclint.o mmain.o

OBJS	= $(LIBOBJS) $(TERMOBJS) $(TREEOBJS) $(LINTOBJS)

SRCS	= macro.c mdoc.c hash.c strings.c xstd.c argv.c validate.c \
	  action.c term.c mdoctree.c mdocterm.c mmain.c mdoclint.c \
	  lib.c att.c arch.c vol.c msec.c st.c ascii.c

DATAS	= arch.in att.in lib.in msec.in st.in vol.in ascii.in

HEADS	= mdoc.h private.h term.h mmain.h

SGMLS	= index.sgml

HTMLS	= index.html

STATICS	= style.css external.png

TARGZS	= mdocml-$(VERSION).tar.gz mdocml-oport-$(VERSION).tar.gz \
	  mdocml-nport-$(VERSION).tar.gz

MANS	= mdoctree.1 mdocterm.1 mdoclint.1 mdoc.3 mdoc.7

BINS	= mdocterm mdoctree mdoclint

CLEAN	= $(BINS) $(LNS) $(LLNS) $(LIBS) $(OBJS) $(HTMLS) \
	  $(TARGZS) 

INSTALL	= $(SRCS) $(HEADS) Makefile DESCR $(MANS) $(SGMLS) \
	  $(STATICS) Makefile.netbsd Makefile.openbsd $(DATAS)
d77 1
a78 2
	$(INSTALL_PROGRAM) mdoctree $(BINDIR)
	$(INSTALL_PROGRAM) mdoclint $(BINDIR)
a79 2
	$(INSTALL_MAN) mdoctree.1 $(MANDIR)/man1
	$(INSTALL_MAN) mdoclint.1 $(MANDIR)/man1
d81 1
a86 2
	rm -f $(BINDIR)/mdoctree
	rm -f $(BINDIR)/mdoclint
a87 2
	rm -f $(MANDIR)/man1/mdoctree.1
	rm -f $(MANDIR)/man1/mdoclint.1
d89 1
d129 2
a130 8
mdocterm.ln: mdocterm.c mmain.h
mdocterm.o: mdocterm.c mmain.h

mdoclint.ln: mdoclint.c mmain.h
mdoclint.o: mdoclint.c mmain.h

mdoctree.ln: mdoctree.c mmain.h
mdoctree.o: mdoctree.c mmain.h
a143 3
mmain.ln: mmain.c mmain.h
mmain.o: mmain.c mmain.h

a145 2
mmain.h: mdoc.h

a157 2
	echo bin/mdoctree >> .dist/mdocml/PLIST
	echo bin/mdoclint >> .dist/mdocml/PLIST
a159 1
	echo man/man1/mdoctree.1 >> .dist/mdocml/PLIST
a160 1
	echo man/man1/mdoclint.1 >> .dist/mdocml/PLIST
a174 2
	echo bin/mdoctree >> .dist/mdocml/pkg/PLIST
	echo bin/mdoclint >> .dist/mdocml/pkg/PLIST
a176 1
	echo @@man man/man1/mdoctree.1 >> .dist/mdocml/pkg/PLIST
a177 1
	echo @@man man/man1/mdoclint.1 >> .dist/mdocml/pkg/PLIST
a190 3
llib-lmdoctree.ln: $(TREELNS) llib-llibmdoc.ln
	$(LINT) $(LINTFLAGS) -Cmdoctree $(TREELNS) llib-llibmdoc.ln

a199 6
mdoctree: $(TREEOBJS) libmdoc.a
	$(CC) $(CFLAGS) -o $@@ $(TREEOBJS) libmdoc.a 

mdoclint: $(LINTOBJS) libmdoc.a
	$(CC) $(CFLAGS) -o $@@ $(LINTOBJS) libmdoc.a 

@


1.129
log
@Added previous GEN files to SRCS.
@
text
@d3 1
a3 1
VERSION	= 1.5.2
@


1.128
log
@Changed e-mail address to @@openbsd.
Cleaned up manual-page documentation.
@
text
@d51 2
a52 1
	  action.c term.c mdoctree.c mdocterm.c mmain.c mdoclint.c
@


1.127
log
@Fixed mdoc_phrase escape handling.
Added MDOC_IGNDELIM (Pf, soon Li, etc.).
macro_constant_delimited ignargs -> argv.c parsing.
Renamed macro functions to correspond to ontologies.
`Fo' and `St' made callable (compat documented).
strings.sh deprecated (directly using CPP).
Abstracted ASCII translation into ascii.{c,in}.
ASCII table uses a self-reordering chained hashtable.
Removed old regressions.
@
text
@d3 2
a4 2
VERSION	= 1.5.1
VDATE	= 15 March 2009
@


1.126
log
@Fixed version string (no leading zero).
@
text
@d28 1
a28 1
TERMLNS	= mdoctree.ln mmain.ln term.ln
d42 1
a42 1
TERMOBJS= mdocterm.o mmain.o term.o
d53 1
a53 5
SCRIPTS = strings.sh

DATAS	= arch.in att.in lib.in msec.in st.in vol.in

GEN	= lib.c att.c arch.c vol.c msec.c st.c
d71 1
a71 1
	  $(TARGZS) $(GEN)
d74 1
a74 75
	  $(STATICS) $(SCRIPTS) Makefile.netbsd Makefile.openbsd \
	  $(DATAS)

FAIL	= regress/test.empty \
	  regress/test.prologue.00 \
	  regress/test.prologue.01 \
	  regress/test.prologue.02 \
	  regress/test.prologue.03 \
	  regress/test.prologue.04 \
	  regress/test.prologue.06 \
	  regress/test.prologue.19 \
	  regress/test.prologue.23 \
	  regress/test.prologue.24 \
	  regress/test.prologue.27 \
	  regress/test.prologue.28 \
	  regress/test.prologue.30 \
	  regress/test.prologue.31 \
	  regress/test.prologue.32 \
	  regress/test.sh.03 \
	  regress/test.escape.01 \
	  regress/test.escape.02 \
	  regress/test.escape.03 \
	  regress/test.escape.04 \
	  regress/test.escape.06 \
	  regress/test.escape.07 \
	  regress/test.escape.08 \
	  regress/test.escape.09 \
	  regress/test.escape.11 \
	  regress/test.escape.12 \
	  regress/test.escape.14 \
	  regress/test.argv.01 \
	  regress/test.argv.02

SUCCEED	= regress/test.prologue.05 \
	  regress/test.prologue.07 \
	  regress/test.prologue.08 \
	  regress/test.prologue.09 \
	  regress/test.prologue.10 \
	  regress/test.prologue.11 \
	  regress/test.prologue.12 \
	  regress/test.prologue.13 \
	  regress/test.prologue.14 \
	  regress/test.prologue.15 \
	  regress/test.prologue.16 \
	  regress/test.prologue.17 \
	  regress/test.prologue.18 \
	  regress/test.prologue.20 \
	  regress/test.prologue.21 \
	  regress/test.prologue.22 \
	  regress/test.prologue.25 \
	  regress/test.prologue.26 \
	  regress/test.prologue.29 \
	  regress/test.prologue.33 \
	  regress/test.sh.00 \
	  regress/test.name.00 \
	  regress/test.name.01 \
	  regress/test.name.02 \
	  regress/test.name.03 \
	  regress/test.list.00 \
	  regress/test.list.01 \
	  regress/test.list.02 \
	  regress/test.list.03 \
	  regress/test.list.04 \
	  regress/test.list.05 \
	  regress/test.list.06 \
	  regress/test.list.07 \
	  regress/test.sh.01 \
	  regress/test.sh.02 \
	  regress/test.escape.00 \
	  regress/test.escape.05 \
	  regress/test.escape.10 \
	  regress/test.escape.13 \
	  regress/test.argv.00

REGRESS	= $(FAIL) $(SUCCEED)
a100 8
#regress: mdoclint $(FAIL) $(SUCCEED)
#	@@for f in $(FAIL); do \
#		echo "./mdoclint $$f" ; \
#		./mdoclint $$f 2>/dev/null || continue ; exit 1 ; done
#	@@for f in $(SUCCEED); do \
#		echo "./mdoclint $$f" ; \
		./mdoclint $$f 2>/dev/null || exit 1 ; done

d128 2
a129 17
lib.ln: lib.c private.h
lib.o: lib.c private.h

att.ln: att.c private.h
att.o: att.c private.h

arch.ln: arch.c private.h
arch.o: arch.c private.h

vol.ln: vol.c private.h
vol.o: vol.c private.h

msec.ln: msec.c private.h
msec.o: msec.c private.h

st.ln: st.c private.h
st.o: st.c private.h
d131 2
a132 2
lib.c: lib.in strings.sh
	sh strings.sh -o $@@ lib lib.in
d134 2
a135 2
st.c: st.in strings.sh
	sh strings.sh -o $@@ st st.in
d137 2
a138 2
msec.c: msec.in strings.sh
	sh strings.sh -o $@@ msec msec.in
d140 2
a141 2
att.c: att.in strings.sh
	sh strings.sh -o $@@ att att.in
d143 2
a144 2
arch.c: arch.in strings.sh
	sh strings.sh -o $@@ arch arch.in
d146 2
a147 2
vol.c: vol.in strings.sh
	sh strings.sh -o $@@ vol vol.in
a237 1
	mkdir -p .dist/mdocml/mdocml-$(VERSION)/regress/
a238 1
	install -m 0644 $(REGRESS) .dist/mdocml/mdocml-$(VERSION)/regress/
@


1.125
log
@mdoclint accepts multiple files
mdocterm punts to nroff if it fails parsing
@
text
@d3 1
a3 1
VERSION	= 1.5.01
@


1.124
log
@Added colour styles (not being used) to struct termp.
Added nroff style-escape encoding.
Removed ANSI schema string tables (there's only ANSI and nroff/backspace).
Pushed styling directly into pword (simpler).
@
text
@d3 2
a4 2
VERSION	= 1.4.16
VDATE	= 14 March 2009
@


1.123
log
@Bumped version.
Added \| (non-breaking space, like \&).
Fixed termsym (TERMSYM_ALL).
@
text
@d3 1
a3 1
VERSION	= 1.4.15
@


1.122
log
@Removed "regression" for OpenBSD (broken).
Added mdoc.7 to include-in-dist hook.
@
text
@d3 2
a4 2
VERSION	= 1.4.14
VDATE	= 13 March 2009
@


1.121
log
@Made syste-name macros callable (At, Bsx, etc.).
@
text
@d3 1
a3 1
VERSION	= 1.4.13
d70 1
a70 1
MANS	= mdoctree.1 mdocterm.1 mdoclint.1 mdoc.3
d179 6
a184 6
regress: mdoclint $(FAIL) $(SUCCEED)
	@@for f in $(FAIL); do \
		echo "./mdoclint $$f" ; \
		./mdoclint $$f 2>/dev/null || continue ; exit 1 ; done
	@@for f in $(SUCCEED); do \
		echo "./mdoclint $$f" ; \
@


1.120
log
@Added -nested (doesn't do anything).
Added .%C.
.Cd is now callable.
Added .Rv -std.
@
text
@d3 1
a3 1
VERSION	= 1.4.12
@


1.119
log
@NetBSD '.[[:whitespace:]]*' properly handled.
mdoc.3 indicates compatibilities and bugs.
@
text
@d3 1
a3 1
VERSION	= 1.4.11
@


1.118
log
@Version up.
@
text
@d3 2
a4 2
VERSION	= 1.4.10
VDATE	= 12 March 2009
@


1.117
log
@Versioning up.
@
text
@d3 2
a4 2
VERSION	= 1.4.9
VDATE	= 11 March 2009
@


1.116
log
@Bug-fix in mdoc_argv.
Added some documentation to macro.c.
Version-up.
@
text
@d3 2
a4 2
VERSION	= 1.4.8
VDATE	= 10 March 2009
@


1.115
log
@Versioning up.
@
text
@d3 2
a4 2
VERSION	= 1.4.7
VDATE	= 9 March 2009
@


1.114
log
@Fixed valgrind issues.
@
text
@d3 1
a3 1
VERSION	= 1.4.6
@


1.113
log
@Easier integration into FreeBSD (sys/types.h, time.h, etc.).
@
text
@d3 1
a3 1
VERSION	= 1.4.5
@


1.112
log
@Added "Input Encoding" section to mdoc*.1.
Newline-escaped lines are concatenated.
Added -fign-macro option.
@
text
@d3 1
a3 1
VERSION	= 1.4.4
d16 1
a16 1
CPPFLAGS = -DVERSION=\"$(VERSION)\"
d19 3
@


1.111
log
@Bumping version...
@
text
@d3 2
a4 2
VERSION	= 1.4.2
VDATE	= 8 March 2009
@


1.110
log
@Fixed strings.sh to work with NetBSD.
Fixed various lint warnings.
@
text
@d3 1
a3 1
VERSION	= 1.4.1
d52 2
d75 2
a76 1
	  $(STATICS) $(SCRIPTS) Makefile.netbsd Makefile.openbsd
@


1.109
log
@Bumped minor-number.
All sources converted to new schema.
@
text
@d16 1
a17 1
CFLAGS += -DVERSION=\"$(VERSION)\"
@


1.108
log
@Strings abstracted into dynamically-created C files.
Added -V option.
Deprecated README files.
@
text
@d3 2
a4 2
VERSION	= 1.3.19
VDATE	= 05 March 2009
@


1.107
log
@Cleaned up ctype functions (netbsd).
Fixed .Ex/.Rv -std usage.
Made Ar provide default value.
@
text
@d3 2
a4 2
VERSION	= 1.3.18
VDATE	= 04 March 2009
d17 1
d20 2
a21 1
	  validate.ln action.ln 
d36 2
a37 1
	  validate.o action.o
d45 1
a45 1
OBJS	= $(LIBOBJS) $(TERMOBJS) $(TREEOBJS)
d50 4
d70 1
a70 1
	  $(TARGZS)
d73 1
a73 1
	  $(STATICS) Makefile.netbsd Makefile.openbsd
a81 4
	  regress/test.prologue.13 \
	  regress/test.prologue.15 \
	  regress/test.prologue.16 \
	  regress/test.prologue.18 \
a82 2
	  regress/test.prologue.21 \
	  regress/test.prologue.22 \
a84 2
	  regress/test.prologue.25 \
	  regress/test.prologue.26 \
a86 1
	  regress/test.prologue.29 \
a89 1
	  regress/test.prologue.33 \
d112 1
d114 2
d117 1
d119 6
d208 36
@


1.106
log
@Added argv regression tests.
Table-ised argument flags in argv.c.
@
text
@d105 2
a106 1
	  regress/test.argv.01
d166 1
a166 1
regress: mdoclint
@


1.105
log
@-tag, if followed by empty body, doesn't newline.
Versioning up.
@
text
@d104 2
a105 1
	  regress/test.escape.14
d135 2
a136 1
	  regress/test.escape.13
@


1.104
log
@-diag fixed (allows quoted parameters)
Versioned up.
@
text
@d3 2
a4 2
VERSION	= 1.3.17
VDATE	= 03 March 2009
@


1.103
log
@Added new old escape sequence \*[nn].
Initial correct .Bd support (still only text in literal displays).
Symbols put into tables (character-encoding).
@
text
@d3 2
a4 2
VERSION	= 1.3.15
VDATE	= 02 March 2009
@


1.102
log
@Versioning up.
@
text
@d103 2
a104 1
	  regress/test.escape.12
d133 2
a134 1
	  regress/test.escape.10
@


1.101
log
@Backing-out DESTDIR.
@
text
@d3 2
a4 2
VERSION	= 1.3.14
VDATE	= 01 March 2009
@


1.100
log
@Versioning up.
@
text
@d170 14
a183 14
	mkdir -p $(DESTDIR)$(BINDIR)
	mkdir -p $(DESTDIR)$(INCLUDEDIR)
	mkdir -p $(DESTDIR)$(LIBDIR)/lib
	mkdir -p $(DESTDIR)$(MANDIR)/man1
	mkdir -p $(DESTDIR)$(MANDIR)/man3
	$(INSTALL_PROGRAM) mdocterm $(DESTDIR)$(BINDIR)
	$(INSTALL_PROGRAM) mdoctree $(DESTDIR)$(BINDIR)
	$(INSTALL_PROGRAM) mdoclint $(DESTDIR)$(BINDIR)
	$(INSTALL_MAN) mdocterm.1 $(DESTDIR)$(MANDIR)/man1
	$(INSTALL_MAN) mdoctree.1 $(DESTDIR)$(MANDIR)/man1
	$(INSTALL_MAN) mdoclint.1 $(DESTDIR)$(MANDIR)/man1
	$(INSTALL_MAN) mdoc.3 $(DESTDIR)$(MANDIR)/man3
	$(INSTALL_LIB) libmdoc.a $(DESTDIR)$(LIBDIR)
	$(INSTALL_DATA) mdoc.h $(DESTDIR)$(INCLUDEDIR)
d186 9
a194 9
	rm -f $(DESTDIR)$(BINDIR)/mdocterm
	rm -f $(DESTDIR)$(BINDIR)/mdoctree
	rm -f $(DESTDIR)$(BINDIR)/mdoclint
	rm -f $(DESTDIR)$(MANDIR)/man1/mdocterm.1
	rm -f $(DESTDIR)$(MANDIR)/man1/mdoctree.1
	rm -f $(DESTDIR)$(MANDIR)/man1/mdoclint.1
	rm -f $(DESTDIR)$(MANDIR)/man3/mdoc.3
	rm -f $(DESTDIR)$(LIBDIR)/libmdoc.a
	rm -f $(DESTDIR)$(INCLUDEDIR)/mdoc.h
@


1.99
log
@Applying Joerg Sonnenberger's patch.
@
text
@d3 1
a3 1
VERSION	= 1.3.13
@


1.98
log
@Versioning up.
@
text
@d6 10
d170 14
a183 13
	mkdir -p $(PREFIX)/bin/
	mkdir -p $(PREFIX)/include/mdoc/
	mkdir -p $(PREFIX)/lib/
	mkdir -p $(PREFIX)/man/man1/
	install -m 0755 mdocterm $(PREFIX)/bin/
	install -m 0755 mdoctree $(PREFIX)/bin/
	install -m 0755 mdoclint $(PREFIX)/bin/
	install -m 0444 mdocterm.1 $(PREFIX)/man/man1/
	install -m 0444 mdoctree.1 $(PREFIX)/man/man1/
	install -m 0444 mdoclint.1 $(PREFIX)/man/man1/
	install -m 0444 mdoc.3 $(PREFIX)/man/man3/
	install -m 0644 libmdoc.a $(PREFIX)/lib/
	install -m 0444 mdoc.h $(PREFIX)/include/
d186 9
a194 9
	rm -f $(PREFIX)/bin/mdocterm
	rm -f $(PREFIX)/bin/mdoctree
	rm -f $(PREFIX)/bin/mdoclint
	rm -f $(PREFIX)/man/man1/mdocterm.1
	rm -f $(PREFIX)/man/man1/mdoctree.1
	rm -f $(PREFIX)/man/man1/mdoclint.1
	rm -f $(PREFIX)/man/man3/mdoc.3
	rm -f $(PREFIX)/lib/libmdoc.a
	rm -f $(PREFIX)/include/mdoc.h
@


1.97
log
@*** empty log message ***
@
text
@d3 2
a4 2
VERSION	= 1.3.12
VDATE	= 28 February 2009
@


1.96
log
@*** empty log message ***
@
text
@d3 1
a3 1
VERSION	= 1.3.11
@


1.95
log
@Version up.
@
text
@d3 1
a3 1
VERSION	= 1.3.10
@


1.94
log
@Added support for dynamic -width detection for -tag lists.
@
text
@d3 1
a3 1
VERSION	= 1.3.9
@


1.93
log
@Version up.
@
text
@d117 1
@


1.92
log
@Version up.
@
text
@d3 1
a3 1
VERSION	= 1.3.8
@


1.91
log
@More pkgsrc stuff.
@
text
@d3 2
a4 2
VERSION	= 1.3.6
VDATE	= 27 February 2009
@


1.90
log
@Initial NetBSD pkgsrc.
@
text
@d45 2
a46 1
TARGZS	= mdocml-$(VERSION).tar.gz mdocml-oport-$(VERSION).tar.gz
d144 1
a145 1
	install -m 0444 mdocml-$(VERSION).tar.gz $(PREFIX)/snapshots/mdocml.tar.gz
d147 2
@


1.89
log
@Lintified sources.
@
text
@d54 2
a55 2
INSTALL	= $(SRCS) $(HEADS) Makefile Makefile.port DESCR $(MANS) \
	  $(SGMLS) $(STATICS)
d136 1
a136 1
port:	mdocml-oport-$(VERSION).tar.gz
d226 22
a247 1
mdocml-oport-$(VERSION).tar.gz: mdocml-$(VERSION).tar.gz Makefile.port DESCR
d249 1
a249 1
	sed -e "s!@@VERSION@@!$(VERSION)!" Makefile.port > \
@


1.88
log
@Versioning up.
@
text
@d131 3
d147 1
a147 1
regress::
@


1.87
log
@More character-encoding.
@
text
@d3 2
a4 2
VERSION	= 1.3.5
VDATE	= 25 February 2009
@


1.86
log
@Fixed version-date tag.
@
text
@d90 3
a92 1
	  regress/test.escape.09
d119 2
a120 1
	  regress/test.escape.05
@


1.85
log
@Version printed on website.
@
text
@d3 2
a4 2
VERSION	= "1.3.5"
VDATE	= "25 February 2009"
@


1.84
log
@Added character-encoding checks.
@
text
@d3 2
a4 1
VERSION	= 1.3.3
d272 2
a273 1
	cp -f $< $@@
@


1.83
log
@Escape-sequence validation in place (for nodes).
@
text
@d85 5
a89 1
	  regress/test.escape.04
d115 2
a116 1
	  regress/test.escape.00
@


1.82
log
@Considerably cleaned up the validation code.
@
text
@d81 5
a85 3
	  regress/test.sh.01 \
	  regress/test.sh.02 \
	  regress/test.sh.03
d108 4
a111 1
	  regress/test.list.06
@


1.81
log
@Port works.
@
text
@d130 1
a130 1
regress:: mdoclint
@


1.80
log
@Fixing port generation & instructions.
@
text
@d3 1
a3 1
VERSION	= 1.3.0
d44 3
a46 1
MANS	= mdoctree.1 mdocterm.1 mdoc.3
d50 2
a51 1
CLEAN	= $(BINS) $(LNS) $(LLNS) $(LIBS) $(OBJS) $(HTMLS)
d108 2
d121 1
a121 1
www:	$(HTMLS)
d125 4
d145 1
d147 2
a148 1
	install -m 0444 mdocterm.1 $(PREFIX)/man/man1/
a152 6
install-dist: mdocml-$(VERSION).tar.gz mdocml-oport-$(VERSION).tar.gz
	install -m 0644 mdocml-$(VERSION).tar.gz $(PREFIX)/
	install -m 0644 mdocml-$(VERSION).tar.gz $(PREFIX)/mdocml.tar.gz
	install -m 0644 mdocml-oport-$(VERSION).tar.gz $(PREFIX)/
	install -m 0644 mdocml-oport-$(VERSION).tar.gz $(PREFIX)/mdocml-oport.tar.gz

d156 1
d159 1
d209 1
a209 1
mdocml-oport-$(VERSION).tar.gz: Makefile.port DESCR
d211 2
a212 1
	sed -e "s!@@VERSION@@!$(VERSION)!" Makefile.port > .dist/mdocml/Makefile
d232 1
d234 1
@


1.79
log
@Adding revamped webpage.
@
text
@d118 3
@


1.78
log
@Added mdoclint.
`make regress' uses mdoclint
@
text
@d1 2
d38 6
d48 1
a48 1
CLEAN	= $(BINS) $(LNS) $(LLNS) $(LIBS) $(OBJS)
d50 2
a51 1
INSTALL	= $(SRCS) $(HEADS) Makefile Makefile.port DESCR $(MANS)
d116 2
d245 4
@


1.77
log
@termact.c -> term.c
term.c -> mdocterm.c
tree.c -> mdoctree.c
Fixed/finished mmain.h.
@
text
@d12 2
d27 2
d32 1
a32 1
	  action.c term.c mdoctree.c mdocterm.c mmain.c
d38 1
a38 1
BINS	= mdocterm mdoctree
d71 1
a71 4
	  regress/test.sh.03 \
	  regress/test.name.01 \
	  regress/test.name.02 \
	  regress/test.name.03
d85 3
d107 1
a107 1
regress:: mdocml
d109 2
a110 2
		echo "./mdocml $$f" ; \
		./mdocml $$f 2>/dev/null || continue ; exit 1 ; done
d112 2
a113 2
		echo "./mdocml $$f" ; \
		./mdocml $$f 2>/dev/null || exit 1 ; done
d161 3
d198 1
d203 1
d232 2
@


1.76
log
@BROKEN BUILD: migrating to mmain stuff.
@
text
@d8 1
a8 1
TREELNS	= mdoctree.ln mmain.ln tree.ln 
d10 1
a10 1
TERMLNS	= mdoctree.ln mmain.ln term.ln termact.ln
d21 1
a21 1
TERMOBJS= mdocterm.o mmain.o term.o termact.o
d23 1
a23 1
TREEOBJS= mdoctree.o mmain.o tree.o 
d28 1
a28 2
	  action.c term.c tree.c termact.c mdoctree.c mdocterm.c \
	  mmain.c
a141 3
tree.ln: tree.c mdoc.h
tree.o: tree.c mdoc.h

a144 3
termact.ln: termact.c term.h 
termact.o: termact.c term.h

@


1.75
log
@Split mdocml -> mdocterm, mdoctree (new manuals, etc.).
Escape-recognition term.c.
@
text
@d8 1
a8 1
TREELNS	= mdoctree.ln tree.ln 
d10 1
a10 1
TERMLNS	= mdoctree.ln term.ln termact.ln
d21 1
a21 1
TERMOBJS= mdocterm.o term.o termact.o
d23 1
a23 1
TREEOBJS= mdoctree.o tree.o 
d28 2
a29 1
	  action.c term.c tree.c termact.c mdoctree.c mdocterm.c
d31 1
a31 1
HEADS	= mdoc.h private.h term.h
a140 1

a143 1

a146 1

a149 1

a152 1

a155 1

a158 1

d161 2
a162 3
mdocterm.ln: mdocterm.c term.h

mdocterm.o: mdocterm.c term.h
d164 2
a165 3
mdoctree.ln: mdoctree.c mdoc.h

mdoctree.o: mdoctree.c mdoc.h
a167 1

a170 1

a173 1

d177 1
d179 2
a180 1
action.o: action.c private.h
d184 4
@


1.74
log
@Split down term.c into term.h, termact.c.
@
text
@d1 1
a1 1
VERSION	= 1.2.0
d8 1
a8 1
BINLNS	= mdocml.ln term.ln tree.ln termact.ln
d10 1
a10 1
LNS	= $(LIBLNS) $(BINLNS)
d12 3
a14 1
LLNS	= llib-llibmdoc.ln llib-lmdocml.ln
d19 3
a21 1
	  validate.o action.o 
d23 1
a23 1
BINOBJS	= mdocml.o term.o tree.o termact.o
d25 1
a25 1
OBJS	= $(LIBOBJS) $(BINOBJS)
d27 2
a28 2
SRCS	= macro.c mdoc.c mdocml.c hash.c strings.c xstd.c argv.c \
	  validate.c action.c term.c tree.c termact.c
d32 1
a32 1
MANS	= mdocml.1 mdoc.3
d34 1
a34 1
BINS	= mdocml
d116 4
a119 2
	install -m 0755 mdocml $(PREFIX)/bin/
	install -m 0444 mdocml.1 $(PREFIX)/man/man1/
d131 4
a134 2
	rm -f $(PREFIX)/bin/mdocml
	rm -f $(PREFIX)/man/man1/mdocml.1
d167 3
a169 1
mdocml.ln: mdocml.c mdoc.h
d171 3
a173 1
mdocml.o: mdocml.c mdoc.h
d201 2
a202 1
	echo bin/mdocml >> .dist/mdocml/pkg/PLIST
d205 2
a206 1
	echo @@man man/man1/mdocml.1 >> .dist/mdocml/pkg/PLIST
d220 5
a224 2
llib-lmdocml.ln: $(BINLNS) llib-llibmdoc.ln
	$(LINT) $(LINTFLAGS) -Cmdocml $(BINLNS) llib-llibmdoc.ln
d229 5
a233 2
mdocml:	$(BINOBJS) libmdoc.a
	$(CC) $(CFLAGS) -o $@@ $(BINOBJS) libmdoc.a 
@


1.73
log
@Initial list support (not nested, yet).
@
text
@d8 1
a8 1
BINLNS	= mdocml.ln term.ln tree.ln
d19 1
a19 1
BINOBJS	= mdocml.o term.o tree.o
d24 1
a24 1
	  validate.c action.c 
d26 1
a26 1
HEADS	= mdoc.h private.h
d139 1
a139 1
term.ln: term.c private.h
d141 5
a145 1
term.o: term.c private.h
d213 1
a213 1
	$(CC) $(CFLAGS) -o $@@ $(BINOBJS) libmdoc.a -lcurses
@


1.72
log
@More flesh in terminal-encoder.
@
text
@d3 1
a3 1
CFLAGS += -W -Wall -Wno-unused-parameter -g 
@


1.71
log
@Re-added tree.c (for now).
Added initial terminal-output filter (term.c).
@
text
@d139 1
a139 1
term.ln: term.c mdoc.h
d141 1
a141 1
term.o: term.c mdoc.h
@


1.70
log
@Removed (moving) tree.c.
@
text
@d8 1
a8 1
BINLNS	= mdocml.ln
d19 1
a19 1
BINOBJS	= mdocml.o
d135 8
d209 1
a209 1
	$(CC) $(CFLAGS) -o $@@ $(BINOBJS) libmdoc.a
@


1.69
log
@Removed tree-writing capability (for now, only validates and exits).
@
text
@d8 1
a8 1
BINLNS	= tree.ln mdocml.ln
d19 1
a19 1
BINOBJS	= tree.o mdocml.o
d24 1
a24 1
	  validate.c action.c tree.c 
a138 4
tree.ln: tree.c mdoc.h

tree.o: tree.c mdoc.h

@


1.68
log
@Fix-ups to macro.c.
@
text
@d6 1
a6 1
	  validate.ln action.ln
d17 1
a17 1
	  validate.o action.o
d24 1
a24 1
	  validate.c action.c tree.c
@


1.67
log
@Finished proper parsing of -column macros.
@
text
@d99 1
a99 1
regress::
@


1.66
log
@*** empty log message ***
@
text
@d84 3
a86 1
	  regress/test.list.04
@


1.65
log
@More validation on prologue/first NAME section.
@
text
@d79 6
a84 1
	  regress/test.name.00
@


1.64
log
@Added regression tests (just for prologue, for now).
Minor fixes in parsing prologue.
@
text
@d51 16
a66 1
	  regress/test.prologue.24
d77 3
a79 1
	  regress/test.prologue.20
@


1.63
log
@Added manual pages to INSTALL.
@
text
@d36 28
d75 8
@


1.62
log
@Tagged version.
@
text
@d28 2
d34 1
a34 1
INSTALL	= $(SRCS) $(HEADS) Makefile Makefile.port DESCR
@


1.61
log
@More documentation/installation fixes.
@
text
@d1 1
a1 1
VERSION	= 1.1.0
@


1.60
log
@Re-merged old port-building routines.
@
text
@d56 6
@


1.59
log
@Added tests to makefile.
@
text
@d5 6
a10 1
LNS	= macro.ln mdoc.ln mdocml.ln hash.ln strings.ln xstd.ln argv.ln validate.ln action.ln tree.ln
d16 6
a21 1
OBJS	= macro.o mdoc.o mdocml.o hash.o strings.o xstd.o argv.o validate.o action.o tree.o
d23 2
a24 1
SRCS	= macro.c mdoc.c mdocml.c hash.c strings.c xstd.c argv.c validate.c action.c tree.c
d26 1
a26 1
HEADS	= mdoc.h
d32 1
a32 13
SUCCESS	= test.1 test.7 test.8 test.9 test.11 test.11 test.12 test.16 \
	  test.17 test.19 test.20 test.21 test.23 test.25 test.27     \
	  test.28 test.29 test.31 test.32 test.33 test.34 test.35     \
	  test.38 test.39 test.40 test.41 test.42 test.43 test.44     \
	  test.45 test.46 test.47 test.49 test.51 test.52 test.53     \
	  test.54 test.55 test.56 test.57 test.58 test.59 test.60     \
	  test.62 test.67 test.68 test.71 test.72 test.73 test.74     \
	  test.75

FAIL	= test.0 test.2 test.3 test.4 test.5 test.6 test.13 test.14   \
	  test.15 test.18 test.22 test.24 test.26 test.30 test.36     \
	  test.37 test.48 test.50 test.61 test.63 test.64 test.65     \
	  test.66 test.69 test.70
a37 3
mdocml:	mdocml.o tree.o libmdoc.a
	$(CC) $(CFLAGS) -o $@@ mdocml.o tree.o libmdoc.a

d41 1
a41 5
regress: mdocml $(SUCCESS) $(FAIL)
	@@for f in $(SUCCESS) ; do \
		echo "./mdocml $$f" ; \
		./mdocml $$f || exit 1 ; \
	done
d43 1
a43 2
llib-llibmdoc.ln: macro.ln mdoc.ln hash.ln strings.ln xstd.ln argv.ln validate.ln action.ln
	$(LINT) $(LINTFLAGS) -Clibmdoc mdoc.ln macro.ln hash.ln strings.ln xstd.ln argv.ln validate.ln action.ln
d45 17
a61 2
llib-lmdocml.ln: mdocml.ln tree.ln llib-llibmdoc.ln
	$(LINT) $(LINTFLAGS) -Cmdocml mdocml.ln tree.ln llib-llibmdoc.ln
d105 33
a137 2
libmdoc.a: macro.o mdoc.o hash.o strings.o xstd.o argv.o validate.o action.o
	$(AR) rs $@@ macro.o mdoc.o hash.o strings.o xstd.o argv.o validate.o action.o
@


1.58
log
@Separating output filters.
@
text
@d21 14
d45 6
@


1.57
log
@*** empty log message ***
@
text
@d5 1
a5 1
LNS	= macro.ln mdoc.ln mdocml.ln hash.ln strings.ln xstd.ln argv.ln validate.ln action.ln
d11 1
a11 1
OBJS	= macro.o mdoc.o mdocml.o hash.o strings.o xstd.o argv.o validate.o action.o
d13 1
a13 1
SRCS	= macro.c mdoc.c mdocml.c hash.c strings.c xstd.c argv.c validate.c action.c
d25 2
a26 2
mdocml:	mdocml.o libmdoc.a
	$(CC) $(CFLAGS) -o $@@ mdocml.o libmdoc.a
d34 2
a35 2
llib-lmdocml.ln: mdocml.ln llib-llibmdoc.ln
	$(LINT) $(LINTFLAGS) -Cmdocml mdocml.ln llib-llibmdoc.ln
d45 4
@


1.56
log
@Actions and validations properly added.
@
text
@d5 1
a5 1
LNS	= macro.ln mdoc.ln mdocml.ln hash.ln strings.ln xstd.ln argv.ln validate.ln prologue.ln action.ln
d11 1
a11 1
OBJS	= macro.o mdoc.o mdocml.o hash.o strings.o xstd.o argv.o validate.o prologue.o action.o
d13 1
a13 1
SRCS	= macro.c mdoc.c mdocml.c hash.c strings.c xstd.c argv.c validate.c prologue.c action.c
d31 2
a32 2
llib-llibmdoc.ln: macro.ln mdoc.ln hash.ln strings.ln xstd.ln argv.ln validate.ln prologue.ln action.ln
	$(LINT) $(LINTFLAGS) -Clibmdoc mdoc.ln macro.ln hash.ln strings.ln xstd.ln argv.ln validate.ln prologue.ln action.ln
a68 4
prologue.ln: prologue.c private.h

prologue.o: prologue.c private.h

d75 2
a76 2
libmdoc.a: macro.o mdoc.o hash.o strings.o xstd.o argv.o validate.o prologue.o action.o
	$(AR) rs $@@ macro.o mdoc.o hash.o strings.o xstd.o argv.o validate.o prologue.o action.o
@


1.55
log
@Broke apart macro_prologuexxx into prologue.
Fixed validation for line-scoped.
Merged const_arg and const.
@
text
@d5 1
a5 1
LNS	= macro.ln mdoc.ln mdocml.ln hash.ln strings.ln xstd.ln argv.ln validate.ln prologue.ln
d11 1
a11 1
OBJS	= macro.o mdoc.o mdocml.o hash.o strings.o xstd.o argv.o validate.o prologue.o
d13 1
a13 1
SRCS	= macro.c mdoc.c mdocml.c hash.c strings.c xstd.c argv.c validate.c prologue.c
d31 2
a32 2
llib-llibmdoc.ln: macro.ln mdoc.ln hash.ln strings.ln xstd.ln argv.ln validate.ln prologue.ln
	$(LINT) $(LINTFLAGS) -Clibmdoc mdoc.ln macro.ln hash.ln strings.ln xstd.ln argv.ln validate.ln prologue.ln
d73 4
d79 2
a80 2
libmdoc.a: macro.o mdoc.o hash.o strings.o xstd.o argv.o validate.o prologue.o
	$(AR) rs $@@ macro.o mdoc.o hash.o strings.o xstd.o argv.o validate.o prologue.o
@


1.54
log
@Validation fully works.
@
text
@d5 1
a5 1
LNS	= macro.ln mdoc.ln mdocml.ln hash.ln strings.ln xstd.ln argv.ln validate.ln
d11 1
a11 1
OBJS	= macro.o mdoc.o mdocml.o hash.o strings.o xstd.o argv.o validate.o
d13 1
a13 1
SRCS	= macro.c mdoc.c mdocml.c hash.c strings.c xstd.c argv.c validate.c
d31 2
a32 2
llib-llibmdoc.ln: macro.ln mdoc.ln hash.ln strings.ln xstd.ln argv.ln validate.ln
	$(LINT) $(LINTFLAGS) -Clibmdoc mdoc.ln macro.ln hash.ln strings.ln xstd.ln argv.ln validate.ln
d69 4
d75 2
a76 2
libmdoc.a: macro.o mdoc.o hash.o strings.o xstd.o argv.o validate.o
	$(AR) rs $@@ macro.o mdoc.o hash.o strings.o xstd.o argv.o validate.o
@


1.53
log
@*** empty log message ***
@
text
@d5 1
a5 1
LNS	= macro.ln mdoc.ln mdocml.ln hash.ln strings.ln xstd.ln argv.ln
d11 1
a11 1
OBJS	= macro.o mdoc.o mdocml.o hash.o strings.o xstd.o argv.o
d13 1
a13 1
SRCS	= macro.c mdoc.c mdocml.c hash.c strings.c xstd.c argv.c
d31 2
a32 2
llib-llibmdoc.ln: macro.ln mdoc.ln hash.ln strings.ln xstd.ln argv.ln
	$(LINT) $(LINTFLAGS) -Clibmdoc mdoc.ln macro.ln hash.ln strings.ln xstd.ln argv.ln
d65 4
d71 2
a72 2
libmdoc.a: macro.o mdoc.o hash.o strings.o xstd.o argv.o
	$(AR) rs $@@ macro.o mdoc.o hash.o strings.o xstd.o argv.o
@


1.52
log
@*** empty log message ***
@
text
@d5 1
a5 1
LNS	= macro.ln mdoc.ln mdocml.ln hash.ln strings.ln
d11 1
a11 1
OBJS	= macro.o mdoc.o mdocml.o hash.o strings.o
d13 1
a13 1
SRCS	= macro.c mdoc.c mdocml.c hash.c strings.c
d31 2
a32 2
llib-llibmdoc.ln: macro.ln mdoc.ln hash.ln strings.ln
	$(LINT) $(LINTFLAGS) -Clibmdoc mdoc.ln macro.ln hash.ln strings.ln
d57 8
d67 2
a68 2
libmdoc.a: macro.o mdoc.o hash.o strings.o
	$(AR) rs $@@ macro.o mdoc.o hash.o strings.o
@


1.51
log
@Linted.
@
text
@d5 1
a5 1
LNS	= macro.ln mdoc.ln mdocml.ln hash.ln
d11 1
a11 1
OBJS	= macro.o mdoc.o mdocml.o hash.o
d13 1
a13 1
SRCS	= macro.c mdoc.c mdocml.c hash.c
d31 2
a32 2
llib-llibmdoc.ln: macro.ln mdoc.ln hash.ln
	$(LINT) $(LINTFLAGS) -Clibmdoc mdoc.ln macro.ln hash.ln
d41 4
d59 2
a60 2
libmdoc.a: macro.o mdoc.o hash.o
	$(AR) rs $@@ macro.o mdoc.o hash.o
@


1.50
log
@Purged all old files in favour of new design.  Selective reintegration.
@
text
@d32 1
a32 1
	$(LINT) $(LINTFLAGS) -Cllibmdoc mdoc.ln macro.ln hash.ln
d34 2
a35 2
llib-llmdocml.ln: mdocml.ln llib-llibmdoc.ln
	$(LINT) $(LINTFLAGS) -Cllibmdoc mdocml.ln llib-llibmdoc.ln
@


1.49
log
@Prettier HTML.
@
text
@d1 1
a1 1
VERSION	= 1.0.3
d3 1
a3 2
# FIXME
CFLAGS += -W -Wall -Wno-unused-parameter -g -DDEBUG
d5 1
a5 2
LNS	= mdocml.ln html.ln xml.ln libmdocml.ln roff.ln ml.ln mlg.ln \
	  compat.ln tokens.ln literals.ln tags.ln noop.ln
d7 1
a7 1
LLNS	= llib-lmdocml.ln
d9 1
a9 1
LIBS	= libmdocml.a
d11 1
a11 2
OBJS	= mdocml.o html.o xml.o libmdocml.o roff.o ml.o mlg.o \
	  compat.o tokens.o literals.o tags.o noop.o
d13 1
a13 2
SRCS	= mdocml.c html.c xml.c libmdocml.c roff.c ml.c mlg.c \
	  compat.c tokens.c literals.c tags.c noop.c
d15 1
a15 1
HEADS	= libmdocml.h private.h ml.h roff.h html.h
d17 1
a17 1
MANS	= mdocml.1 index.7
d19 1
a19 1
HTML	= index.html mdocml.html 
d21 1
a21 1
XML	= index.xml
d23 1
a23 1
TEXT	= index.txt
d25 2
a26 38
CLEAN	= mdocml $(LLNS) $(LNS) $(OBJS) $(LIBS) $(HTML) $(XML) $(TEXT) \
	  mdocml-$(VERSION).tar.gz mdocml-port-$(VERSION).tar.gz

INSTALL	= Makefile $(HEADS) $(SRCS) $(MANS) mdocml.css

FAIL	= test.0 test.1 test.2 test.3 test.4 test.5 test.6 \
	  test.15 test.20 test.22 test.24 test.26 test.27 test.30 \
	  test.36 test.37 test.40 test.50 test.61 test.64 test.65 \
	  test.66 test.69 test.70

SUCCEED	= test.7 test.8 test.9 test.10 test.11 test.12 test.13 \
	  test.14 test.16 test.17 test.18 test.19 test.21 test.23 \
	  test.25 test.28 test.29 test.31 test.32 test.33 test.34 \
	  test.35 test.38 test.39 test.41 test.42 test.43 test.44 \
	  test.45 test.46 test.47 test.48 test.49 test.51 test.52 \
	  test.54 test.55 test.56 test.57 test.58 test.59 test.60 \
	  test.62 test.63 test.67 test.68 test.71 test.72 test.73

all: mdocml

lint: llib-lmdocml.ln

dist: mdocml-$(VERSION).tar.gz mdocml-port-$(VERSION).tar.gz

www: all $(HTML) $(XML) $(TEXT)

regress: mdocml
	@@for f in $(FAIL); do \
		echo "./mdocml $$f" ; \
		./mdocml -v $$f 1>/dev/null 2>/dev/null || continue ; \
	done
	@@for f in $(SUCCEED); do \
		echo "./mdocml $$f" ; \
		./mdocml -v $$f 1>/dev/null || exit 1 ; \
	done

mdocml: mdocml.o libmdocml.a
	$(CC) $(CFLAGS) -o $@@ mdocml.o libmdocml.a
d31 2
a32 81
index.html: index.7 mdocml.css
	./mdocml -fhtml -Wall -e -o $@@ index.7

index.xml: index.7 mdocml.css
	./mdocml -fxml -Wall -o $@@ index.7

index.txt: index.7
	cp -f index.7 index.txt

mdocml.html: mdocml.1 mdocml.css
	./mdocml -Wall -fhtml -e -o $@@ mdocml.1

install:
	mkdir -p $(PREFIX)/bin/
	install -m 0755 mdocml $(PREFIX)/bin/
	mkdir -p $(PREFIX)/man/man1/
	install -m 0444 mdocml.1 $(PREFIX)/man/man1/
	mkdir -p $(PREFIX)/share/mdocml/
	install -m 0444 mdocml.css $(PREFIX)/share/mdocml/

uninstall:
	rm -f $(PREFIX)/bin/mdocml
	rm -f $(PREFIX)/man/man1/mdocml.1
	rm -f $(PREFIX)/share/mdocml/mdocml.css

install-www: www dist
	install -m 0644 mdocml-$(VERSION).tar.gz $(PREFIX)/
	install -m 0644 mdocml-$(VERSION).tar.gz $(PREFIX)/mdocml.tar.gz
	install -m 0644 mdocml-port-$(VERSION).tar.gz $(PREFIX)/
	install -m 0644 mdocml-port-$(VERSION).tar.gz $(PREFIX)/mdocml-port.tar.gz
	install -m 0644 $(HTML) $(XML) $(TEXT) $(PREFIX)/

mdocml-$(VERSION).tar.gz: $(INSTALL)
	mkdir -p .dist/mdocml/mdocml-$(VERSION)/
	install -m 0644 $(INSTALL) .dist/mdocml/mdocml-$(VERSION)/
	( cd .dist/mdocml/ && tar zcf ../../$@@ mdocml-$(VERSION)/ )
	rm -rf .dist/

mdocml-port-$(VERSION).tar.gz: $(INSTALL)
	mkdir -p .dist/mdocml/pkg
	sed -e "s!@@VERSION@@!$(VERSION)!" Makefile.port > .dist/mdocml/Makefile
	md5 mdocml-$(VERSION).tar.gz > .dist/mdocml/distinfo
	rmd160 mdocml-$(VERSION).tar.gz >> .dist/mdocml/distinfo
	sha1 mdocml-$(VERSION).tar.gz >> .dist/mdocml/distinfo
	install -m 0644 DESCR .dist/mdocml/pkg/DESCR
	echo @@comment $$OpenBSD$$ > .dist/mdocml/pkg/PLIST
	echo bin/mdocml >> .dist/mdocml/pkg/PLIST
	echo share/mdocml/mdocml.css >> .dist/mdocml/pkg/PLIST
	echo @@man man/man1/mdocml.1 >> .dist/mdocml/pkg/PLIST
	( cd .dist/ && tar zcf ../$@@ mdocml/ )
	rm -rf .dist/

llib-lmdocml.ln: mdocml.ln libmdocml.ln html.ln xml.ln roff.ln ml.ln mlg.ln compat.ln tokens.ln literals.ln tags.ln noop.ln
	$(LINT) $(LINTFLAGS) -Cmdocml mdocml.ln libmdocml.ln html.ln xml.ln roff.ln ml.ln mlg.ln compat.ln tokens.ln literals.ln tags.ln noop.ln

mdocml.ln: mdocml.c libmdocml.h

mdocml.o: mdocml.c libmdocml.h

libmdocml.a: libmdocml.o html.o xml.o roff.o ml.o mlg.o compat.o tokens.o literals.o tags.o noop.o
	$(AR) rs $@@ libmdocml.o html.o xml.o roff.o ml.o mlg.o compat.o tokens.o literals.o tags.o noop.o

xml.ln: xml.c ml.h

xml.o: xml.c ml.h

html.ln: html.c private.h

html.o: html.c private.h 

tags.ln: tags.c html.h 

tags.o: tags.c html.h

roff.ln: roff.c private.h

roff.o: roff.c private.h 

libmdocml.ln: libmdocml.c private.h

libmdocml.o: libmdocml.c private.h
d34 2
a35 1
ml.ln: ml.c ml.h
d37 1
a37 1
ml.o: ml.c ml.h
d39 1
a39 1
mlg.ln: mlg.c ml.h
d41 1
a41 1
mlg.o: mlg.c ml.h
d43 1
a43 1
compat.ln: compat.c
d45 1
a45 1
compat.o: compat.c
d47 1
a47 1
noop.ln: noop.c private.h
d49 1
a49 1
noop.o: noop.c private.h
d51 1
a51 1
html.h: ml.h
d53 1
a53 1
ml.h: private.h
d55 2
a56 1
private.h: libmdocml.h
@


1.48
log
@Ready for looking over by people.
@
text
@d4 1
a4 1
CFLAGS += -W -Wall -Wno-unused-parameter -g
@


1.47
log
@Made noop the default filter.
@
text
@d4 1
a4 1
CFLAGS += -W -Wall -Wno-unused-parameter -g -DDEBUG
d29 2
a30 2
CLEAN	= mdocml mdocml.tgz $(LLNS) $(LNS) $(OBJS) $(LIBS) $(HTML) \
	  $(XML) $(TEXT)
d32 1
a32 1
INSTALL	= Makefile $(HEADS) $(SRCS) $(MANS)
d51 1
a51 1
dist: mdocml.tgz mdocml-port.tgz
d72 1
a72 1
	./mdocml -Wall -fhtml -e -o $@@ index.7
d75 1
a75 1
	./mdocml -Wall -o $@@ index.7
d83 13
d97 4
a100 4
	install -m 0644 mdocml.tgz $(PREFIX)/mdocml-$(VERSION).tgz
	install -m 0644 mdocml.tgz $(PREFIX)/mdocml.tgz
	install -m 0644 mdocml-port.tgz $(PREFIX)/mdocml-port-$(VERSION).tgz
	install -m 0644 mdocml-port.tgz $(PREFIX)/mdocml-port.tgz
d103 1
a103 1
mdocml.tgz: $(INSTALL)
d109 1
a109 1
mdocml-port.tgz: $(INSTALL)
d112 3
a114 3
	md5 mdocml-$(VERSION).tgz > .dist/mdocml/distinfo
	rmd160 mdocml-$(VERSION).tgz >> .dist/mdocml/distinfo
	sha1 mdocml-$(VERSION).tgz >> .dist/mdocml/distinfo
d118 1
@


1.46
log
@Sx to Sh anchors work.
@
text
@d1 1
a1 1
VERSION	= 1.0.2
d7 1
a7 1
	  compat.ln tokens.ln literals.ln tags.ln
d14 1
a14 1
	  compat.o tokens.o literals.o tags.o
d17 1
a17 1
	  compat.c tokens.c literals.c tags.c
d109 2
a110 2
llib-lmdocml.ln: mdocml.ln libmdocml.ln html.ln xml.ln roff.ln ml.ln mlg.ln compat.ln tokens.ln literals.ln tags.ln
	$(LINT) $(LINTFLAGS) -Cmdocml mdocml.ln libmdocml.ln html.ln xml.ln roff.ln ml.ln mlg.ln compat.ln tokens.ln literals.ln tags.ln
d116 2
a117 2
libmdocml.a: libmdocml.o html.o xml.o roff.o ml.o mlg.o compat.o tokens.o literals.o tags.o
	$(AR) rs $@@ libmdocml.o html.o xml.o roff.o ml.o mlg.o compat.o tokens.o literals.o tags.o
d119 1
a119 1
xml.ln: xml.c private.h libmdocml.h ml.h
d121 1
a121 1
xml.o: xml.c private.h libmdocml.h ml.h
d123 1
a123 1
html.ln: html.c private.h libmdocml.h
d125 1
a125 1
html.o: html.c private.h libmdocml.h
d131 1
a131 1
roff.ln: roff.c private.h roff.h libmdocml.h
d133 1
a133 1
roff.o: roff.c private.h roff.h libmdocml.h
d135 1
a135 1
libmdocml.ln: libmdocml.c private.h libmdocml.h
d137 1
a137 1
libmdocml.o: libmdocml.c private.h libmdocml.h
d139 1
a139 1
ml.ln: ml.c private.h libmdocml.h ml.h
d141 1
a141 1
ml.o: ml.c private.h libmdocml.h ml.h
d143 1
a143 1
mlg.ln: mlg.c private.h libmdocml.h ml.h
d145 1
a145 1
mlg.o: mlg.c private.h libmdocml.h ml.h
d151 4
@


1.45
log
@Put prelude checking into asec.
@
text
@d45 1
a45 1
	  test.62 test.63 test.67 test.68 test.71
@


1.44
log
@*** empty log message ***
@
text
@d51 1
a51 1
dist: mdocml.tgz
d86 2
d93 14
a106 1
	( cd .dist/mdocml/ && tar zcf ../../mdocml.tgz mdocml-$(VERSION)/ )
@


1.43
log
@Linted on NetBSD side.
@
text
@d86 1
a86 1
	install -m 0644 $(HTML) $(XML) $(PREFIX)/
@


1.42
log
@Versioning up.
@
text
@d1 1
a1 1
VERSION	= 1.0.1
a5 2
LINTFLAGS += -c -e -f -u

@


1.41
log
@*** empty log message ***
@
text
@a0 2
.SUFFIXES:	.html .7

d29 2
d32 1
a32 1
	  $(XML)
d55 1
a55 1
www: all $(HTML) $(XML)
d79 3
@


1.40
log
@*** empty log message ***
@
text
@d39 1
a39 1
	  test.66
d47 1
a47 1
	  test.62 test.63 test.67
@


1.39
log
@*** empty log message ***
@
text
@d55 1
a55 1
www: $(HTML) $(XML)
@


1.38
log
@*** empty log message ***
@
text
@d11 1
a11 1
	  compat.ln tokens.ln literals.ln
d18 1
a18 1
	  compat.o tokens.o literals.o
d21 1
a21 1
	  compat.c tokens.c literals.c
d23 1
a23 1
HEADS	= libmdocml.h private.h ml.h roff.h
d93 2
a94 2
llib-lmdocml.ln: mdocml.ln libmdocml.ln html.ln xml.ln roff.ln ml.ln mlg.ln compat.ln tokens.ln literals.ln
	$(LINT) $(LINTFLAGS) -Cmdocml mdocml.ln libmdocml.ln html.ln xml.ln roff.ln ml.ln mlg.ln compat.ln tokens.ln literals.ln
d100 2
a101 2
libmdocml.a: libmdocml.o html.o xml.o roff.o ml.o mlg.o compat.o tokens.o literals.o
	$(AR) rs $@@ libmdocml.o html.o xml.o roff.o ml.o mlg.o compat.o tokens.o literals.o
d111 4
d134 7
@


1.37
log
@Considerable clean-ups.
@
text
@d60 1
a60 1
		./mdocml $$f 1>/dev/null 2>/dev/null || continue ; \
d64 1
a64 1
		./mdocml $$f 1>/dev/null || exit 1 ; \
@


1.36
log
@*** empty log message ***
@
text
@d74 1
a74 1
	./mdocml -W -fhtml -e -o $@@ index.7
d77 1
a77 1
	./mdocml -W -o $@@ index.7
d80 1
a80 1
	./mdocml -W -fhtml -e -o $@@ mdocml.1
@


1.35
log
@Versioning up.
@
text
@d38 2
a39 1
	  test.36 test.37 test.40 test.50 test.61 
d47 1
a47 1
	  test.62
@


1.34
log
@Added warnings for using macros in the wrong sections.
@
text
@d3 1
a3 1
VERSION	= 1.0.0
@


1.33
log
@Fixed installation routine.
@
text
@d38 1
a38 1
	  test.36 test.37 test.40 test.50
d45 2
a46 1
	  test.54 test.55 test.56 test.57 test.58 test.59 test.60
@


1.32
log
@*** empty log message ***
@
text
@d75 1
a75 1
	./mdocml -W -fhtml -e -o $@@ index.7
d82 1
a82 1
	( cd $(PREFIX)/ && ln -sf mdocml-$(VERSION).tgz mdocml.tgz )
d88 1
a88 1
	( cd .dist/mdocml/ && tar zcf ../mdocml.tgz mdocml-$(VERSION)/ )
@


1.31
log
@*** empty log message ***
@
text
@d10 2
a11 1
LNS	= mdocml.ln html.ln xml.ln libmdocml.ln roff.ln ml.ln mlg.ln compat.ln tokens.ln literals.ln
d17 2
a18 1
OBJS	= mdocml.o html.o xml.o libmdocml.o roff.o ml.o mlg.o compat.o tokens.o literals.o
d20 2
a21 1
SRCS	= mdocml.c html.c xml.c libmdocml.c roff.c ml.c mlg.c compat.c tokens.c literals.c
d27 1
a27 1
HTML	= index.html mdocml.html
d29 4
a32 1
CLEAN	= mdocml mdocml.tgz $(LLNS) $(LNS) $(OBJS) $(LIBS) $(HTML)
d53 1
a53 1
www: $(HTML)
d74 3
d81 3
a83 2
	install -m 0644 mdocml.tgz $(PREFIX)/
	install -m 0644 $(HTML) $(PREFIX)/
@


1.30
log
@*** empty log message ***
@
text
@d3 3
d22 1
a22 1
MANS	= mdocml.1
d24 1
a24 1
HTML	= index.html
a40 1

d68 7
d76 3
a78 3
	mkdir -p .dist/mdocml/
	install -m 0644 $(INSTALL) .dist/mdocml/
	( cd .dist/ && tar zcf ../mdocml.tgz mdocml/ )
@


1.29
log
@*** empty log message ***
@
text
@d7 1
a7 1
LNS	= mdocml.ln html.ln xml.ln libmdocml.ln roff.ln ml.ln mlg.ln compat.ln tokens.ln
d13 1
a13 1
OBJS	= mdocml.o html.o xml.o libmdocml.o roff.o ml.o mlg.o compat.o tokens.o
d15 1
a15 1
SRCS	= mdocml.c html.c xml.c libmdocml.c roff.c ml.c mlg.c compat.c tokens.c
d35 2
a36 1
	  test.45 test.46 test.47 test.48 test.49 test.51 test.52
d64 1
a64 1
	./mdocml -W -fhtml -e -o $@@ $<
d72 2
a73 2
llib-lmdocml.ln: mdocml.ln libmdocml.ln html.ln xml.ln roff.ln ml.ln mlg.ln compat.ln tokens.ln
	$(LINT) $(LINTFLAGS) -Cmdocml mdocml.ln libmdocml.ln html.ln xml.ln roff.ln ml.ln mlg.ln compat.ln tokens.ln
d79 2
a80 2
libmdocml.a: libmdocml.o html.o xml.o roff.o ml.o mlg.o compat.o tokens.o
	$(AR) rs $@@ libmdocml.o html.o xml.o roff.o ml.o mlg.o compat.o tokens.o
@


1.28
log
@*** empty log message ***
@
text
@d1 2
d21 3
a23 1
CLEAN	= mdocml mdocml.tgz $(LLNS) $(LNS) $(OBJS) $(LIBS)
d44 2
d62 3
@


1.27
log
@*** empty log message ***
@
text
@d25 1
a25 1
	  test.36 test.37 test.40
d30 2
a31 1
	  test.35 test.38 test.39 test.41
@


1.26
log
@*** empty log message ***
@
text
@d15 1
a15 1
HEADS	= libmdocml.h private.h
d79 1
a79 1
roff.ln: roff.c private.h libmdocml.h
d81 1
a81 1
roff.o: roff.c private.h libmdocml.h
@


1.25
log
@*** empty log message ***
@
text
@d40 8
a47 2
	@@for f in $(FAIL); do ./mdocml $$f 1>/dev/null 2>/dev/null || continue ; done
	@@for f in $(SUCCEED); do ./mdocml $$f 1>/dev/null || exit 1 ; done
@


1.24
log
@Moved charset recognition into the filter.
@
text
@d30 1
a30 1
	  test.35 test.38 test.39
@


1.23
log
@Character-encoding tests.
@
text
@d30 1
a30 1
	  test.35 test.37 test.38 test.39
@


1.22
log
@More html-css.
@
text
@d5 1
a5 1
LNS	= mdocml.ln html.ln xml.ln libmdocml.ln roff.ln ml.ln mlg.ln compat.ln
d11 1
a11 1
OBJS	= mdocml.o html.o xml.o libmdocml.o roff.o ml.o mlg.o compat.o
d13 1
a13 1
SRCS	= mdocml.c html.c xml.c libmdocml.c roff.c ml.c mlg.c compat.c
d25 1
a25 1
	  test.36
d30 1
a30 1
	  test.35
d55 2
a56 2
llib-lmdocml.ln: mdocml.ln libmdocml.ln html.ln xml.ln roff.ln ml.ln mlg.ln compat.ln
	$(LINT) $(LINTFLAGS) -Cmdocml mdocml.ln libmdocml.ln html.ln xml.ln roff.ln ml.ln mlg.ln compat.ln
d62 2
a63 2
libmdocml.a: libmdocml.o html.o xml.o roff.o ml.o mlg.o compat.o
	$(AR) rs $@@ libmdocml.o html.o xml.o roff.o ml.o mlg.o compat.o
@


1.21
log
@Abstract ml/mlg/html/xml.
@
text
@d1 1
a1 1
CFLAGS += -W -Wall -Wno-unused-parameter -g 
@


1.20
log
@Transition to splitting xml/ml.
@
text
@d5 1
a5 1
LNS	= mdocml.ln html4_strict.ln xml.ln libmdocml.ln roff.ln ml.ln
d11 1
a11 1
OBJS	= mdocml.o html4_strict.o xml.o libmdocml.o roff.o ml.o
d13 1
a13 1
SRCS	= mdocml.c html4_strict.c xml.c libmdocml.c roff.c ml.c
d55 2
a56 2
llib-lmdocml.ln: mdocml.ln libmdocml.ln html4_strict.ln xml.ln roff.ln ml.ln
	$(LINT) $(LINTFLAGS) -Cmdocml mdocml.ln libmdocml.ln html4_strict.ln xml.ln roff.ln ml.ln
d62 2
a63 2
libmdocml.a: libmdocml.o html4_strict.o xml.o roff.o ml.o
	$(AR) rs $@@ libmdocml.o html4_strict.o xml.o roff.o ml.o
d65 1
a65 1
xml.ln: xml.c private.h libmdocml.h
d67 1
a67 1
xml.o: xml.c private.h libmdocml.h
d69 1
a69 1
html4_strict.ln: html4_strict.c private.h libmdocml.h
d71 1
a71 1
html4_strict.o: html4_strict.c private.h libmdocml.h
d81 1
a81 1
ml.ln: ml.c private.h libmdocml.h
d83 9
a91 1
ml.o: ml.c private.h libmdocml.h
@


1.19
log
@Added `Sm' functionality.
@
text
@d5 1
a5 1
LNS	= mdocml.ln html4_strict.ln xml.ln libmdocml.ln roff.ln
d11 1
a11 1
OBJS	= mdocml.o html4_strict.o xml.o libmdocml.o roff.o
d13 1
a13 1
SRCS	= mdocml.c html4_strict.c xml.c libmdocml.c roff.c
d55 2
a56 2
llib-lmdocml.ln: mdocml.ln libmdocml.ln html4_strict.ln xml.ln roff.ln
	$(LINT) $(LINTFLAGS) -Cmdocml mdocml.ln libmdocml.ln html4_strict.ln xml.ln roff.ln
d62 2
a63 2
libmdocml.a: libmdocml.o html4_strict.o xml.o roff.o
	$(AR) rs $@@ libmdocml.o html4_strict.o xml.o roff.o
d80 4
@


1.18
log
@Improvements to the xml part.
@
text
@d1 1
a1 1
CFLAGS += -W -Wall -Wno-unused-parameter -g
d24 2
a25 1
	  test.15 test.20 test.22 test.24 test.26 test.27 test.30
d29 2
a30 1
	  test.25 test.28 test.29 test.31 test.32 test.33 test.34
@


1.17
log
@No more segfaults when run over openbsd sources.
@
text
@d28 1
a28 1
	  test.25 test.28 test.29 test.31
@


1.16
log
@Considerable scoping fixes.
@
text
@d28 1
a28 1
	  test.25 test.28 test.29
@


1.15
log
@Considerably improved roff_text parser.
Consolidated noop roff macros.
@
text
@d24 1
a24 1
	  test.15 test.20 test.22
d27 2
a28 1
	  test.14 test.16 test.17 test.18 test.19 test.21 test.23
@


1.14
log
@Preliminary xml output filter (validate-renamed) done.
@
text
@d24 1
a24 1
	  test.15 test.20
d27 1
a27 1
	  test.14 test.16 test.17 test.18 test.19 test.21
@


1.13
log
@Cleaned up presentation with mbuf_putstring & al.
@
text
@d5 1
a5 1
LNS	= mdocml.ln html4_strict.ln validate.ln libmdocml.ln roff.ln
d11 1
a11 1
OBJS	= mdocml.o html4_strict.o validate.o libmdocml.o roff.o
d13 1
a13 1
SRCS	= mdocml.c html4_strict.c validate.c libmdocml.c roff.c
d52 2
a53 2
llib-lmdocml.ln: mdocml.ln libmdocml.ln html4_strict.ln validate.ln roff.ln
	$(LINT) $(LINTFLAGS) -Cmdocml mdocml.ln libmdocml.ln html4_strict.ln validate.ln roff.ln
d59 2
a60 2
libmdocml.a: libmdocml.o html4_strict.o validate.o roff.o
	$(AR) rs $@@ libmdocml.o html4_strict.o validate.o roff.o
d62 1
a62 1
validate.ln: validate.c private.h libmdocml.h
d64 1
a64 1
validate.o: validate.c private.h libmdocml.h
@


1.12
log
@Initial pushing to mbuf.
@
text
@d55 1
a55 1
mdocml.ln: mdocml.c 
d57 1
a57 3
mdocml.o: mdocml.c 

mdocml.c: libmdocml.h
d62 1
a62 11
validate.ln: validate.c 

validate.o: validate.c 

validate.c: private.h libmdocml.h

html4_strict.ln: html4_strict.c 

html4_strict.o: html4_strict.c 

html4_strict.c: private.h libmdocml.h
d64 1
a64 1
roff.ln: roff.c 
d66 1
a66 1
roff.o: roff.c 
d68 1
a68 1
roff.c: private.h libmdocml.h
d70 1
a70 1
libmdocml.ln: libmdocml.c 
d72 1
a72 1
libmdocml.o: libmdocml.c 
d74 1
a74 1
libmdocml.c: private.h libmdocml.h
d76 1
@


1.11
log
@More fixes and work-ness.
@
text
@d5 1
a5 1
LNS	= mdocml.ln html4_strict.ln dummy.ln libmdocml.ln roff.ln
d11 1
a11 1
OBJS	= mdocml.o html4_strict.o dummy.o libmdocml.o roff.o
d13 1
a13 1
SRCS	= mdocml.c html4_strict.c dummy.c libmdocml.c roff.c
d52 2
a53 2
llib-lmdocml.ln: mdocml.ln libmdocml.ln html4_strict.ln dummy.ln roff.ln
	$(LINT) $(LINTFLAGS) -Cmdocml mdocml.ln libmdocml.ln html4_strict.ln dummy.ln roff.ln
d61 8
a68 2
libmdocml.a: libmdocml.o html4_strict.o dummy.o roff.o
	$(AR) rs $@@ libmdocml.o html4_strict.o dummy.o roff.o
@


1.10
log
@Mainly quotes.
@
text
@d1 1
a1 1
CFLAGS += -W -Wall -Wno-unused-parameter -g -DDEBUG
d24 1
a24 1
	  test.15
d27 1
a27 1
	  test.14 test.16 test.17
@


1.9
log
@Various fixes.
@
text
@d1 1
a1 1
CFLAGS += -W -Wall -Wno-unused-parameter -g 
@


1.8
log
@Considerable fixes.
@
text
@d26 2
a27 1
SUCCEED	= test.7 test.8 test.9 test.10 test.11 test.12 test.13
@


1.7
log
@Added regression tests.
Considerable fixes... blah blah blah...
@
text
@d1 1
a1 1
CFLAGS += -W -Wall -Wno-unused-parameter -g
d36 2
a37 2
	@@for f in $(FAIL); do ./mdocml $$f 2>/dev/null || continue ; done
	@@for f in $(SUCCEED); do ./mdocml $$f || exit 1 ; done
@


1.6
log
@Split roff engine into roff.c.
Re-worked calling convention for md_*.
@
text
@d2 1
d23 5
d35 4
@


1.5
log
@Considerable improvements across the board.
@
text
@d4 1
a4 1
LNS	= mdocml.ln html4_strict.ln dummy.ln libmdocml.ln
d10 1
a10 1
OBJS	= mdocml.o html4_strict.o dummy.o libmdocml.o
d12 1
a12 1
SRCS	= mdocml.c html4_strict.c dummy.c libmdocml.c
d41 2
a42 2
llib-lmdocml.ln: mdocml.ln libmdocml.ln html4_strict.ln dummy.ln
	$(LINT) $(LINTFLAGS) -Cmdocml mdocml.ln libmdocml.ln html4_strict.ln dummy.ln
d50 2
a51 2
libmdocml.a: libmdocml.o html4_strict.o dummy.o
	$(AR) rs $@@ libmdocml.o html4_strict.o dummy.o
d59 6
d70 1
@


1.4
log
@Segmentation into html and dummy parsers.
Initial recursive-descent parser in place for html/ml parser.
Parsing of title tags more-or-less in place.
@
text
@d1 1
a1 1
CFLAGS += -W -Wall -g
@


1.3
log
@Fuller seperation into mdocml/libmdocml.
@
text
@d2 13
d16 3
a18 1
LINTFLAGS += -c -e -f -u
d20 1
a20 1
CLEAN = mdocml mdocml.o mdocml.ln libmdocml.o libmdocml.ln mdocml.tgz llib-lmdocml.ln
a21 1
INSTALL = Makefile libmdocml.h mdocml.c libmdocml.c mdocml.1
d29 2
a30 2
mdocml: mdocml.o libmdocml.o
	$(CC) $(CFLAGS) -o $@@ mdocml.o libmdocml.o
d41 2
a42 2
llib-lmdocml.ln: mdocml.ln libmdocml.ln
	$(LINT) $(LINTFLAGS) -Cmdocml mdocml.ln libmdocml.ln
d50 9
d63 1
a63 1
libmdocml.c: libmdocml.h
@


1.2
log
@Fixed dist hook in Makefile (uses a file-target).
@
text
@d5 1
a5 1
CLEAN = mdocml mdocml.o mdocml.ln libmdocml.o libmdocml.ln mdocml.tgz
d11 1
a11 1
lint: mdocml.ln libmdocml.ln
d27 3
@


1.1
log
@Initial revision
@
text
@d5 1
a5 1
CLEAN = mdocml mdocml.o mdocml.ln libmdocml.o libmdocml.ln
d13 2
d21 1
a21 1
dist:
@


1.1.1.1
log
@Initial check-in of mdocml.
@
text
@@
