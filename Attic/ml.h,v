head	1.17;
access;
symbols
	VERSION_1_9_5:1.17
	VERSION_1_8_5:1.17
	VERSION_1_8_1:1.17
	VERSION_1_7_16:1.17
	VERSION_1_7_15:1.17
	OPENBSD_CHECKIN:1.17
	VERSION_1_6_5:1.17
	VERSION_1_5_1:1.17
	VERSION_1_3_15:1.17
	VERSION_1_3_6:1.17
	VERSION_1_2_0:1.17
	VERSION_1_0_2:1.15
	VERSION_1_0_1:1.10;
locks; strict;
comment	@ * @;


1.17
date	2008.12.15.01.54.58;	author kristaps;	state dead;
branches;
next	1.16;

1.16
date	2008.12.10.17.31.57;	author kristaps;	state Exp;
branches;
next	1.15;

1.15
date	2008.12.10.12.09.47;	author kristaps;	state Exp;
branches;
next	1.14;

1.14
date	2008.12.10.12.05.33;	author kristaps;	state Exp;
branches;
next	1.13;

1.13
date	2008.12.10.10.43.57;	author kristaps;	state Exp;
branches;
next	1.12;

1.12
date	2008.12.10.00.52.46;	author kristaps;	state Exp;
branches;
next	1.11;

1.11
date	2008.12.09.17.09.12;	author kristaps;	state Exp;
branches;
next	1.10;

1.10
date	2008.12.08.12.46.28;	author kristaps;	state Exp;
branches;
next	1.9;

1.9
date	2008.12.07.22.40.18;	author kristaps;	state Exp;
branches;
next	1.8;

1.8
date	2008.12.07.21.30.49;	author kristaps;	state Exp;
branches;
next	1.7;

1.7
date	2008.12.05.19.45.15;	author kristaps;	state Exp;
branches;
next	1.6;

1.6
date	2008.12.05.17.43.14;	author kristaps;	state Exp;
branches;
next	1.5;

1.5
date	2008.12.05.11.28.17;	author kristaps;	state Exp;
branches;
next	1.4;

1.4
date	2008.12.04.16.19.52;	author kristaps;	state Exp;
branches;
next	1.3;

1.3
date	2008.12.04.11.25.29;	author kristaps;	state Exp;
branches;
next	1.2;

1.2
date	2008.12.03.19.21.58;	author kristaps;	state Exp;
branches;
next	1.1;

1.1
date	2008.12.03.14.39.59;	author kristaps;	state Exp;
branches;
next	;


desc
@@


1.17
log
@Purged all old files in favour of new design.  Selective reintegration.
@
text
@@


1.16
log
@*** empty log message ***
@
text
@a0 93
/* $Id: ml.h,v 1.15 2008/12/10 12:09:47 kristaps Exp $ */
/*
 * Copyright (c) 2008 Kristaps Dzonsons <kristaps@@kth.se>
 *
 * Permission to use, copy, modify, and distribute this software for any
 * purpose with or without fee is hereby granted, provided that the
 * above copyright notice and this permission notice appear in all
 * copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL
 * WARRANTIES WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE
 * AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL
 * DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR
 * PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
 * TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
 * PERFORMANCE OF THIS SOFTWARE.
 */
#ifndef ML_H
#define ML_H

#include "private.h"

#define	COLUMNS		  72
#define	INDENT_SZ	  4
#define	INDENT(x)	  ((x) > MAXINDENT ? MAXINDENT : (x))
#define	MAXINDENT	  10

struct	md_mlg;

enum	md_ns {
	MD_NS_BLOCK,
	MD_NS_HEAD,
	MD_NS_BODY,
	MD_NS_INLINE,
	MD_NS_DEFAULT
};

enum	ml_scope {
	ML_OPEN,
	ML_CLOSE
};

struct	ml_args {
	const struct md_args	*args;
	const struct md_rbuf	*rbuf;
	struct md_mbuf		*mbuf;
	int		 	 section;
	void			*data;
};

struct	ml_cbs {
	int	(*ml_begin)(struct ml_args *, const struct tm *, 
			const char *, const char *,
			enum roffmsec, enum roffvol);
	int	(*ml_end)(struct ml_args *, const struct tm *, 
			const char *, const char *,
			enum roffmsec, enum roffvol);
	ssize_t	(*ml_beginstring)(struct ml_args *,
			const char *, size_t);
	ssize_t	(*ml_endstring)(struct ml_args *,
			const char *, size_t);
	ssize_t	(*ml_endtag)(struct ml_args *, enum md_ns, int);
	ssize_t	(*ml_begintag)(struct ml_args *, enum md_ns, int, 
			const int *, const char **);
	int	(*ml_alloc)(void **);
	void	(*ml_free)(void *);
};

__BEGIN_DECLS

int		  ml_putstring(struct md_mbuf *, 
			const char *, size_t *);
int		  ml_nputstring(struct md_mbuf *, 
			const char *, size_t, size_t *);
int		  ml_nputs(struct md_mbuf *, 
			const char *, size_t, size_t *);
int		  ml_puts(struct md_mbuf *, const char *, size_t *);
int		  ml_putchars(struct md_mbuf *, 
			char, size_t, size_t *);

struct md_mlg	 *mlg_alloc(const struct md_args *, 
			const struct md_rbuf *, struct md_mbuf *,
			const struct ml_cbs *);
int		  mlg_exit(struct md_mlg *, int);
int		  mlg_line(struct md_mlg *, char *);

int		  ml_tagput(struct md_mbuf *, 
			enum ml_scope, const char *, size_t *);

__END_DECLS

#endif /*!ML_H*/
@


1.15
log
@Linted on NetBSD side.
@
text
@d1 1
a1 1
/* $Id: ml.h,v 1.14 2008/12/10 12:05:33 kristaps Exp $ */
d44 8
d53 1
a53 3
	int	(*ml_begin)(struct md_mbuf *, 
			const struct md_args *,
			const struct tm *, 
d56 1
a56 3
	int	(*ml_end)(struct md_mbuf *, 
			const struct md_args *,
			const struct tm *, 
d59 1
a59 2
	ssize_t	(*ml_beginstring)(struct md_mbuf *,
			const struct md_args *,
d61 1
a61 2
	ssize_t	(*ml_endstring)(struct md_mbuf *,
			const struct md_args *,
d63 2
a64 6
	ssize_t	(*ml_endtag)(struct md_mbuf *, 
			void *, const struct md_args *, 
			enum md_ns, int);
	ssize_t	(*ml_begintag)(struct md_mbuf *, 
			void *, const struct md_args *, 
			enum md_ns, int, 
a81 1
/* FIXME: move into mlg.h or private.h. */
@


1.14
log
@Versioning up.
@
text
@d1 1
a1 1
/* $Id: ml.h,v 1.13 2008/12/10 10:43:57 kristaps Exp $ */
d36 1
a36 1
	MD_NS_DEFAULT,
@


1.13
log
@*** empty log message ***
@
text
@d1 1
a1 1
/* $Id: ml.h,v 1.12 2008/12/10 00:52:46 kristaps Exp $ */
d51 4
a54 1
			const struct md_args *);
@


1.12
log
@*** empty log message ***
@
text
@d1 1
a1 1
/* $Id: ml.h,v 1.11 2008/12/09 17:09:12 kristaps Exp $ */
d49 1
a49 1
			enum roffmsec, const char *);
@


1.11
log
@Considerable clean-ups.
@
text
@d1 1
a1 1
/* $Id: ml.h,v 1.10 2008/12/08 12:46:28 kristaps Exp $ */
d22 7
d39 5
d81 1
d88 3
@


1.10
log
@Added warnings for using macros in the wrong sections.
@
text
@d1 1
a1 1
/* $Id: ml.h,v 1.9 2008/12/07 22:40:18 kristaps Exp $ */
a67 3
char		 *ml_literal(int, const int *,
			const char **, const char **);
char		 *ml_section(enum roffmsec);
@


1.9
log
@*** empty log message ***
@
text
@d1 1
a1 1
/* $Id: ml.h,v 1.8 2008/12/07 21:30:49 kristaps Exp $ */
d37 1
a37 1
			const char *, const char *);
d70 1
@


1.8
log
@*** empty log message ***
@
text
@d1 1
a1 1
/* $Id: ml.h,v 1.7 2008/12/05 19:45:15 kristaps Exp $ */
d68 2
@


1.7
log
@*** empty log message ***
@
text
@d1 1
a1 1
/* $Id: ml.h,v 1.6 2008/12/05 17:43:14 kristaps Exp $ */
d40 6
@


1.6
log
@*** empty log message ***
@
text
@d1 1
a1 1
/* $Id: ml.h,v 1.5 2008/12/05 11:28:17 kristaps Exp $ */
d32 5
a36 2
typedef	int	(*ml_begin)(struct md_mbuf *, const struct md_args *,
			const struct tm *, const char *, const char *,
d38 1
a38 1
typedef	int	(*ml_end)(struct md_mbuf *, 
d40 6
a45 4
typedef	ssize_t	(*ml_endtag)(struct md_mbuf *, void *,
			const struct md_args *, enum md_ns, int);
typedef	ssize_t	(*ml_begintag)(struct md_mbuf *, void *,
			const struct md_args *, enum md_ns, int, 
d47 3
d63 1
a63 1
struct md_mlg	 *mlg_alloc(const struct md_args *, void *,
d65 1
a65 1
			ml_begintag, ml_endtag, ml_begin, ml_end);
@


1.5
log
@*** empty log message ***
@
text
@d1 1
a1 1
/* $Id: ml.h,v 1.4 2008/12/04 16:19:52 kristaps Exp $ */
d37 1
a37 1
typedef	ssize_t	(*ml_endtag)(struct md_mbuf *, 
d39 1
a39 1
typedef	ssize_t	(*ml_begintag)(struct md_mbuf *, 
d55 1
a55 1
struct md_mlg	 *mlg_alloc(const struct md_args *, 
@


1.4
log
@Character-encoding tests.
@
text
@d1 1
a1 1
/* $Id: ml.h,v 1.3 2008/12/04 11:25:29 kristaps Exp $ */
a31 1

d45 2
@


1.3
log
@More html-css.
@
text
@d1 1
a1 1
/* $Id: ml.h,v 1.2 2008/12/03 19:21:58 kristaps Exp $ */
d32 1
a43 1

@


1.2
log
@Major update.
@
text
@d1 1
a1 1
/* $Id: ml.h,v 1.1 2008/12/03 14:39:59 kristaps Exp $ */
d32 3
a34 2
typedef	int	(*ml_begin)(struct md_mbuf *, 
		const struct md_args *);
d36 1
a36 1
		const struct md_args *);
d38 1
a38 1
		const struct md_args *, enum md_ns, int);
d40 2
a41 2
		const struct md_args *, enum md_ns, int, 
		const int *, const char **);
@


1.1
log
@Abstract ml/mlg/html/xml.
@
text
@d1 1
a1 1
/* $Id: private.h,v 1.23 2008/12/02 18:26:57 kristaps Exp $ */
d26 2
d32 4
d49 1
d55 1
a55 1
			ml_begintag, ml_endtag);
@
